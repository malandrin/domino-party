{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/editor/publish_dialog.vue?cb21","webpack:///./src/assets/github.png","webpack:///./src/editor/command_panel.vue?af47","webpack:///./src/app.vue?f5f9","webpack:///src/app.vue","webpack:///./src/app.vue?da35","webpack:///./src/app.vue","webpack:///./src/home.vue?411e","webpack:///src/home.vue","webpack:///./src/home.vue?1ba4","webpack:///./src/home.vue","webpack:///./src/editor/editor.vue?62fb","webpack:///./src/defines.js","webpack:///./src/editor/actions.js","webpack:///./src/world/imesh.js","webpack:///./src/world/entities.js","webpack:///./src/world/world.js","webpack:///./src/editor/batch_stamper.js","webpack:///./src/editor/shortcuts.js","webpack:///./src/editor/command_panel.vue?9734","webpack:///./src/editor/scene_inspector.vue?d5f2","webpack:///src/editor/scene_inspector.vue","webpack:///./src/editor/scene_inspector.vue?ece3","webpack:///./src/editor/scene_inspector.vue","webpack:///src/editor/command_panel.vue","webpack:///./src/editor/command_panel.vue?7844","webpack:///./src/editor/command_panel.vue","webpack:///./src/editor/io_dialog.vue?87b1","webpack:///src/editor/io_dialog.vue","webpack:///./src/editor/io_dialog.vue?8615","webpack:///./src/editor/io_dialog.vue","webpack:///./src/editor/publish_dialog.vue?1729","webpack:///src/editor/publish_dialog.vue","webpack:///./src/editor/publish_dialog.vue?4714","webpack:///./src/editor/publish_dialog.vue","webpack:///./src/editor/help_dialog.vue?6d47","webpack:///src/editor/help_dialog.vue","webpack:///./src/editor/help_dialog.vue?5585","webpack:///./src/editor/help_dialog.vue","webpack:///src/editor/editor.vue","webpack:///./src/editor/editor.vue?ed5b","webpack:///./src/editor/editor.vue","webpack:///./src/viewer.vue?9f2d","webpack:///src/viewer.vue","webpack:///./src/viewer.vue?a4ee","webpack:///./src/viewer.vue","webpack:///./src/router.js","webpack:///./src/main.js","webpack:///./src/home.vue?8129","webpack:///./src/editor/scene_inspector.vue?b9a4","webpack:///./src/editor/help_dialog.vue?354a","webpack:///./src/editor/editor.vue?afa5","webpack:///./src/editor/io_dialog.vue?0d94","webpack:///./src/assets/editor.gif","webpack:///./src/assets/viewer.gif","webpack:///./src/viewer.vue?48e8","webpack:///./src/app.vue?45ff"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","component","staticClass","_v","on","$event","gotoPage","_m","style","methods","$router","directives","rawName","state","expression","class","disabled","actionsQueue","idx","undoAction","queue","redoAction","active","activeTransform","selectTransform","selectedEntities","removeSelectedEntities","invisible","stateBeforePause","hidden","play","stop","_e","type","togglePause","stepForward","_s","numValidEntitiesInTheScene","maxNumEntitiesInScene","copySceneUrlToClipboard","publishScene","openHelpDialog","cancelValidation","ref","batchStamperActive","batchStamper","onMouseDown","onMouseUp","onMouseMove","parameters","world","group","onBatchStamperOn","onBatchStamperOff","rebuildBatchStamper","rotateSelectedEntities","moveSelectedEntities","colorizeSelectedEntities","rotateGroupEntities","moveGroupEntities","colorizeGroupEntities","onSelectEntities","onDeselectEntities","dialogVisible","closePublishDialog","top","selectionBox","left","width","height","NUM_MAX_ENTITIES_IN_EDITOR","SCENE_INITIAL_TILE_IDX","SCENE_LAST_TILE_IDX","TILE_SIZE","x","y","z","GROUND_SIZE","BALL_RADIUS","TILE_Y_POSITION","BALL_Y_POSITION","INITIAL_IMPULSE_VALUE","GROUND_GEOMETRY","THREE","TILE_GEOMETRY","BALL_GEOMETRY","MAX_SCENE_TITLE_LENGTH","MAX_SCENE_AUTHOR_LENGTH","Action","options","editor","do","AddEntities","entities","_","clone","entity","addToRenderWorld","addChild","removeFromRenderWorld","removeChild","MoveEntities","previousPosition","id","position","setPosition","offset","prevPos","RotateEntities","previousRotation","angleY","setRotation","RemoveEntities","toRemove","deselectEntities","toSelect","selectEntities","SelectEntities","prevSelection","adding","DeselectEntities","CombinedActions","actions","action","undo","ColorizeEntities","prevColors","getColor","setColor","color","IMesh","size","geometry","castShadow","auxMatrix","auxColor","auxVector","auxVector2","auxQuaternion","auxEuler","needsTransformUpdate","needsColorUpdate","instancedGeometry","colors","Float32Array","fill","vertexColors","setAttribute","material","copy","mesh","receiveShadow","iMesh","count","rotY","scale","isUndefined","identity","setFromEuler","set","compose","setMatrixAt","hexColor","toArray","fromArray","getHexString","instanceMatrix","needsUpdate","IMeshManaged","freeEntries","pop","GROUND_MASS","GROUND_SHAPE","Ammo","btBoxShape","btVector3","GROUND_LOCAL_INERTIA","calculateLocalInertia","TILE_MASS","TILE_SHAPE","TILE_LOCAL_INERTIA","BALL_MASS","BALL_SHAPE","btSphereShape","BALL_LOCAL_INERTIA","FALLING_TIME_BEFORE_SLEEP","FADING_COLOR","EntityIdGen","Entity","rotation","parent","userData","visible","frozen","add","getWorldPosition","getWorldRotationY","offsetX","offsetY","offsetZ","Group","assign","children","child","setParent","filter","delta","tick","saveState","restoreState","setVisible","updateMatrix","addToPhysicalWorld","removeFromPhysicalWorld","findChildById","iMeshName","iMeshEntry","findChildByIMeshEntry","currentPosition","move","rotate","cosa","Math","cos","sina","sin","newX","newZ","SimEntity","matrix","fallingTimer","overrideColor","positionSaved","rotationSaved","stateSaved","setTransformAt","useEntry","freeEntry","body","transform","btTransform","worldPosition","setIdentity","setOrigin","btQuaternion","w","motionState","btDefaultMotionState","rbInfo","btRigidBodyConstructionInfo","mass","shape","localInertia","btRigidBody","physicsWorld","addRigidBody","removeRigidBody","setColorAt","intensity","lerp","Ground","DynEntity","tmpTrans","ms","getMotionState","getWorldTransform","getOrigin","quaternion","getRotation","array","arrayIndex","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","Ball","Tile","q","a","angleTo","domElement","renderer","antialias","setPixelRatio","devicePixelRatio","setSize","clientWidth","clientHeight","setClearColor","shadowMap","enabled","appendChild","cameraPosition","camera","scene","ambient","light","lightTarget","target","shadow","near","far","bias","mapSize","right","bottom","directionalLight","imTiles","numTiles","imGrounds","numGrounds","imBalls","numBalls","collisionConfiguration","btDefaultCollisionConfiguration","dispatcher","btCollisionDispatcher","overlappingPairCache","btDbvtBroadphase","solver","btSequentialImpulseConstraintSolver","btDiscreteDynamicsWorld","setGravity","stepSimulation","prepareRender","render","aspect","updateProjectionMatrix","stamperInitialPos","stamperFinalPos","stamperPos","batchDef","freeModePoints","single","line","forwardOffset","fixedRotation","free","triangle","rightOffset","rectangle","image","filename","rawData","horSize","verSize","ball","setCount","show","event","hitPoint","getGroundHitPoint","prevPoint","dist","sqrt","pow","rebuild","entityDef","entityType","stamperParameters","degToRad","parseFloat","dir","sub","normalize","offsetValue","rot","atan2","normal","fwd","k","multX","multZ","abs","distX","distZ","ratioX","floor","ratioY","entries","imMesh","min","KEYS_MAPPING","keyCode","ctrlPressed","shiftPressed","method","context","keysDown","onKeyDown","onKeyUp","addEventListener","removeEventListener","document","activeElement","tagName","toLowerCase","km","code","ctrlKey","shiftKey","isFunction","loadFile","collapsed","containerCollapsed","sceneInspector","toggleCollapseState","editingGroup","createBatch","_l","activeBatchType","selectBatchType","parameter","pindex","label","inputType","activeBatchStamperParameters","field","onBatchStamperParameterClick","refInFor","textInput","checkboxInput","isEnabled","domProps","Array","isArray","_i","$$a","$$el","$$c","checked","$$v","$$i","$set","concat","updateBatchStamperParameter","_q","composing","entityParameters","placeholder","updateEntityParameter","info","eindex","odd","isChild","selected","hasCaret","isGroup","isCollapsed","toggleVisibility","selectEntity","toggleFrozenbility","props","groupCollapsed","computed","entitiesInfo","isSelected","$emit","entityInfo","fromEntity","fromIdx","toIdx","selection","aux","setFrozen","components","SceneInspector","entityParametersList","activeBatchStamperParametersList","batchTypes","refresh","round","positionX","positionZ","childrenPosX","childrenPosZ","childrenRot","childrenColor","positionY","setEntities","isFixed","batchStamperParameters","self","color2Hex","reader","onload","file","canvas","getContext","drawImage","idata","readAsDataURL","$refs","fileSelector","click","max","stopPropagation","title","input","message","cancel","noButton","accept","open","params","close","maxTitleLength","maxAuthorLength","author","focus","select","$recaptcha","then","token","activeStep","incStep","setStep","showDialogAtStartup","updateShowDialogAtStartup","numSteps","showDialog","localStorage","setItem","inc","step","CommandPanel","IODialog","PublishDialog","HelpDialog","MAX_NUM_ENTITIES","dialogEntities","sceneUuid","batchId","getNumValidEntitiesInGroup","mounted","orbitControl","OrbitControls","mouseButtons","LEFT","maxDistance","transformControlEnabled","transformControl","TransformControls","colorFadingTimer","COLOR_FADING_TIME","raycaster","init","ground","executeAction","tiles","initialDummyPosition","prevDummyPosition","dummyObject","animFrameId","requestAnimationFrame","start","Date","now","shortcuts","manageTransformControlEvents","showHelpDialog","onWindowResize","destroyed","onDestroyed","cancelAnimationFrame","isKeyPressed","prevDummyRotation","accumRotation","initialTransformValues","commandPanel","current","checkSceneValidation","adjustDummyToSelectedEntities","entitiesLength","attach","detach","leftDirection","clientX","topDirection","clientY","clickStart","which","ignoreNextMouseUpEvent","clickDelta","CLICK_TIME","batchPosition","reset","newSelection","getBoxedSelectedEntities","prepareGroupToPlay","restoreGroupToEdit","fromSelection","prePlaySelectedEntities","initialTile","applyImpulse","actionClass","noRedo","redo","setType","groups","groupId","setMode","showX","showY","showZ","openIODialog","ioDialog","helpDialog","closeHelpDialog","cameraPositionPreValidating","cameraRotationPreValidating","CAMERA_POSITION","lookAt","lastTileValidating","saveEntities","isEntityValidToBePublished","publishDialog","navigator","clipboard","writeText","substring","content","JSON","stringify","entitiesToPublish","$http","post","response","ok","uuid","numEntities","getEntityHit","setFromCamera","pos","instanceId","point","activeScene","scenePositionZ","timer","cameraDest","activeScenes","activeSceneIdx","nextSceneDefs","loadedSceneId","$route","fetchScenes","addNextSceneToWorld","impulseTile","url","sceneId","callback","nextScene","sceneToStream","streamScene","nextSceneIdx","removedScene","lookAtZ","speed","WAITING_FOR_FALLING_TILE_TIME","getLookAtZ","lastTileFalling","createEntity","entityIdx","prevScene","lastTileDef","streamingFrom","numChildren","createScene","sceneDef","streamingIt","contentDef","prevX","thisX","andPhysicalWorld","tile","isActive","activate","Vue","use","VueRouter","routes","path","Editor","Viewer","Home","meta","config","productionTip","VueReCaptcha","siteKey","loaderOptions","autoHideBadge","VueResource","http","root","emulateJSON","router","h","App","$mount"],"mappings":"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","file":"js/app.f25f0219.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/domino-party/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./publish_dialog.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./publish_dialog.vue?vue&type=style&index=0&lang=less&\"","module.exports = __webpack_public_path__ + \"img/github.4b0019a6.png\";","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./command_panel.vue?vue&type=style&index=0&id=ee80b988&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./command_panel.vue?vue&type=style&index=0&id=ee80b988&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"app\">\r\n    <router-view/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'App'\r\n}\r\n</script>\r\n\r\n<style>\r\n@import url('https://fonts.googleapis.com/css?family=Roboto&display=swap');\r\n\r\n#app {\r\n  font-family: Roboto, Avenir, Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  text-align: center;\r\n  color: #2c3e50;\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./app.vue?vue&type=template&id=7165728f&\"\nimport script from \"./app.vue?vue&type=script&lang=js&\"\nexport * from \"./app.vue?vue&type=script&lang=js&\"\nimport style0 from \"./app.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"Welcome to Domino Party\")]),_c('div',{staticClass:\"message\"},[_vm._v(\"What do you want to do today?\")]),_c('div',{staticClass:\"options\"},[_c('div',{staticClass:\"option\",on:{\"click\":function($event){return _vm.gotoPage('create')}}},[_c('div',{staticClass:\"title\"},[_vm._v(\"Create\")]),_c('img',{staticClass:\"capture\",attrs:{\"src\":require(\"@/assets/editor.gif\")}}),_c('div',{staticClass:\"description\"},[_vm._v(\"You have one square meter board. Use the editor to populate it with domino tiles and share it with the world. The only requirement is: the last tile must fall.\")])]),_c('div',{staticClass:\"option\",on:{\"click\":function($event){return _vm.gotoPage('view')}}},[_c('div',{staticClass:\"title\"},[_vm._v(\"View\")]),_c('img',{staticClass:\"capture\",attrs:{\"src\":require(\"@/assets/viewer.gif\")}}),_c('div',{staticClass:\"description\"},[_vm._v(\"Relax and enjoy watching other users creations put one after other creating an infinite tiles falling stream.\")])])]),_c('div',{staticClass:\"footer\"},[_vm._m(0),_c('div',{style:({'margin-left': 'auto'})},[_vm._v(\" Source code available at GitHub \"),_c('a',{attrs:{\"href\":\"https://github.com/malandrin/domino-party\"}},[_c('img',{staticClass:\"githubImage\",style:({'margin-left': '10px'}),attrs:{\"src\":require(\"@/assets/github.png\")}})])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('span',[_vm._v(\"An experiment made by \"),_c('a',{staticClass:\"link\",attrs:{\"href\":\"https://www.cesarbotana.com\"}},[_vm._v(\"Csar Botana\")])])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"home\">\r\n    <div class=\"title\">Welcome to Domino Party</div>\r\n    <div class=\"message\">What do you want to do today?</div>\r\n    <div class=\"options\">\r\n      <div class=\"option\" v-on:click=\"gotoPage('create')\">\r\n        <div class=\"title\">Create</div>\r\n        <img class=\"capture\" src=\"@/assets/editor.gif\">\r\n        <div class=\"description\">You have one square meter board. Use the editor to populate it with domino tiles and share it with the world. The only requirement is: the last tile must fall.</div>\r\n      </div>\r\n      <div class=\"option\" v-on:click=\"gotoPage('view')\">\r\n        <div class=\"title\">View</div>\r\n        <img class=\"capture\" src=\"@/assets/viewer.gif\">\r\n        <div class=\"description\">Relax and enjoy watching other users creations put one after other creating an infinite tiles falling stream.</div>\r\n      </div>\r\n    </div>\r\n    <div class=\"footer\">\r\n      <div>\r\n        <span>An experiment made by <a class=\"link\" href=\"https://www.cesarbotana.com\">Csar Botana</a></span>\r\n      </div>\r\n      <div v-bind:style=\"{'margin-left': 'auto'}\">\r\n        Source code available at GitHub <a href=\"https://github.com/malandrin/domino-party\"><img v-bind:style=\"{'margin-left': '10px'}\" class=\"githubImage\" src=\"@/assets/github.png\"></a>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n  name: 'Home',\r\n  methods: {\r\n    gotoPage: function(page) {\r\n      this.$router.push(`/${page}`)\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  .home {\r\n    background: #272838;\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    bottom: 0;\r\n    right: 0;\r\n    color: white;\r\n    padding: 30px;\r\n\r\n    .title {\r\n      font-weight: 700;\r\n      font-size: 56px;\r\n    }\r\n\r\n    .message {\r\n      font-size: 26px;\r\n      margin-top: 20px;\r\n    }\r\n\r\n    .options {\r\n      margin-top: 100px;\r\n      width: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-evenly;\r\n\r\n      .option {\r\n        background: #5D536B;\r\n        border-radius: 10px;\r\n        height: 100%;\r\n        width: 450px;\r\n        cursor: pointer;\r\n        padding: 10px;\r\n        border: 2px solid transparent;\r\n\r\n        &:hover {\r\n          border: 2px solid white;\r\n        }\r\n\r\n        .title {\r\n          font-size: 24px;\r\n          font-weight: 100;\r\n          margin-top: 5px;\r\n          margin-bottom: 5px;\r\n        }\r\n\r\n        .description {\r\n          padding: 5px;\r\n          text-align: justify;\r\n        }\r\n\r\n        .capture {\r\n          width: 100%;\r\n        }\r\n      }\r\n    }\r\n\r\n    .footer {\r\n      position: absolute;\r\n      bottom: 30px;\r\n      left: 50px;\r\n      right: 50px;\r\n      text-align: center;\r\n      display: flex;\r\n      align-items: center;\r\n      padding-right: 30px;\r\n\r\n      div {\r\n        display: flex;\r\n        align-items: center;\r\n      }\r\n\r\n      .githubImage {\r\n        width: 50px;\r\n      }\r\n\r\n      .link {\r\n        color: #193;\r\n        text-decoration: none;\r\n      }\r\n    }\r\n  }\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./home.vue?vue&type=template&id=f763c07e&scoped=true&\"\nimport script from \"./home.vue?vue&type=script&lang=js&\"\nexport * from \"./home.vue?vue&type=script&lang=js&\"\nimport style0 from \"./home.vue?vue&type=style&index=0&id=f763c07e&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f763c07e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"editor\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.state !== 'validating'),expression:\"state !== 'validating'\"}],staticClass:\"toolbar\"},[_c('div',{staticClass:\"controlsSection\"},[_c('div',{staticClass:\"toolbarButton\",class:{disabled: _vm.state !== 'idle' || _vm.actionsQueue.idx === 0},attrs:{\"title\":\"Undo (Ctrl + Z)\"},on:{\"click\":_vm.undoAction}},[_c('i',{staticClass:\"fas fa-arrow-left\"})]),_c('div',{staticClass:\"toolbarButton\",class:{disabled: _vm.state !== 'idle' || (_vm.actionsQueue.idx >= _vm.actionsQueue.queue.length)},attrs:{\"title\":\"Redo (Ctrl + Y)\"},on:{\"click\":_vm.redoAction}},[_c('i',{staticClass:\"fas fa-arrow-right\"})])]),_c('div',{staticClass:\"controlsSection\"},[_c('div',{staticClass:\"toolbarButton\",class:{active: _vm.activeTransform === 'select', disabled: _vm.state !== 'idle'},attrs:{\"title\":\"Select (Q)\"},on:{\"click\":function($event){return _vm.selectTransform('select')}}},[_c('i',{staticClass:\"fas fa-mouse-pointer\"})]),_c('div',{staticClass:\"toolbarButton\",class:{active: _vm.activeTransform === 'translate', disabled: _vm.state !== 'idle'},attrs:{\"title\":\"Select and Move (W)\"},on:{\"click\":function($event){return _vm.selectTransform('translate')}}},[_c('i',{staticClass:\"fas fa-arrows-alt\"})]),_c('div',{staticClass:\"toolbarButton\",class:{active: _vm.activeTransform === 'rotate', disabled: _vm.state !== 'idle'},attrs:{\"title\":\"Select and Rotate (E)\"},on:{\"click\":function($event){return _vm.selectTransform('rotate')}}},[_c('i',{staticClass:\"fas fa-undo\"})]),_c('div',{staticClass:\"toolbarButton\",class:{disabled: _vm.state !== 'idle' || _vm.selectedEntities.length === 0},attrs:{\"title\":\"Delete Selected (Supr)\"},on:{\"click\":_vm.removeSelectedEntities}},[_c('i',{staticClass:\"far fa-trash-alt\"})])]),_c('div',{staticClass:\"controlsSection\"},[_c('div',{staticClass:\"toolbarButton\",class:{\n          invisible: _vm.state === 'playingFromSelection' || (_vm.state === 'paused' && _vm.stateBeforePause === 'playingFromSelection'),\n          hidden: _vm.state === 'playing' || (_vm.state === 'paused' && _vm.stateBeforePause !== 'playingFromSelection')\n        },attrs:{\"title\":\"Play (Space)\"},on:{\"click\":function($event){return _vm.play(false)}}},[_c('i',{staticClass:\"fas fa-play\"})]),(_vm.state !== 'idle')?_c('div',{staticClass:\"toolbarButton\",attrs:{\"title\":\"Stop (Space)\"},on:{\"click\":_vm.stop}},[_c('i',{staticClass:\"fas fa-stop\"})]):_vm._e(),(_vm.state === 'idle' && _vm.selectedEntities.length === 1 && _vm.selectedEntities[0].type === 'tile')?_c('div',{staticClass:\"toolbarButton\",attrs:{\"title\":\"Play from Selection (Ctrl + Space)\"},on:{\"click\":function($event){return _vm.play(true)}}},[_c('i',{staticClass:\"far fa-play-circle\"})]):_vm._e(),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.state !== 'idle'),expression:\"state !== 'idle'\"}],staticClass:\"toolbarButton\",class:{active: _vm.state === 'paused'},attrs:{\"title\":\"Pause\"},on:{\"click\":_vm.togglePause}},[_c('i',{staticClass:\"fas fa-pause\"})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.state === 'paused'),expression:\"state === 'paused'\"}],staticClass:\"toolbarButton\",attrs:{\"title\":\"Step Forward\"},on:{\"click\":_vm.stepForward}},[_c('i',{staticClass:\"fas fa-step-forward\"})])]),_c('div',{staticClass:\"entitiesStats\"},[_vm._v(_vm._s(_vm.numValidEntitiesInTheScene)+\" of \"+_vm._s(_vm.maxNumEntitiesInScene)+\" elements used\")]),_c('div',{staticClass:\"controlsSection\",style:({'margin-left': 'auto', 'margin-right': '40px'})},[(_vm.sceneUuid)?_c('div',{staticClass:\"sceneUuid\"},[_c('div',{staticClass:\"toolbarButton\",attrs:{\"title\":\"Copy board URL to the clipboard\"},on:{\"click\":_vm.copySceneUrlToClipboard}},[_c('i',{staticClass:\"fas fa-share-square\"})])]):_c('div',{staticClass:\"toolbarButton\",class:{disabled: _vm.state !== 'idle' || _vm.numValidEntitiesInTheScene > _vm.maxNumEntitiesInScene},attrs:{\"title\":\"Publish Board\"},on:{\"click\":_vm.publishScene}},[_c('i',{staticClass:\"fas fa-cloud-upload-alt\"})]),_c('div',{staticClass:\"toolbarButton\",class:{disabled: _vm.state !== 'idle'},attrs:{\"title\":\"Help\"},on:{\"click\":_vm.openHelpDialog}},[_c('i',{staticClass:\"fas fa-question\"})])])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.state === 'validating'),expression:\"state === 'validating'\"}],staticClass:\"validatingScene\"},[_c('div',{staticClass:\"mask\"},[_c('div',{staticClass:\"messageArea\"},[_c('div',{staticClass:\"message\"},[_vm._v(\"Validating board...\")]),_c('div',{staticClass:\"toolbarButton\",on:{\"click\":_vm.cancelValidation}},[_vm._v(\"Cancel\")])])])]),_c('div',{ref:\"scene\",staticClass:\"scene\",class:{batchStamperActive: _vm.batchStamper.active},on:{\"mousedown\":_vm.onMouseDown,\"mouseup\":_vm.onMouseUp,\"mousemove\":_vm.onMouseMove}},[(_vm.batchStamper.active)?_c('div',{staticClass:\"stamperMessage\"},[_vm._v(\"Stamper Mode\")]):_vm._e()]),_c('div',{staticClass:\"panel\"},[_c('CommandPanel',{ref:\"commandPanel\",attrs:{\"batchStamperParameters\":_vm.batchStamper.parameters,\"selectedEntities\":_vm.selectedEntities,\"editingGroup\":_vm.world ? _vm.world.group : null},on:{\"batch-stamper-on\":_vm.onBatchStamperOn,\"batch-stamper-off\":_vm.onBatchStamperOff,\"rebuild-batch-stamper\":_vm.rebuildBatchStamper,\"rotate-selected-entities\":_vm.rotateSelectedEntities,\"move-selected-entities\":_vm.moveSelectedEntities,\"colorize-selected-entities\":_vm.colorizeSelectedEntities,\"rotate-group-entities\":_vm.rotateGroupEntities,\"move-group-entities\":_vm.moveGroupEntities,\"colorize-group-entities\":_vm.colorizeGroupEntities,\"select-entities\":_vm.onSelectEntities,\"deselect-entities\":_vm.onDeselectEntities}})],1),_c('IODialog',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.dialogVisible === 'ioDialog'),expression:\"dialogVisible === 'ioDialog'\"}],ref:\"ioDialog\",on:{\"close\":function($event){_vm.dialogVisible = null}}}),_c('PublishDialog',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.dialogVisible === 'publishDialog'),expression:\"dialogVisible === 'publishDialog'\"}],ref:\"publishDialog\",on:{\"close\":_vm.closePublishDialog}}),_c('HelpDialog',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.dialogVisible === 'helpDialog'),expression:\"dialogVisible === 'helpDialog'\"}],ref:\"helpDialog\",on:{\"close\":function($event){_vm.dialogVisible = null}}}),(_vm.selectionBox)?_c('div',{ref:\"selectionBox\",staticClass:\"selectionBox\",style:({top: _vm.selectionBox.top + 'px', left: _vm.selectionBox.left + 'px', width: _vm.selectionBox.width + 'px', height: _vm.selectionBox.height + 'px'})}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import * as THREE from 'three'\r\n\r\nexport const NUM_MAX_ENTITIES_IN_EDITOR = 5000\r\n\r\nexport const SCENE_INITIAL_TILE_IDX = 1\r\nexport const SCENE_LAST_TILE_IDX = 2\r\n\r\nexport const TILE_SIZE = {x: 2, y: 4, z: 0.6}\r\nexport const GROUND_SIZE = {x: 100, y: 1, z: 100}\r\nexport const BALL_RADIUS = 2.5\r\n\r\nexport const TILE_Y_POSITION = (TILE_SIZE.y + GROUND_SIZE.y) / 2 + 0.05\r\nexport const BALL_Y_POSITION = BALL_RADIUS + 0.5\r\nexport const INITIAL_IMPULSE_VALUE = 100\r\n\r\nexport const GROUND_GEOMETRY = new THREE.BoxBufferGeometry(GROUND_SIZE.x, GROUND_SIZE.y, GROUND_SIZE.z)\r\nexport const TILE_GEOMETRY = new THREE.BoxBufferGeometry(TILE_SIZE.x, TILE_SIZE.y, TILE_SIZE.z)\r\nexport const BALL_GEOMETRY = new THREE.SphereBufferGeometry(BALL_RADIUS, 24, 24)\r\n\r\nexport const MAX_SCENE_TITLE_LENGTH = 50\r\nexport const MAX_SCENE_AUTHOR_LENGTH = 30\r\n","import _ from 'lodash'\r\n\r\nclass Action {\r\n  constructor(options, editor) {\r\n    this.options = options || {}\r\n    this.editor = editor\r\n  }\r\n\r\n  redo() {\r\n    this.do()\r\n  }\r\n\r\n  do() {}\r\n  undo() {}\r\n}\r\n\r\nexport class AddEntities extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n    this.entities = _.clone(this.options.entities)\r\n  }\r\n\r\n  do() {\r\n    for (const entity of this.entities) {\r\n      entity.addToRenderWorld()\r\n      this.options.group.addChild(entity)\r\n    }\r\n  }\r\n\r\n  undo() {\r\n    for (const entity of this.entities) {\r\n      entity.removeFromRenderWorld()\r\n      this.options.group.removeChild(entity)\r\n    }\r\n  }\r\n}\r\n\r\nexport class MoveEntities extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n\r\n    this.previousPosition = {}\r\n    for (const entity of options.entities) {\r\n      this.previousPosition[entity.id] = entity.position.clone()\r\n    }\r\n  }\r\n\r\n  do() {\r\n    for (const entity of this.options.entities) {\r\n      entity.setPosition(entity.position.x + this.options.offset.x, entity.position.y + this.options.offset.y, entity.position.z + this.options.offset.z)\r\n    }\r\n  }\r\n\r\n  undo() {\r\n    for (const entity of this.options.entities) {\r\n      const prevPos = this.previousPosition[entity.id]\r\n      entity.setPosition(prevPos.x, prevPos.y, prevPos.z)\r\n    }\r\n  }\r\n}\r\n\r\nexport class RotateEntities extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n\r\n    this.previousRotation = {}\r\n    for (const entity of options.entities) {\r\n      this.previousRotation[entity.id] = entity.angleY\r\n    }\r\n  }\r\n\r\n  do() {\r\n    for (const entity of this.options.entities) {\r\n      entity.setRotation(entity.angleY + this.options.offset)\r\n    }\r\n  }\r\n\r\n  undo() {\r\n    for (const entity of this.options.entities) {\r\n      entity.setRotation(this.previousRotation[entity.id])\r\n    }\r\n  }\r\n}\r\n\r\nexport class RemoveEntities extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n\r\n    this.entities = _.clone(this.options.entities)\r\n  }\r\n\r\n  do() {\r\n    let toRemove = []\r\n\r\n    for (const entity of this.entities) {\r\n      entity.removeFromRenderWorld()\r\n      this.options.group.removeChild(entity)\r\n      toRemove.push(entity)\r\n    }\r\n\r\n    this.editor.deselectEntities(toRemove)\r\n  }\r\n\r\n  undo() {\r\n    let toSelect = []\r\n\r\n    for (const entity of this.entities) {\r\n      entity.addToRenderWorld()\r\n      this.options.group.addChild(entity)\r\n      toSelect.push(entity)\r\n    }\r\n\r\n    this.editor.selectEntities(toSelect, true)\r\n  }\r\n}\r\n\r\nexport class SelectEntities extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n    this.entities = _.clone(this.options.entities)\r\n    this.prevSelection = _.clone(this.editor.selectedEntities)\r\n  }\r\n\r\n  do() {\r\n    this.editor.selectEntities(this.entities, this.options.adding)\r\n  }\r\n\r\n  undo() {\r\n    this.editor.selectEntities(this.prevSelection)\r\n  }\r\n}\r\n\r\nexport class DeselectEntities extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n\r\n    this.entities = _.clone(this.options.entities)\r\n  }\r\n\r\n  do() {\r\n    this.editor.deselectEntities(this.entities)\r\n  }\r\n\r\n  undo() {\r\n    this.editor.selectEntities(this.entities, true)\r\n  }\r\n}\r\n\r\nexport class CombinedActions extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n\r\n    for (const action of this.options.actions) {\r\n      action.editor = editor\r\n    }\r\n  }\r\n\r\n  do() {\r\n    for (const action of this.options.actions) {\r\n      action.do()\r\n    }\r\n  }\r\n\r\n  undo() {\r\n    for (const action of this.options.actions) {\r\n      action.undo()\r\n    }\r\n  }\r\n}\r\n\r\nexport class ColorizeEntities extends Action {\r\n  constructor(options, editor) {\r\n    super(options, editor)\r\n\r\n    this.entities = _.clone(this.options.entities)\r\n    this.prevColors = {}\r\n  }\r\n\r\n  do() {\r\n    for (const entity of this.entities) {\r\n      if (entity.type !== 'group') {\r\n        this.prevColors[entity.id] = entity.getColor()\r\n        entity.setColor(this.options.color)\r\n      }\r\n    }\r\n  }\r\n\r\n  undo() {\r\n    for (const entity of this.entities) {\r\n      if (entity.type !== 'group') {\r\n        entity.setColor(this.prevColors[entity.id])\r\n      }\r\n    }\r\n  }\r\n}","import * as THREE from 'three'\r\nimport _ from 'lodash'\r\n\r\n\r\nexport class IMesh {\r\n  constructor(size, geometry, castShadow) {\r\n    this.auxMatrix = new THREE.Matrix4()\r\n    this.auxColor = new THREE.Color()\r\n    this.auxVector = new THREE.Vector3()\r\n    this.auxVector2 = new THREE.Vector3()\r\n    this.auxQuaternion = new THREE.Quaternion()\r\n    this.auxEuler = new THREE.Euler(0, 0, 0, 'XYZ')\r\n    this.size = size\r\n    this.needsTransformUpdate = false\r\n    this.needsColorUpdate = false\r\n\r\n    let instancedGeometry = new THREE.InstancedBufferGeometry()\r\n\r\n    this.colors = new Float32Array(size * 3)\r\n    this.colors.fill(0xffffff, 0, size)\r\n\r\n    instancedGeometry.vertexColors = true\r\n    instancedGeometry.setAttribute('color', new THREE.InstancedBufferAttribute(this.colors, 3))\r\n\r\n    this.material = new THREE.MeshLambertMaterial({vertexColors: true})\r\n\r\n    THREE.BufferGeometry.prototype.copy.call(instancedGeometry, geometry)\r\n\r\n    this.mesh = new THREE.InstancedMesh(instancedGeometry, this.material, size)\r\n    this.mesh.castShadow = castShadow\r\n    this.mesh.receiveShadow = true\r\n    this.mesh.iMesh = this\r\n  }\r\n\r\n  setCount(count) {\r\n    this.mesh.count = count\r\n  }\r\n\r\n  getCount() {\r\n    return this.mesh.count\r\n  }\r\n\r\n  setTransformAt(idx, x, y, z, rotY, scale) {\r\n    if (_.isUndefined(scale)) {\r\n      scale = 1\r\n    }\r\n\r\n    this.auxMatrix.identity()\r\n    this.auxQuaternion.setFromEuler(new THREE.Euler(0, rotY, 0))\r\n    this.auxVector.set(x, y, z)\r\n    this.auxVector2.set(scale, scale, scale)\r\n\r\n    this.auxMatrix.compose(this.auxVector, this.auxQuaternion, this.auxVector2)\r\n    this.mesh.setMatrixAt(idx, this.auxMatrix)\r\n    this.needsTransformUpdate = true\r\n  }\r\n\r\n  setColorAt(idx, hexColor) {\r\n    if (this.colors) {\r\n      this.auxColor.set(hexColor)\r\n      this.auxColor.toArray(this.colors, idx * 3)\r\n      this.needsColorUpdate = true\r\n    }\r\n  }\r\n\r\n  getColorAt(idx) {\r\n    if (!this.colors) {\r\n      return '#ffffff'\r\n    }\r\n\r\n    this.auxColor.fromArray(this.colors, idx * 3)\r\n    return `#${this.auxColor.getHexString()}`\r\n  }\r\n\r\n  prepareRender() {\r\n    if (this.needsColorUpdate && this.colors) {\r\n      this.mesh.geometry.setAttribute('color', new THREE.InstancedBufferAttribute(this.colors, 3))\r\n    }\r\n\r\n    this.mesh.instanceMatrix.needsUpdate = this.needsTransformUpdate\r\n\r\n    this.needsColorUpdate = false\r\n    this.needsTransformUpdate = false\r\n  }\r\n}\r\n\r\nexport class IMeshManaged extends IMesh {\r\n  constructor(size, geometry, castShadow) {\r\n    super(size, geometry, castShadow)\r\n\r\n    this.freeEntries = []\r\n\r\n    for (let i = 0; i < this.size; ++i) {\r\n      this.freeEntries.push(i)\r\n    }\r\n  }\r\n\r\n  useEntry() {\r\n    if (this.freeEntries.length === 0) {\r\n      // todo: manage error\r\n      return -1\r\n    }\r\n\r\n    return this.freeEntries.pop()\r\n  }\r\n\r\n  freeEntry(idx) {\r\n    this.freeEntries.push(idx)\r\n  }\r\n}","import * as THREE from 'three'\r\nimport Ammo from 'ammo.js'\r\nimport _ from 'lodash'\r\nimport {TILE_SIZE, BALL_RADIUS} from '@/defines'\r\n\r\nconst GROUND_MASS = 0\r\nconst GROUND_SHAPE = new Ammo.btBoxShape(new Ammo.btVector3(55, 0.5, 55))\r\nconst GROUND_LOCAL_INERTIA = new Ammo.btVector3(0, 0, 0)\r\nGROUND_SHAPE.calculateLocalInertia(0, GROUND_LOCAL_INERTIA)\r\n\r\nconst TILE_MASS = 5\r\nconst TILE_SHAPE = new Ammo.btBoxShape(new Ammo.btVector3(TILE_SIZE.x / 2, TILE_SIZE.y / 2, TILE_SIZE.z / 2))\r\nconst TILE_LOCAL_INERTIA = new Ammo.btVector3(0, 0, 0)\r\nTILE_SHAPE.calculateLocalInertia(TILE_MASS, TILE_LOCAL_INERTIA)\r\n\r\nconst BALL_MASS = 5\r\nconst BALL_SHAPE = new Ammo.btSphereShape(BALL_RADIUS)\r\nconst BALL_LOCAL_INERTIA = new Ammo.btVector3(0, 0, 0)\r\nBALL_SHAPE.calculateLocalInertia(BALL_MASS, BALL_LOCAL_INERTIA)\r\n\r\nconst FALLING_TIME_BEFORE_SLEEP = 1\r\nconst FADING_COLOR = new THREE.Color(0xff6600)\r\n\r\nlet EntityIdGen = 0\r\n\r\nclass Entity {\r\n  constructor(options) {\r\n    this.options = options || {}\r\n\r\n    this.id = EntityIdGen++\r\n    this.name = this.options.name || 'Entity'\r\n    this.position = this.options.position ? this.options.position.clone() : new THREE.Vector3()\r\n    this.rotation = new THREE.Quaternion()\r\n    this.angleY = 0\r\n    this.parent = this.options.parent || null\r\n    this.userData = this.options.userData || {}\r\n    this.type = this.options.type || 'entity'\r\n    this.visible = true\r\n    this.frozen = false\r\n\r\n    if (options.angleY) {\r\n      this.angleY = options.angleY\r\n      this.rotation.setFromEuler(new THREE.Euler(0, options.angleY, 0))\r\n    } else if (options.rotation) {\r\n      this.rotation.copy(options.rotation)\r\n    }\r\n  }\r\n\r\n  setPosition(x, y, z) {\r\n    this.position.set(x, y, z)\r\n  }\r\n\r\n  getWorldPosition() {\r\n    if (!this.parent) {\r\n      return this.position.clone()\r\n    }\r\n\r\n    let position = this.position.clone()\r\n    position.add(this.parent.getWorldPosition())\r\n    return position\r\n  }\r\n\r\n  setRotation(y) {\r\n    this.angleY = y\r\n    this.rotation.setFromEuler(new THREE.Euler(0, y, 0))\r\n  }\r\n\r\n  getRotationY() {\r\n    return this.angleY\r\n  }\r\n\r\n  getWorldRotationY() {\r\n    if (!this.parent) {\r\n      return this.angleY\r\n    }\r\n\r\n    return this.parent.getWorldRotationY() + this.angleY\r\n  }\r\n\r\n  move(offsetX, offsetY, offsetZ) {\r\n    this.position.set(this.position.x + offsetX, this.position.y + offsetY, this.position.z + offsetZ)\r\n  }\r\n\r\n  rotate(offsetY) {\r\n    this.setRotation(this.angleY + offsetY)\r\n  }\r\n\r\n  setParent(parent) {\r\n    this.parent = parent\r\n  }\r\n\r\n  getColor() {\r\n    return '#ffffff'\r\n  }\r\n\r\n  setVisible(visible) {\r\n    this.visible = visible\r\n  }\r\n\r\n  setFrozen(frozen) {\r\n    this.frozen = frozen\r\n  }\r\n\r\n  tick() {}\r\n}\r\n\r\nexport class Group extends Entity {\r\n  constructor(options) {\r\n    super(_.assign(options, {\r\n      type: 'group'\r\n    }))\r\n\r\n    this.children = []\r\n  }\r\n\r\n  addChild(child) {\r\n    child.setParent(this)\r\n    this.children.push(child)\r\n  }\r\n\r\n  removeChild(child) {\r\n    child.setParent(null)\r\n    this.children = this.children.filter(t => t.id !== child.id)\r\n  }\r\n\r\n  tick(delta) {\r\n    for (const child of this.children) {\r\n      child.tick(delta)\r\n    }\r\n  }\r\n\r\n  saveState() {\r\n    for (const child of this.children) {\r\n      child.saveState()\r\n    }\r\n  }\r\n\r\n  restoreState() {\r\n    for (const child of this.children) {\r\n      child.restoreState()\r\n    }\r\n  }\r\n\r\n  setVisible(visible) {\r\n    Entity.prototype.setVisible.call(this, visible)\r\n\r\n    for (const child of this.children) {\r\n      if (child.type === 'group') {\r\n        child.setVisible(visible)\r\n      } else {\r\n        // I do this instead call setVisible of the child to avoid modify the child's private \"visible\" variable\r\n        if (visible) {\r\n          if (child.visible) {\r\n            child.scale.set(1, 1, 1)\r\n          }\r\n        } else {\r\n          child.scale.set(0, 0, 0)\r\n        }\r\n        child.updateMatrix()\r\n      }\r\n    }\r\n  }\r\n\r\n  addToRenderWorld() {\r\n    for (const child of this.children) {\r\n      child.addToRenderWorld()\r\n    }\r\n  }\r\n\r\n  removeFromRenderWorld() {\r\n    for (const child of this.children) {\r\n      child.removeFromRenderWorld()\r\n    }\r\n  }\r\n\r\n  addToPhysicalWorld(world) {\r\n    for (const child of this.children) {\r\n      child.addToPhysicalWorld(world)\r\n    }\r\n  }\r\n\r\n  removeFromPhysicalWorld(world) {\r\n    for (const child of this.children) {\r\n      child.removeFromPhysicalWorld(world)\r\n    }\r\n  }\r\n\r\n  findChildById(id) {\r\n    for (const child of this.children) {\r\n      if (child.type === 'group') {\r\n        if (child.id === id) {\r\n          return child\r\n        }\r\n\r\n        const entity = child.findChildById(id)\r\n        if (entity !== null) {\r\n          return entity\r\n        }\r\n      } else if (child.id === id) {\r\n        return child\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  findChildByIMeshEntry(iMeshName, iMeshEntry) {\r\n    for (const child of this.children) {\r\n      if (child.type === 'group') {\r\n        const entity = child.findChildByIMeshEntry(iMeshName, iMeshEntry)\r\n        if (entity !== null) {\r\n          return entity\r\n        }\r\n      } else if ((child.iMeshEntry === iMeshEntry) && (child.iMesh.name === iMeshName)) {\r\n        return child\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  setPosition(x, y, z) {\r\n    const currentPosition = this.position.clone()\r\n\r\n    Entity.prototype.setPosition.call(this, x, y, z)\r\n\r\n    for (const child of this.children) {\r\n      if (child.type !== 'group') {\r\n        if (child.frozen) {\r\n          child.move(currentPosition.x - x, currentPosition.y - y, currentPosition.z - z)\r\n        } else {\r\n          child.updateMatrix()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setRotation(y) {\r\n    this.rotate(y - this.angleY)\r\n  }\r\n\r\n  move(offsetX, offsetY, offsetZ) {\r\n    Entity.prototype.move.call(this, offsetX, offsetY, offsetZ)\r\n\r\n    for (const child of this.children) {\r\n      if (child.type !== 'group') {\r\n        if (child.frozen) {\r\n          // update child position to avoid moving it with the parent\r\n          child.move(-offsetX, -offsetY, -offsetZ)\r\n        } else {\r\n          child.updateMatrix()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  rotate(offsetY) {\r\n    Entity.prototype.setRotation.call(this, this.angleY + offsetY)\r\n\r\n    const cosa = Math.cos(offsetY)\r\n    const sina = Math.sin(offsetY)\r\n\r\n    for (const child of this.children) {\r\n      if (child.type !== 'group') {\r\n        if (!child.frozen) {\r\n          let newX = cosa * child.position.x  - sina * child.position.z\r\n          let newZ = sina * child.position.x  + cosa * child.position.z\r\n          child.setPosition(newX, child.position.y, newZ)\r\n          child.rotate(-offsetY)\r\n          child.updateMatrix()\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport class SimEntity extends Entity {\r\n  constructor(options) {\r\n    super(options)\r\n\r\n    this.iMesh = this.options.iMesh\r\n    this.matrix = new THREE.Matrix4()\r\n    this.scale = 0\r\n    this.iMeshEntry = -1\r\n    this.fallingTimer = 0\r\n    this.world = null\r\n    this.state = 'idle'\r\n    this.color = this.options.color || '#ffffff'\r\n    this.overrideColor = null\r\n  }\r\n\r\n  setPosition(x, y, z) {\r\n    Entity.prototype.setPosition.call(this, x, y, z)\r\n    this.updateMatrix()\r\n  }\r\n\r\n  setRotation(y) {\r\n    Entity.prototype.setRotation.call(this, y)\r\n    this.updateMatrix()\r\n  }\r\n\r\n  move(offsetX, offsetY, offsetZ) {\r\n    Entity.prototype.move.call(this, offsetX, offsetY, offsetZ)\r\n    this.updateMatrix()\r\n  }\r\n\r\n  rotate(offsetY) {\r\n    Entity.prototype.rotate.call(this, offsetY)\r\n    this.updateMatrix()\r\n  }\r\n\r\n  saveState() {\r\n    this.positionSaved = this.position.clone()\r\n    this.rotationSaved = this.rotation.clone()\r\n    this.stateSaved = this.state\r\n  }\r\n\r\n  restoreState() {\r\n    this.position.copy(this.positionSaved)\r\n    this.rotation.copy(this.rotationSaved)\r\n    this.state = this.stateSaved\r\n    this.updateMatrix()\r\n  }\r\n\r\n  updateMatrix() {\r\n    let position = this.getWorldPosition()\r\n    this.iMesh.setTransformAt(this.iMeshEntry, position.x, position.y, position.z, this.angleY, this.scale)\r\n  }\r\n\r\n  addToRenderWorld() {\r\n    if (this.iMeshEntry !== -1) {\r\n      return\r\n    }\r\n\r\n    this.iMeshEntry = this.iMesh.useEntry()\r\n\r\n    if (this.iMeshEntry !== -1) {\r\n      this.setVisible(true)\r\n      this.setColor(this.color)\r\n    }\r\n  }\r\n\r\n  removeFromRenderWorld() {\r\n    if (this.iMeshEntry === -1) {\r\n      return\r\n    }\r\n\r\n    if (this.iMeshEntry !== -1) {\r\n      this.setVisible(false)\r\n      this.iMesh.freeEntry(this.iMeshEntry)\r\n      this.iMeshEntry = -1\r\n    }\r\n  }\r\n\r\n  addToPhysicalWorld(world) {\r\n    if (this.body) {\r\n      return\r\n    }\r\n\r\n    let transform = new Ammo.btTransform()\r\n    const worldPosition = this.getWorldPosition()\r\n\r\n    transform.setIdentity()\r\n    transform.setOrigin(new Ammo.btVector3(worldPosition.x, worldPosition.y, worldPosition.z))\r\n    transform.setRotation(new Ammo.btQuaternion(this.rotation.x, this.rotation.y, this.rotation.z, this.rotation.w))\r\n\r\n    const motionState = new Ammo.btDefaultMotionState(transform)\r\n    const rbInfo = new Ammo.btRigidBodyConstructionInfo(this.options.mass, motionState, this.options.shape, this.options.localInertia)\r\n\r\n    this.body = new Ammo.btRigidBody(rbInfo)\r\n    this.world = world\r\n\r\n    world.physicsWorld.addRigidBody(this.body)\r\n  }\r\n\r\n  removeFromPhysicalWorld(world) {\r\n    if (!this.body) {\r\n      return\r\n    }\r\n\r\n    world.physicsWorld.removeRigidBody(this.body)\r\n\r\n    this.body = null\r\n    this.world = null\r\n  }\r\n\r\n  setVisible(visible) {\r\n    Entity.prototype.setVisible.call(this, visible)\r\n\r\n    if (visible && this.parent && !this.parent.visible) {\r\n      return\r\n    }\r\n\r\n    this.scale = visible ? 1 : 0\r\n    this.updateMatrix()\r\n  }\r\n\r\n  setColor(color) {\r\n    if (this.iMeshEntry !== -1) {\r\n      this.color = color\r\n      this.iMesh.setColorAt(this.iMeshEntry, color)\r\n    }\r\n  }\r\n\r\n  getColor() {\r\n    return this.color\r\n  }\r\n\r\n  setFadingIntensity(intensity) {\r\n    if (this.iMeshEntry !== -1) {\r\n      const color = new THREE.Color(this.color).lerp(FADING_COLOR, intensity).getHexString()\r\n      this.iMesh.setColorAt(this.iMeshEntry, `#${color}`)\r\n    }\r\n  }\r\n\r\n  setParent(parent) {\r\n    Entity.prototype.setParent.call(this, parent)\r\n    this.updateMatrix()\r\n  }\r\n}\r\n\r\nexport class Ground extends SimEntity {\r\n  constructor(options) {\r\n    super(_.assign(options, {\r\n      type: 'ground',\r\n      mass: GROUND_MASS,\r\n      shape: GROUND_SHAPE,\r\n      localInertia: GROUND_LOCAL_INERTIA\r\n    }))\r\n  }\r\n}\r\n\r\nexport class DynEntity extends SimEntity {\r\n  constructor(options) {\r\n    super(options)\r\n\r\n    this.tmpTrans = new Ammo.btTransform()\r\n  }\r\n\r\n  tick() {\r\n    if (!this.body || this.state === 'slept') {\r\n      return false\r\n    }\r\n\r\n    const ms = this.body.getMotionState()\r\n    ms.getWorldTransform(this.tmpTrans)\r\n\r\n    const position = this.tmpTrans.getOrigin()\r\n    const quaternion = this.tmpTrans.getRotation()\r\n    const array = this.iMesh.mesh.instanceMatrix.array\r\n    const arrayIndex = this.iMeshEntry * 16\r\n\r\n    // formula copied from: https://github.com/mrdoob/three.js/blob/master/examples/physics_cannon_instancing.html\r\n    const x = quaternion.x(), y = quaternion.y(), z = quaternion.z(), w = quaternion.w()\r\n    const x2 = x + x, y2 = y + y, z2 = z + z\r\n    const xx = x * x2, xy = x * y2, xz = x * z2\r\n    const yy = y * y2, yz = y * z2, zz = z * z2\r\n    const wx = w * x2, wy = w * y2, wz = w * z2\r\n\r\n    array[arrayIndex + 0] = (1 - (yy + zz))\r\n    array[arrayIndex + 1] = (xy + wz)\r\n    array[arrayIndex + 2] = (xz - wy)\r\n    array[arrayIndex + 3] = 0\r\n\r\n    array[arrayIndex + 4] = (xy - wz)\r\n    array[arrayIndex + 5] = (1 - (xx + zz))\r\n    array[arrayIndex + 6] = (yz + wx)\r\n    array[arrayIndex + 7] = 0\r\n\r\n    array[arrayIndex + 8] = (xz + wy)\r\n    array[arrayIndex + 9] = (yz - wx)\r\n    array[arrayIndex + 10] = (1 - (xx + yy))\r\n    array[arrayIndex + 11] = 0\r\n\r\n    array[arrayIndex + 12] = position.x()\r\n    array[arrayIndex + 13] = position.y()\r\n    array[arrayIndex + 14] = position.z()\r\n    array[arrayIndex + 15] = 1\r\n\r\n    this.iMesh.mesh.instanceMatrix.needsUpdate = true\r\n\r\n    return true\r\n  }\r\n}\r\n\r\nexport class Ball extends DynEntity {\r\n  constructor(options) {\r\n    super(_.assign(options, {\r\n      type: 'ball',\r\n      mass: BALL_MASS,\r\n      shape: BALL_SHAPE,\r\n      localInertia: BALL_LOCAL_INERTIA\r\n    }))\r\n\r\n    this.tmpTrans = new Ammo.btTransform()\r\n  }\r\n}\r\n\r\nexport class Tile extends DynEntity {\r\n  constructor(options) {\r\n    super(_.assign(options, {\r\n      type: 'tile',\r\n      mass: TILE_MASS,\r\n      shape: TILE_SHAPE,\r\n      localInertia: TILE_LOCAL_INERTIA\r\n    }))\r\n  }\r\n\r\n  tick(delta) {\r\n    if (DynEntity.prototype.tick.call(this, delta)) {\r\n      const quaternion = this.tmpTrans.getRotation()\r\n\r\n      const q = new THREE.Quaternion(quaternion.x(), quaternion.y(), quaternion.z(), quaternion.w())\r\n      const p = new THREE.Quaternion()\r\n      p.setFromEuler(new THREE.Euler(0, this.angleY, 0))\r\n      const a = q.angleTo(p)\r\n\r\n      if ((this.state === 'idle') && (a > 0.5)) {\r\n        this.state = 'falling'\r\n        this.fallingTimer = FALLING_TIME_BEFORE_SLEEP\r\n      } else if (this.state === 'falling') {\r\n        this.fallingTimer -= delta\r\n\r\n        if (this.fallingTimer <= 0) {\r\n          this.state = 'slept'\r\n          this.removeFromPhysicalWorld(this.world)\r\n        }\r\n      }\r\n    }\r\n  }\r\n}","import * as THREE from 'three'\r\nimport Ammo from 'ammo.js'\r\nimport {IMeshManaged} from '@/world/imesh'\r\nimport {TILE_GEOMETRY, GROUND_GEOMETRY, BALL_GEOMETRY} from '@/defines'\r\nimport {Group} from './entities'\r\n\r\nexport default class {\r\n  constructor(options) {\r\n    this.domElement = options.domElement\r\n\r\n    this.auxColor = new THREE.Color()\r\n\r\n    this.renderer = new THREE.WebGLRenderer({antialias: true})\r\n    this.renderer.setPixelRatio(window.devicePixelRatio)\r\n    this.renderer.setSize(this.domElement.clientWidth, this.domElement.clientHeight)\r\n    this.renderer.setClearColor('#353535')\r\n    this.renderer.shadowMap.enabled = true\r\n    this.renderer.shadowMap.type = THREE.PCFShadowMap\r\n\r\n    this.domElement.appendChild(this.renderer.domElement)\r\n\r\n    const cameraPosition = options.cameraPosition\r\n    this.camera = new THREE.PerspectiveCamera(45, this.domElement.clientWidth / this.domElement.clientHeight, 0.5, 500)\r\n    this.camera.position.set(cameraPosition.x, cameraPosition.y, cameraPosition.z)\r\n\r\n    this.scene = new THREE.Scene()\r\n    this.group = new Group()\r\n\r\n    // lighting\r\n    let ambient = new THREE.AmbientLight(0xcccccc)\r\n    this.scene.add(ambient)\r\n\r\n    let light = new THREE.DirectionalLight(0xffffff, 0.7)\r\n\r\n    this.lightTarget = new THREE.Object3D()\r\n    this.lightTarget.position.set(this.camera.position.x + 90, 0, this.camera.position.z)\r\n    this.scene.add(this.lightTarget)\r\n\r\n    light.position.set(cameraPosition.x + 110, cameraPosition.y + 70, cameraPosition.z - 20)\r\n    light.target = this.lightTarget\r\n    light.castShadow = true\r\n\r\n    // ver el tema de las sombras si se puede hacer sin esto\r\n    light.shadow.camera.near = 0.5\r\n    light.shadow.camera.far = 500\r\n    light.shadow.bias = 0.0001\r\n    light.shadow.mapSize.width = 2048\r\n    light.shadow.mapSize.height = 2048\r\n\r\n    const d = 150\r\n    light.shadow.camera.left = - d\r\n    light.shadow.camera.right = d\r\n    light.shadow.camera.top = d\r\n    light.shadow.camera.bottom = - d\r\n\r\n    this.directionalLight = light\r\n    this.scene.add(light)\r\n\r\n    this.imTiles = new IMeshManaged(options.numTiles, TILE_GEOMETRY, true)\r\n    this.imTiles.name = 'tiles'\r\n    this.scene.add(this.imTiles.mesh)\r\n\r\n    this.imGrounds = new IMeshManaged(options.numGrounds, GROUND_GEOMETRY, false)\r\n    this.imGrounds.name = 'grounds'\r\n    this.scene.add(this.imGrounds.mesh)\r\n\r\n    this.imBalls = new IMeshManaged(options.numBalls, BALL_GEOMETRY, true)\r\n    this.imBalls.name = 'balls'\r\n    this.scene.add(this.imBalls.mesh)\r\n\r\n    // physics stuff\r\n    let collisionConfiguration = new Ammo.btDefaultCollisionConfiguration()\r\n    let dispatcher = new Ammo.btCollisionDispatcher(collisionConfiguration)\r\n    let overlappingPairCache = new Ammo.btDbvtBroadphase()\r\n    let solver = new Ammo.btSequentialImpulseConstraintSolver()\r\n\r\n    this.physicsWorld = new Ammo.btDiscreteDynamicsWorld(dispatcher, overlappingPairCache, solver, collisionConfiguration)\r\n    this.physicsWorld.setGravity(new Ammo.btVector3(0, -400, 0))\r\n  }\r\n\r\n  tick(delta) {\r\n    this.physicsWorld.stepSimulation(1 / 60, 8)\r\n    this.group.tick(delta)\r\n  }\r\n\r\n  render() {\r\n    this.imTiles.prepareRender()\r\n    this.imGrounds.prepareRender()\r\n    this.imBalls.prepareRender()\r\n\r\n    this.renderer.render(this.scene, this.camera)\r\n  }\r\n\r\n  onWindowResize() {\r\n    this.camera.aspect = this.domElement.clientWidth / this.domElement.clientHeight\r\n    this.camera.updateProjectionMatrix()\r\n    this.renderer.setSize(this.domElement.clientWidth, this.domElement.clientHeight)\r\n  }\r\n}","import * as THREE from 'three'\r\nimport {TILE_Y_POSITION, BALL_Y_POSITION, NUM_MAX_ENTITIES_IN_EDITOR, TILE_GEOMETRY, BALL_GEOMETRY} from '@/defines'\r\nimport {Tile, Ball} from '@/world/entities'\r\nimport {IMesh} from '@/world/imesh'\r\n\r\nexport default class {\r\n  constructor() {\r\n    this.active = false\r\n    this.type = null\r\n    this.stamperInitialPos = null\r\n    this.stamperFinalPos = null\r\n    this.stamperPos = null\r\n    this.batchDef = {}\r\n    this.freeModePoints = []\r\n    this.parameters = {\r\n      single: {\r\n        rotation: 0,\r\n        color: '#02ACA5'\r\n      },\r\n      line: {\r\n        forwardOffset: 2,\r\n        fixedRotation: false,\r\n        rotation: 0,\r\n        color: '#02ACA5'\r\n      },\r\n      free: {\r\n        forwardOffset: 2,\r\n        fixedRotation: false,\r\n        rotation: 0,\r\n        color: '#02ACA5'\r\n      },\r\n      triangle: {\r\n        forwardOffset: 2,\r\n        rightOffset: 2.5,\r\n        fixedRotation: false,\r\n        rotation: 0,\r\n        color: '#02ACA5'\r\n      },\r\n      rectangle: {\r\n        forwardOffset: 3,\r\n        rightOffset: 3,\r\n        rotation: 0,\r\n        color: '#02ACA5'\r\n      },\r\n      image: {\r\n        filename: 'None',\r\n        width: 0,\r\n        height: 0,\r\n        rawData: null,\r\n        data: null,\r\n        forwardOffset: 3,\r\n        rightOffset: 2,\r\n        rotation: 0,\r\n        horSize: 25,\r\n        verSize: 25\r\n      },\r\n      ball: {\r\n        color: '#EA7251'\r\n      }\r\n    }\r\n  }\r\n\r\n  init(editor) {\r\n    this.editor = editor\r\n    this.imTiles = new IMesh(NUM_MAX_ENTITIES_IN_EDITOR, TILE_GEOMETRY, true)\r\n    this.imBalls = new IMesh(1, BALL_GEOMETRY, true)\r\n\r\n    editor.world.scene.add(this.imTiles.mesh)\r\n    editor.world.scene.add(this.imBalls.mesh)\r\n  }\r\n\r\n  render() {\r\n    this.imTiles.prepareRender()\r\n    this.imBalls.prepareRender()\r\n  }\r\n\r\n  reset() {\r\n    this.stamperInitialPos = null\r\n    this.stamperFinalPos = null\r\n    this.stamperPos = null\r\n    this.freeModePoints = []\r\n    this.imTiles.setCount(0)\r\n    this.imBalls.setCount(0)\r\n  }\r\n\r\n  setType(type) {\r\n    this.type = type\r\n  }\r\n\r\n  show(show) {\r\n    if (!show) {\r\n      this.imTiles.setCount(0)\r\n      this.imBalls.setCount(0)\r\n    }\r\n  }\r\n\r\n  onMouseUp(event) {\r\n    const hitPoint = this.editor.getGroundHitPoint(event.offsetX, event.offsetY)\r\n\r\n    if (hitPoint) {\r\n      if (this.type === 'single' || this.type === 'image' || this.type === 'ball') {\r\n        return {x: hitPoint.x, z: hitPoint.z}\r\n      } else {\r\n        if (this.stamperInitialPos) {\r\n          return {x: this.stamperInitialPos.x, z: this.stamperInitialPos.z}\r\n        } else {\r\n          this.stamperInitialPos = hitPoint.clone()\r\n\r\n          if (this.type === 'free') {\r\n            this.freeModePoints.push({x: hitPoint.x, z: hitPoint.z})\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  onMouseMove(event) {\r\n    if (this.active) {\r\n      const hitPoint = this.editor.getGroundHitPoint(event.offsetX, event.offsetY)\r\n\r\n      if (hitPoint) {\r\n        if (this.type === 'free') {\r\n          if (this.freeModePoints.length > 0) {\r\n            const prevPoint = this.freeModePoints[this.freeModePoints.length - 1]\r\n            const dist = Math.sqrt(Math.pow(hitPoint.x - prevPoint.x, 2) + Math.pow(hitPoint.z - prevPoint.z, 2))\r\n\r\n            if (dist >= this.parameters[this.type].forwardOffset) {\r\n              this.freeModePoints.push({x: hitPoint.x, z: hitPoint.z})\r\n              this.rebuild()\r\n            }\r\n          } else {\r\n            this.stamperPos = hitPoint.clone()\r\n          }\r\n        }\r\n        else if (this.type === 'single' || this.type === 'ball') {\r\n          this.stamperPos = hitPoint.clone()\r\n        } else {\r\n          if (!this.stamperInitialPos) {\r\n            this.stamperPos = hitPoint.clone()\r\n          } else {\r\n            this.stamperFinalPos = hitPoint.clone()\r\n          }\r\n        }\r\n        this.rebuild()\r\n      } else if (!this.stamperInitialPos && (this.type !== 'free' || this.freeModePoints.length === 0)) {\r\n        this.show(false)\r\n      }\r\n    }\r\n  }\r\n\r\n  createEntitiesFromStamper(world, parent) {\r\n    let entities = []\r\n\r\n    for (let i = 0; i < this.batchDef.entities.length; ++i) {\r\n      const entityDef = this.batchDef.entities[i]\r\n      let position = new THREE.Vector3(entityDef.offset.x, entityDef.entityType === 'ball' ? BALL_Y_POSITION : TILE_Y_POSITION, entityDef.offset.z)\r\n\r\n      if (this.stamperInitialPos) {\r\n        position.x -= this.stamperInitialPos.x\r\n        position.z -= this.stamperInitialPos.z\r\n      } else if (this.type === 'image') {\r\n        position.x -= this.stamperPos.x\r\n        position.z -= this.stamperPos.z\r\n      }\r\n\r\n      let entity\r\n\r\n      if (entityDef.entityType === 'ball') {\r\n        entity = new Ball({\r\n          name: 'Ball',\r\n          position: position,\r\n          iMesh: world.imBalls,\r\n          color: entityDef.color || this.parameters[this.type].color\r\n        })\r\n      } else {\r\n        entity = new Tile({\r\n          name: 'Tile',\r\n          position: position,\r\n          angleY: entityDef.rotation,\r\n          iMesh: world.imTiles,\r\n          color: entityDef.color || this.parameters[this.type].color\r\n        })\r\n      }\r\n\r\n      entities.push(entity)\r\n\r\n      if (parent) {\r\n        parent.addChild(entity)\r\n      }\r\n    }\r\n\r\n    return entities\r\n  }\r\n\r\n  getParameters() {\r\n    return this.parameters[this.type]\r\n  }\r\n\r\n  rebuild() {\r\n    if (!this.active) {\r\n      return\r\n    }\r\n\r\n    this.batchDef = {\r\n      rotation: 0,\r\n      entities: []\r\n    }\r\n\r\n    const stamperParameters = this.parameters[this.type]\r\n\r\n    switch(this.type) {\r\n      case 'single':\r\n        if (this.stamperPos) {\r\n          this.batchDef.entities.push({offset: {x: this.stamperPos.x, z: this.stamperPos.z}, rotation:THREE.MathUtils.degToRad( parseFloat(stamperParameters.rotation))})\r\n        }\r\n        break\r\n\r\n      case 'ball':\r\n        if (this.stamperPos) {\r\n          this.batchDef.entities.push({offset: {x: this.stamperPos.x, z: this.stamperPos.z}, entityType: 'ball'})\r\n        }\r\n        break\r\n\r\n      case 'line':\r\n        if (!this.stamperInitialPos) {\r\n          if (this.stamperPos) {\r\n            this.batchDef.entities.push({offset: {x: this.stamperPos.x, z: this.stamperPos.z}})\r\n          }\r\n        } else {\r\n          let dir = this.stamperFinalPos.clone()\r\n          dir.sub(this.stamperInitialPos)\r\n          const length = dir.length()\r\n          dir.normalize()\r\n\r\n          const forwardOffset = parseFloat(stamperParameters.forwardOffset)\r\n          const rotation = THREE.MathUtils.degToRad(parseFloat(stamperParameters.rotation))\r\n          let dist = 0\r\n          let i = 0\r\n\r\n          while (dist < length) {\r\n            const offsetValue = (i * forwardOffset)\r\n            const offset = {\r\n              x: this.stamperInitialPos.x + (dir.x * offsetValue),\r\n              z: this.stamperInitialPos.z + (dir.z * offsetValue)\r\n            }\r\n            const rot = stamperParameters.fixedRotation ? rotation : Math.atan2(dir.x, dir.z)\r\n\r\n            this.batchDef.entities.push({offset: offset, rotation: rot})\r\n            dist += forwardOffset;\r\n            ++i\r\n          }\r\n        }\r\n        break\r\n\r\n      case 'triangle':\r\n        if (!this.stamperInitialPos) {\r\n          if (this.stamperPos) {\r\n            this.batchDef.entities.push({offset: {x: this.stamperPos.x, z: this.stamperPos.z}})\r\n          }\r\n        } else {\r\n          let dir = this.stamperFinalPos.clone()\r\n          dir.sub(this.stamperInitialPos)\r\n          const length = dir.length()\r\n          dir.normalize()\r\n\r\n          const forwardOffset = parseFloat(stamperParameters.forwardOffset)\r\n          const rightOffset = parseFloat(stamperParameters.rightOffset)\r\n          const rotation = THREE.MathUtils.degToRad(parseFloat(stamperParameters.rotation))\r\n          let normal = {x: -dir.z, z: dir.x}\r\n          let dist = 0\r\n          let i = 0\r\n\r\n          while (dist < length) {\r\n            const fwd = (i * forwardOffset)\r\n            let right = (rightOffset * i) / 2\r\n\r\n            for (let k = 0; k < i + 1; ++k) {\r\n              const offset = {\r\n                x: this.stamperInitialPos.x + (dir.x * fwd) + (normal.x * right),\r\n                z: this.stamperInitialPos.z + (dir.z * fwd) + (normal.z * right)\r\n              }\r\n              const rot = stamperParameters.fixedRotation ? rotation : Math.atan2(dir.x, dir.z)\r\n\r\n              this.batchDef.entities.push({offset: offset, rotation: rot})\r\n              right -= rightOffset\r\n            }\r\n\r\n            dist += forwardOffset;\r\n            ++i\r\n          }\r\n        }\r\n        break\r\n\r\n      case 'rectangle':\r\n        if (!this.stamperInitialPos) {\r\n          if (this.stamperPos) {\r\n            this.batchDef.entities.push({offset: {x: this.stamperPos.x, z: this.stamperPos.z}})\r\n          }\r\n        } else {\r\n          let length = this.stamperFinalPos.clone()\r\n          length.sub(this.stamperInitialPos)\r\n\r\n          const multX = length.x < 0 ? -1 : 1\r\n          const multZ = length.z < 0 ? -1 : 1\r\n\r\n          length.x = Math.abs(length.x)\r\n          length.z = Math.abs(length.z)\r\n\r\n          const forwardOffset = parseFloat(stamperParameters.forwardOffset)\r\n          const rightOffset = parseFloat(stamperParameters.rightOffset)\r\n          const rotation = THREE.MathUtils.degToRad(parseFloat(stamperParameters.rotation))\r\n\r\n          let offset = {x: 0, z: 0}\r\n          let distX = 0\r\n\r\n          while (distX < length.x) {\r\n            let distZ = 0\r\n\r\n            while (distZ < length.z) {\r\n              this.batchDef.entities.push({offset: {x: this.stamperInitialPos.x + offset.x, z: this.stamperInitialPos.z + offset.z}, rotation: rotation})\r\n              offset.z += rightOffset * multZ\r\n              distZ += rightOffset\r\n            }\r\n\r\n            offset.x += forwardOffset * multX\r\n            offset.z = 0\r\n            distX += forwardOffset\r\n          }\r\n        }\r\n        break\r\n\r\n      case 'image':\r\n        if (stamperParameters.data && this.stamperPos) {\r\n          const forwardOffset = parseFloat(stamperParameters.forwardOffset)\r\n          const rightOffset = parseFloat(stamperParameters.rightOffset)\r\n          const rotation = THREE.MathUtils.degToRad(parseFloat(stamperParameters.rotation))\r\n\r\n          let offset = {x: 0, z: 0}\r\n\r\n          const ratioX = Math.floor(stamperParameters.width / stamperParameters.horSize)\r\n          const ratioY = Math.floor(stamperParameters.height / stamperParameters.verSize)\r\n\r\n          for (let y = 0; y < stamperParameters.verSize; ++y) {\r\n            let idx = y * ratioY * stamperParameters.width\r\n\r\n            for (let x = 0; x < stamperParameters.horSize; ++x) {\r\n              const color = stamperParameters.data[idx]\r\n              this.batchDef.entities.push({offset: {x: this.stamperPos.x + offset.x, z: this.stamperPos.z + offset.z}, rotation: rotation, color: color})\r\n              offset.z += rightOffset\r\n              idx += ratioX\r\n            }\r\n\r\n            offset.z = 0\r\n            offset.x -= forwardOffset\r\n          }\r\n        }\r\n        break\r\n\r\n      case 'free': {\r\n        const rotation = THREE.MathUtils.degToRad(parseFloat(stamperParameters.rotation))\r\n\r\n        if (this.freeModePoints.length > 0) {\r\n          for (const [i, p] of this.freeModePoints.entries()) {\r\n            let dir = {x: 0, z: 0}\r\n\r\n            if (!stamperParameters.fixedRotation) {\r\n              if (i === 0) {\r\n                if (this.freeModePoints.length > 1) {\r\n                  dir.x = this.freeModePoints[1].x - this.freeModePoints[0].x\r\n                  dir.z = this.freeModePoints[1].z - this.freeModePoints[0].z\r\n                }\r\n              } else {\r\n                dir.x = this.freeModePoints[i].x - this.freeModePoints[i - 1].x\r\n                dir.z = this.freeModePoints[i].z - this.freeModePoints[i - 1].z\r\n              }\r\n            }\r\n\r\n            const rot = stamperParameters.fixedRotation ? rotation : Math.atan2(dir.x, dir.z)\r\n            this.batchDef.entities.push({offset: {x: p.x, z: p.z}, rotation: rot})\r\n          }\r\n        } else if (this.stamperPos) {\r\n          this.batchDef.entities.push({offset: {x: this.stamperPos.x, z: this.stamperPos.z}, rotation: stamperParameters.fixedRotation ? rotation : 0})\r\n        }\r\n      }\r\n      break\r\n    }\r\n\r\n    // ...\r\n    const imMesh = this.type === 'ball' ? this.imBalls : this.imTiles\r\n\r\n    imMesh.setCount(Math.min(this.batchDef.entities.length, NUM_MAX_ENTITIES_IN_EDITOR))\r\n\r\n    for (let i = 0; i < this.batchDef.entities.length; ++i) {\r\n      const entityDef = this.batchDef.entities[i]\r\n      imMesh.setColorAt(i, entityDef.color || stamperParameters.color)\r\n      imMesh.setTransformAt(i, entityDef.offset.x, entityDef.entityType === 'ball' ? BALL_Y_POSITION : TILE_Y_POSITION, entityDef.offset.z, entityDef.rotation || 0)\r\n    }\r\n  }\r\n}","import _ from 'lodash'\r\n\r\nconst KEYS_MAPPING = [\r\n  {keyCode: 'KeyZ',   ctrlPressed: true,  shiftPressed: false, method: 'undoAction'},\r\n  {keyCode: 'KeyZ',   ctrlPressed: true,  shiftPressed: true,  method: 'redoAction'},\r\n  {keyCode: 'KeyY',   ctrlPressed: true,  shiftPressed: false, method: 'redoAction'},\r\n  //{keyCode: 'KeyS',   ctrlPressed: true,  shiftPressed: false, method: 'saveScene' },\r\n  {keyCode: 'KeyQ',   ctrlPressed: false, shiftPressed: false, method: function(context) {context.selectTransform('select')}},\r\n  {keyCode: 'KeyW',   ctrlPressed: false, shiftPressed: false, method: function(context) {context.selectTransform('translate')}},\r\n  {keyCode: 'KeyE',   ctrlPressed: false, shiftPressed: false, method: function(context) {context.selectTransform('rotate')}},\r\n  {keyCode: 'Delete', ctrlPressed: false, shiftPressed: false, method: 'removeSelectedEntities'},\r\n  {keyCode: 'Space',  ctrlPressed: false, shiftPressed: false, method: function(context) {\r\n    if (context.state === 'idle') {\r\n      context.play()\r\n    } else if (context.state === 'playing' || context.state === 'playingFromSelection' || context.state === 'paused') {\r\n      context.stop()\r\n    }\r\n  }},\r\n  {keyCode: 'Space',  ctrlPressed: true,  shiftPressed: false, method: function(context) {\r\n    if (context.state === 'idle') {\r\n      if ((context.selectEntities.length === 1) && (context.selectEntities[0].type === 'tile')) {\r\n        context.play(true)\r\n      }\r\n    } else if (context.state === 'playing' || context.state === 'playingFromSelection' || context.state === 'paused') {\r\n      context.stop()\r\n    }\r\n  }}\r\n]\r\n\r\nexport default class {\r\n  constructor(editor) {\r\n    this.editor = editor\r\n    this.keysDown = {}\r\n\r\n    this.onKeyDown = this.onKeyDown.bind(this)\r\n    this.onKeyUp = this.onKeyUp.bind(this)\r\n\r\n    window.addEventListener('keydown', this.onKeyDown)\r\n    window.addEventListener('keyup', this.onKeyUp)\r\n  }\r\n\r\n  onDestroyed() {\r\n    window.removeEventListener('keydown', this.onKeyDown)\r\n    window.removeEventListener('keyup', this.onKeyUp)\r\n  }\r\n\r\n  onKeyDown(event) {\r\n    if (!this.keysDown[event.key]) {\r\n      // ignore keydown if there is a input field active or a modal opened\r\n      if (this.editor.dialogVisible === null && (!document.activeElement || document.activeElement.tagName.toLowerCase() !== 'input')) {\r\n        for (const km of KEYS_MAPPING) {\r\n          if ((event.code === km.keyCode) && (event.ctrlKey === km.ctrlPressed) && (event.shiftKey === km.shiftPressed)) {\r\n            if (_.isFunction(km.method)) {\r\n              km.method(this.editor)\r\n            } else {\r\n              this.editor[km.method]()\r\n            }\r\n          }\r\n        }\r\n        this.keysDown[event.key] = true\r\n      }\r\n    }\r\n  }\r\n\r\n  onKeyUp(event) {\r\n    this.keysDown[event.key] = false\r\n  }\r\n\r\n  isKeyPressed(key) {\r\n    return this.keysDown[key]\r\n  }\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"commandPanel\"},[_c('input',{ref:\"fileSelector\",staticClass:\"fileSelector\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.loadFile}}),_c('div',{staticClass:\"panelContent\"},[_c('div',{staticClass:\"container\",class:{collapsed: _vm.containerCollapsed.sceneInspector},style:({'margin-bottom': '5px'})},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"caret\",on:{\"click\":function($event){return _vm.toggleCollapseState('sceneInspector')}}},[(_vm.containerCollapsed.sceneInspector)?_c('i',{staticClass:\"fas fa-caret-right\"}):_c('i',{staticClass:\"fas fa-caret-down\"})]),_c('div',{staticClass:\"title\"},[_vm._v(\"Board Inspector\")])]),_c('div',{staticClass:\"content\"},[_c('SceneInspector',{ref:\"sceneInspector\",attrs:{\"editingGroup\":_vm.editingGroup,\"selectedEntities\":_vm.selectedEntities},on:{\"select-entities\":_vm.selectEntities,\"deselect-entities\":_vm.deselectEntities}})],1)]),_c('div',{staticClass:\"container\",class:{collapsed: _vm.containerCollapsed.createBatch}},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"caret\",on:{\"click\":function($event){return _vm.toggleCollapseState('createBatch')}}},[(_vm.containerCollapsed.createBatch)?_c('i',{staticClass:\"fas fa-caret-right\"}):_c('i',{staticClass:\"fas fa-caret-down\"})]),_c('div',{staticClass:\"title\"},[_vm._v(\"Create Batch\")])]),_c('div',{staticClass:\"content grid\"},_vm._l((_vm.batchTypes),function(type){return _c('div',{key:type.id,staticClass:\"toggleButton\",class:{active: _vm.activeBatchType === type.id, disabled: type.disabled},on:{\"click\":function($event){return _vm.selectBatchType(type.id)}}},[_vm._v(\" \"+_vm._s(type.name)+\" \")])}),0)]),(_vm.activeBatchType !== null)?_c('div',{staticClass:\"container\",class:{collapsed: _vm.containerCollapsed.stamperParameters}},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"caret\",on:{\"click\":function($event){return _vm.toggleCollapseState('stamperParameters')}}},[(_vm.containerCollapsed.stamperParameters)?_c('i',{staticClass:\"fas fa-caret-right\"}):_c('i',{staticClass:\"fas fa-caret-down\"})]),_c('div',{staticClass:\"title\"},[_vm._v(\"Batch Stamper Parameters\")])]),_c('div',{staticClass:\"content\"},_vm._l((_vm.activeBatchStamperParametersList),function(parameter,pindex){return _c('div',{key:(\"stamper_parameter_\" + pindex),staticClass:\"row\"},[_c('div',{staticClass:\"label\"},[_vm._v(_vm._s(parameter.label)+\":\")]),(parameter.inputType === 'image')?_c('div',{staticClass:\"value image\",attrs:{\"title\":_vm.activeBatchStamperParameters[parameter.field]},on:{\"click\":function($event){return _vm.onBatchStamperParameterClick(parameter)}}},[(_vm.activeBatchStamperParameters.rawData)?_c('img',{ref:\"image\",refInFor:true,attrs:{\"src\":_vm.activeBatchStamperParameters.rawData}}):_vm._e()]):((parameter.inputType)==='checkbox')?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.activeBatchStamperParameters[parameter.field]),expression:\"activeBatchStamperParameters[parameter.field]\"}],staticClass:\"value\",class:{\n              textInput: parameter.inputType === 'number' || parameter.inputType === 'text',\n              checkboxInput: parameter.inputType === 'checkbox',\n              disabled: parameter.isEnabled && !parameter.isEnabled()\n            },attrs:{\"readonly\":parameter.isEnabled && !parameter.isEnabled(),\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.activeBatchStamperParameters[parameter.field])?_vm._i(_vm.activeBatchStamperParameters[parameter.field],null)>-1:(_vm.activeBatchStamperParameters[parameter.field])},on:{\"change\":[function($event){var $$a=_vm.activeBatchStamperParameters[parameter.field],$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.activeBatchStamperParameters, parameter.field, $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.activeBatchStamperParameters, parameter.field, $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.activeBatchStamperParameters, parameter.field, $$c)}},function($event){return _vm.updateBatchStamperParameter(parameter, $event)}]}}):((parameter.inputType)==='radio')?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.activeBatchStamperParameters[parameter.field]),expression:\"activeBatchStamperParameters[parameter.field]\"}],staticClass:\"value\",class:{\n              textInput: parameter.inputType === 'number' || parameter.inputType === 'text',\n              checkboxInput: parameter.inputType === 'checkbox',\n              disabled: parameter.isEnabled && !parameter.isEnabled()\n            },attrs:{\"readonly\":parameter.isEnabled && !parameter.isEnabled(),\"type\":\"radio\"},domProps:{\"checked\":_vm._q(_vm.activeBatchStamperParameters[parameter.field],null)},on:{\"change\":[function($event){return _vm.$set(_vm.activeBatchStamperParameters, parameter.field, null)},function($event){return _vm.updateBatchStamperParameter(parameter, $event)}]}}):_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.activeBatchStamperParameters[parameter.field]),expression:\"activeBatchStamperParameters[parameter.field]\"}],staticClass:\"value\",class:{\n              textInput: parameter.inputType === 'number' || parameter.inputType === 'text',\n              checkboxInput: parameter.inputType === 'checkbox',\n              disabled: parameter.isEnabled && !parameter.isEnabled()\n            },attrs:{\"readonly\":parameter.isEnabled && !parameter.isEnabled(),\"type\":parameter.inputType},domProps:{\"value\":(_vm.activeBatchStamperParameters[parameter.field])},on:{\"change\":function($event){return _vm.updateBatchStamperParameter(parameter, $event)},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.activeBatchStamperParameters, parameter.field, $event.target.value)}}})])}),0)]):_vm._e(),(_vm.entity !== null || _vm.entities.length > 0)?_c('div',{staticClass:\"container\",class:{collapsed: _vm.containerCollapsed.entityParameters}},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"caret\",on:{\"click\":function($event){return _vm.toggleCollapseState('entityParameters')}}},[(_vm.containerCollapsed.entityParameters)?_c('i',{staticClass:\"fas fa-caret-right\"}):_c('i',{staticClass:\"fas fa-caret-down\"})]),_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.entity !== null ? 'Parameters' : 'Multi Parameters'))])]),_c('div',{staticClass:\"content\"},_vm._l((_vm.entityParametersList),function(parameter,pindex){return _c('div',{key:(\"entity_parameter_\" + pindex),staticClass:\"row\"},[_c('div',{staticClass:\"label\"},[_vm._v(_vm._s(parameter.label)+\":\")]),((parameter.inputType)==='checkbox')?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.entityParameters[parameter.field]),expression:\"entityParameters[parameter.field]\"}],staticClass:\"value\",class:{textInput: parameter.inputType === 'number' || parameter.inputType === 'text'},attrs:{\"placeholder\":parameter.placeholder,\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.entityParameters[parameter.field])?_vm._i(_vm.entityParameters[parameter.field],null)>-1:(_vm.entityParameters[parameter.field])},on:{\"change\":[function($event){var $$a=_vm.entityParameters[parameter.field],$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.entityParameters, parameter.field, $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.entityParameters, parameter.field, $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.entityParameters, parameter.field, $$c)}},function($event){return _vm.updateEntityParameter(parameter, $event)}]}}):((parameter.inputType)==='radio')?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.entityParameters[parameter.field]),expression:\"entityParameters[parameter.field]\"}],staticClass:\"value\",class:{textInput: parameter.inputType === 'number' || parameter.inputType === 'text'},attrs:{\"placeholder\":parameter.placeholder,\"type\":\"radio\"},domProps:{\"checked\":_vm._q(_vm.entityParameters[parameter.field],null)},on:{\"change\":[function($event){return _vm.$set(_vm.entityParameters, parameter.field, null)},function($event){return _vm.updateEntityParameter(parameter, $event)}]}}):_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.entityParameters[parameter.field]),expression:\"entityParameters[parameter.field]\"}],staticClass:\"value\",class:{textInput: parameter.inputType === 'number' || parameter.inputType === 'text'},attrs:{\"placeholder\":parameter.placeholder,\"type\":parameter.inputType},domProps:{\"value\":(_vm.entityParameters[parameter.field])},on:{\"change\":function($event){return _vm.updateEntityParameter(parameter, $event)},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.entityParameters, parameter.field, $event.target.value)}}})])}),0)]):_vm._e()])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sceneInspector\"},[_c('div',{staticClass:\"filter\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.filter),expression:\"filter\"}],attrs:{\"type\":\"text\",\"placeholder\":\"filter\"},domProps:{\"value\":(_vm.filter)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.filter=$event.target.value}}}),_c('div',{staticClass:\"clear\",attrs:{\"title\":\"Remove Filter\"},on:{\"click\":function($event){_vm.filter = ''}}},[_vm._v(\"  \")])]),_c('div',{staticClass:\"list\"},[_c('div',{staticClass:\"entitiesList\"},_vm._l((_vm.entitiesInfo),function(info,eindex){return _c('div',{key:info.entity.id,staticClass:\"entityItem\",class:{\n          odd: (eindex % 2) !== 0,\n          child: info.isChild,\n          frozen: info.entity.frozen,\n          selected: info.selected\n        }},[_c('div',{staticClass:\"info\"},[_c('div',{staticClass:\"connection\",class:{\n              hasCaret: info.isGroup,\n              collapsed: info.isCollapsed\n            }},[(info.isGroup)?_c('div',{staticClass:\"caret\",on:{\"click\":function($event){return _vm.toggleCollapseState(info)}}},[(info.isCollapsed)?_c('i',{staticClass:\"fas fa-caret-right\"}):_c('i',{staticClass:\"fas fa-caret-down\"})]):_vm._e(),_c('div',{staticClass:\"verticalLine\"}),_c('div',{staticClass:\"horizontalLine\"})]),_c('div',{staticClass:\"visibility\",on:{\"click\":function($event){return _vm.toggleVisibility(info.entity.id)}}},[(info.entity.visible)?_c('i',{staticClass:\"far fa-eye\"}):_c('i',{staticClass:\"far fa-eye-slash\"})]),_c('div',{staticClass:\"name\",on:{\"click\":function($event){return _vm.selectEntity(info.entity, $event)}}},[_vm._v(\" \"+_vm._s(info.entity.name)+\" \")]),_c('div',{staticClass:\"frozen\",on:{\"click\":function($event){return _vm.toggleFrozenbility(info.entity.id)}}},[_c('i',{staticClass:\"far fa-snowflake\"})])])])}),0)])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"sceneInspector\">\r\n    <div class=\"filter\">\r\n      <input type=\"text\" v-model=\"filter\" placeholder=\"filter\">\r\n      <div\r\n        class=\"clear\"\r\n        v-on:click=\"filter = ''\"\r\n        title=\"Remove Filter\"\r\n      >\r\n        &#x2715;\r\n      </div>\r\n    </div>\r\n    <div class=\"list\">\r\n      <div class=\"entitiesList\">\r\n        <div\r\n          v-for=\"(info, eindex) in entitiesInfo\"\r\n          class=\"entityItem\"\r\n          v-bind:key=\"info.entity.id\"\r\n          v-bind:class=\"{\r\n            odd: (eindex % 2) !== 0,\r\n            child: info.isChild,\r\n            frozen: info.entity.frozen,\r\n            selected: info.selected\r\n          }\"\r\n        >\r\n          <div class=\"info\">\r\n            <div\r\n              class=\"connection\"\r\n              v-bind:class=\"{\r\n                hasCaret: info.isGroup,\r\n                collapsed: info.isCollapsed\r\n              }\"\r\n            >\r\n              <div\r\n                class=\"caret\" v-if=\"info.isGroup\"\r\n                v-on:click=\"toggleCollapseState(info)\"\r\n              >\r\n                <i v-if=\"info.isCollapsed\" class=\"fas fa-caret-right\"></i>\r\n                <i v-else class=\"fas fa-caret-down\"></i>\r\n              </div>\r\n              <div class=\"verticalLine\"/>\r\n              <div class=\"horizontalLine\"/>\r\n            </div>\r\n            <div\r\n              class=\"visibility\"\r\n              v-on:click=\"toggleVisibility(info.entity.id)\"\r\n            >\r\n              <i v-if=\"info.entity.visible\" class=\"far fa-eye\"></i>\r\n              <i v-else class=\"far fa-eye-slash\"></i>\r\n            </div>\r\n            <div\r\n              class=\"name\"\r\n              v-on:click=\"selectEntity(info.entity, $event)\"\r\n            >\r\n              {{info.entity.name}}\r\n            </div>\r\n            <div\r\n              class=\"frozen\"\r\n              v-on:click=\"toggleFrozenbility(info.entity.id)\"\r\n            >\r\n              <i class=\"far fa-snowflake\"></i>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport _ from 'lodash'\r\n\r\nexport default {\r\n  name: 'SceneInspector',\r\n  props: ['editingGroup', 'selectedEntities'],\r\n  data: function() {\r\n    return {\r\n      groupCollapsed: {},\r\n      filter: ''\r\n    }\r\n  },\r\n  computed: {\r\n    entitiesInfo: function() {\r\n      if (!this.editingGroup) {\r\n        return []\r\n      }\r\n\r\n      let entitiesInfo = []\r\n      const filterLowercase = this.filter.toLowerCase()\r\n\r\n      for (const entity of this.editingGroup.children) {\r\n        let info = {\r\n          entity: entity,\r\n          selected: !!this.selectedEntities.find(e => e.id === entity.id)\r\n        }\r\n\r\n        if (filterLowercase) {\r\n          const entityNameLowercase = entity.name.toLowerCase()\r\n\r\n          if (entity.type === 'group') {\r\n            info.isGroup = true\r\n            info.isCollapsed = this.groupCollapsed[entity.id]\r\n            const groupIdx = entitiesInfo.length\r\n\r\n            for (const child of entity.children) {\r\n              if (child.name.toLowerCase().indexOf(filterLowercase) !== -1) {\r\n                entitiesInfo.push({\r\n                  entity: child,\r\n                  isChild: true,\r\n                  selected: !!this.selectedEntities.find(e => e.id === child.id)\r\n                })\r\n              }\r\n            }\r\n\r\n            if (groupIdx !== entitiesInfo.length) {\r\n              // there are children that pass the filter. Add the group no matter if it passes the filter and open it\r\n              if (info.isCollapsed) {\r\n                info.isCollapsed = false\r\n              }\r\n              entitiesInfo.splice(groupIdx, 0, info)\r\n            } else if (entityNameLowercase.indexOf(filterLowercase) !== -1) {\r\n              info.isGroup = false\r\n              entitiesInfo.push(info)\r\n            }\r\n          } else if (entityNameLowercase.indexOf(filterLowercase) !== -1) {\r\n            entitiesInfo.push(info)\r\n          }\r\n        } else {\r\n          if (entity.type === 'group') {\r\n            const isCollapsed = _.isUndefined(this.groupCollapsed[entity.id]) ? true : this.groupCollapsed[entity.id]\r\n\r\n            entitiesInfo.push({\r\n              isCollapsed: isCollapsed,\r\n              isGroup: true,\r\n              selected: info.selected,\r\n              entity: info.entity\r\n            })\r\n\r\n            if (!isCollapsed) {\r\n              for (const child of entity.children) {\r\n                entitiesInfo.push({\r\n                  entity: child,\r\n                  isChild: true,\r\n                  selected: !!this.selectedEntities.find(e => e.id === child.id)\r\n                })\r\n              }\r\n            }\r\n          } else {\r\n            entitiesInfo.push(info)\r\n          }\r\n        }\r\n      }\r\n\r\n      return entitiesInfo\r\n    }\r\n  },\r\n  methods: {\r\n    selectEntity: function(entity, event) {\r\n      if (event.ctrlKey) {\r\n        // toggle entity selection\r\n        const isSelected = !!this.selectedEntities.find(e => e.id === entity.id)\r\n\r\n        if (isSelected) {\r\n          this.$emit('deselect-entities', [entity])\r\n        } else {\r\n          this.$emit('select-entities', [entity], true)\r\n        }\r\n      } else if (event.shiftKey) {\r\n        let selection = [entity]\r\n\r\n        // select all the entities from the last select entity to the current one\r\n        if (this.selectedEntities.length > 0) {\r\n          const fromEntity = this.selectedEntities[this.selectedEntities.length - 1]\r\n          let fromIdx = -1\r\n          let toIdx = -1\r\n\r\n          for (let i = 0; i < this.entitiesInfo.length; ++i ) {\r\n            const entityInfo = this.entitiesInfo[i]\r\n\r\n            if (entityInfo.entity.id === fromEntity.id) {\r\n              fromIdx = i\r\n            }\r\n\r\n            if (entityInfo.entity.id === entity.id) {\r\n              toIdx = i\r\n            }\r\n\r\n            if (fromIdx !== -1 && toIdx !== -1) {\r\n              break\r\n            }\r\n          }\r\n\r\n          if (fromIdx !== -1 && toIdx !== -1) {\r\n            selection = []\r\n\r\n            if (toIdx < fromIdx) {\r\n              const aux = fromIdx\r\n              fromIdx = toIdx\r\n              toIdx = aux\r\n            }\r\n\r\n            for (let i = fromIdx; i <= toIdx; ++i) {\r\n              selection.push(this.entitiesInfo[i].entity)\r\n            }\r\n          }\r\n        }\r\n\r\n        this.$emit('select-entities', selection)\r\n      } else {\r\n        this.$emit('select-entities', [entity])\r\n      }\r\n    },\r\n    toggleCollapseState: function(entityInfo) {\r\n      if (_.isUndefined(this.groupCollapsed[entityInfo.entity.id])) {\r\n        Vue.set(this.groupCollapsed, entityInfo.entity.id, false)\r\n      } else {\r\n        Vue.set(this.groupCollapsed, entityInfo.entity.id, !this.groupCollapsed[entityInfo.entity.id])\r\n      }\r\n    },\r\n    toggleVisibility: function(entityId) {\r\n      const entity = this.editingGroup.findChildById(entityId)\r\n      if (entity) {\r\n        entity.setVisible(!entity.visible)\r\n      }\r\n    },\r\n    toggleFrozenbility: function(entityId) {\r\n      const entity = this.editingGroup.findChildById(entityId)\r\n      if (entity) {\r\n        entity.setFrozen(!entity.frozen)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.sceneInspector {\r\n  background: #444444;\r\n  margin-top: 5px;\r\n\r\n  .filter {\r\n    height: 30px;\r\n    display: flex;\r\n    align-items: center;\r\n    padding-left: 5px;\r\n    margin-bottom: 2px;\r\n\r\n    .clear {\r\n      padding-left: 5px;\r\n      padding-right: 5px;\r\n      margin-left: 1px;\r\n      color: white;\r\n      font-size: 14px;\r\n      cursor: pointer;\r\n      height: 24px;\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      &:hover {\r\n        background: #383838;\r\n      }\r\n\r\n      &:active {\r\n        background: #5F8AC1;\r\n      }\r\n    }\r\n\r\n    input {\r\n      flex-grow: 1;\r\n      color: white;\r\n      height: 20px;\r\n      background: #444444;\r\n      border: 1px solid #646464;\r\n      outline: none;\r\n      padding-left: 2px;\r\n      padding-right: 2px;\r\n    }\r\n  }\r\n\r\n  .list {\r\n    .entitiesList {\r\n      height: 350px;\r\n      overflow: auto;\r\n\r\n      .entityItem {\r\n        &.odd {\r\n          .info {\r\n            .name,\r\n            .frozen {\r\n              background: #5A5A5A;\r\n            }\r\n          }\r\n        }\r\n\r\n        &.frozen {\r\n          .info {\r\n            .frozen {\r\n              color: #D0D0D0;\r\n            }\r\n          }\r\n        }\r\n\r\n        &.selected {\r\n          .info {\r\n            .name,\r\n            .frozen {\r\n              background: #5F8AC1;\r\n            }\r\n          }\r\n        }\r\n\r\n        &:first-child {\r\n          .info {\r\n            .connection {\r\n              .verticalLine {\r\n                top: 11px;\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        &:last-child {\r\n          .info {\r\n            .connection {\r\n              .verticalLine {\r\n                height: 11px;\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        &.child {\r\n          margin-left: 14px;\r\n\r\n          .info {\r\n            .name {\r\n              width: 157px;\r\n            }\r\n          }\r\n\r\n          &.odd {\r\n            .info {\r\n              .name,\r\n              .frozen {\r\n                background: #5A5A5A;\r\n              }\r\n            }\r\n          }\r\n\r\n          &:not(.odd) {\r\n            .info {\r\n              .name,\r\n              .frozen {\r\n                background: #4F4F4F;\r\n              }\r\n            }\r\n          }\r\n\r\n          &.selected {\r\n            .info {\r\n              .name,\r\n              .frozen {\r\n                background: #5F8AC1;\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        .info {\r\n          display: flex;\r\n          height: 25px;\r\n          background: #444444;\r\n          align-items: center;\r\n          cursor: pointer;\r\n\r\n          .connection {\r\n            width: 16px;\r\n            height: 25px;\r\n            position: relative;\r\n            overflow: hidden;\r\n\r\n            &.hasCaret {\r\n              &:not(.collapsed) {\r\n                .verticalLine {\r\n                  height: 11px;\r\n                }\r\n              }\r\n            }\r\n\r\n            .horizontalLine {\r\n              position: absolute;\r\n              top: 11px;\r\n              left: 7px;\r\n              width: 7px;\r\n              height: 1px;\r\n              border-top: 1px solid #5B5B5B;\r\n              border-top-style: dotted;\r\n            }\r\n\r\n            .verticalLine {\r\n              position: relative;\r\n              top: 0;\r\n              left: 7px;\r\n              width: 1px;\r\n              height: 25px;\r\n              border-left: 1px solid #5B5B5B;\r\n              border-left-style: dotted;\r\n            }\r\n\r\n            .caret {\r\n              position: absolute;\r\n              top: 3px;\r\n              left: 2px;\r\n              z-index: 1;\r\n              color: #B9B9B9;\r\n              cursor: pointer;\r\n              width: 8px;\r\n\r\n              &:hover {\r\n                color: white;\r\n              }\r\n\r\n              i.fa-caret-right {\r\n                margin-left: 4px;\r\n              }\r\n            }\r\n          }\r\n\r\n          .visibility {\r\n            color: #D0D0D0;\r\n            font-size: 12px;\r\n            cursor: pointer;\r\n\r\n            i {\r\n              width: 15px;\r\n            }\r\n          }\r\n\r\n          .name {\r\n            margin-left: 4px;\r\n            padding-left: 4px;\r\n            padding-right: 4px;\r\n            height: 25px;\r\n            text-align: left;\r\n            line-height: 25px;\r\n            background: #4F4F4F;\r\n            border-left: 1px solid #5B5B5B;\r\n            border-right: 1px solid #5B5B5B;\r\n            color: white;\r\n            font-size: 14px;\r\n            cursor: pointer;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n            white-space: nowrap;\r\n            width: 171px;\r\n          }\r\n\r\n          .frozen {\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            color: #313131;\r\n            background: #4F4F4F;\r\n            font-size: 14px;\r\n            cursor: pointer;\r\n            height: 25px;\r\n            width: 30px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene_inspector.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene_inspector.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./scene_inspector.vue?vue&type=template&id=0f6a8886&scoped=true&\"\nimport script from \"./scene_inspector.vue?vue&type=script&lang=js&\"\nexport * from \"./scene_inspector.vue?vue&type=script&lang=js&\"\nimport style0 from \"./scene_inspector.vue?vue&type=style&index=0&id=0f6a8886&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f6a8886\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"commandPanel\">\r\n    <input type=\"file\" class=\"fileSelector\" ref=\"fileSelector\" v-on:change=\"loadFile\">\r\n    <div class=\"panelContent\">\r\n      <div\r\n        class=\"container\"\r\n        v-bind:class=\"{collapsed: containerCollapsed.sceneInspector}\"\r\n        v-bind:style=\"{'margin-bottom': '5px'}\"\r\n      >\r\n        <div class=\"header\">\r\n          <div\r\n            class=\"caret\"\r\n            v-on:click=\"toggleCollapseState('sceneInspector')\"\r\n          >\r\n            <i v-if=\"containerCollapsed.sceneInspector\" class=\"fas fa-caret-right\"></i>\r\n            <i v-else class=\"fas fa-caret-down\"></i>\r\n          </div>\r\n          <div class=\"title\">Board Inspector</div>\r\n        </div>\r\n        <div class=\"content\">\r\n          <SceneInspector\r\n            ref=\"sceneInspector\"\r\n            v-bind:editingGroup=\"editingGroup\"\r\n            v-bind:selectedEntities=\"selectedEntities\"\r\n            v-on:select-entities=\"selectEntities\"\r\n            v-on:deselect-entities=\"deselectEntities\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <div\r\n        class=\"container\"\r\n        v-bind:class=\"{collapsed: containerCollapsed.createBatch}\"\r\n      >\r\n        <div class=\"header\">\r\n          <div\r\n            class=\"caret\"\r\n            v-on:click=\"toggleCollapseState('createBatch')\"\r\n          >\r\n            <i v-if=\"containerCollapsed.createBatch\" class=\"fas fa-caret-right\"></i>\r\n            <i v-else class=\"fas fa-caret-down\"></i>\r\n          </div>\r\n          <div class=\"title\">Create Batch</div>\r\n        </div>\r\n        <div class=\"content grid\">\r\n          <div\r\n            class=\"toggleButton\"\r\n            v-for=\"type in batchTypes\"\r\n            v-bind:key=\"type.id\"\r\n            v-bind:class=\"{active: activeBatchType === type.id, disabled: type.disabled}\"\r\n            v-on:click=\"selectBatchType(type.id)\"\r\n          >\r\n            {{type.name}}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class=\"container\"\r\n        v-bind:class=\"{collapsed: containerCollapsed.stamperParameters}\"\r\n        v-if=\"activeBatchType !== null\"\r\n      >\r\n        <div class=\"header\">\r\n          <div\r\n            class=\"caret\"\r\n            v-on:click=\"toggleCollapseState('stamperParameters')\"\r\n          >\r\n            <i v-if=\"containerCollapsed.stamperParameters\" class=\"fas fa-caret-right\"></i>\r\n            <i v-else class=\"fas fa-caret-down\"></i>\r\n          </div>\r\n          <div class=\"title\">Batch Stamper Parameters</div>\r\n        </div>\r\n        <div class=\"content\">\r\n          <div\r\n            class=\"row\"\r\n            v-for=\"(parameter, pindex) in activeBatchStamperParametersList\"\r\n            v-bind:key=\"`stamper_parameter_${pindex}`\"\r\n          >\r\n            <div class=\"label\">{{parameter.label}}:</div>\r\n            <div\r\n              v-if=\"parameter.inputType === 'image'\"\r\n              class=\"value image\"\r\n              v-bind:title=\"activeBatchStamperParameters[parameter.field]\"\r\n              v-on:click=\"onBatchStamperParameterClick(parameter)\"\r\n            >\r\n              <img\r\n                v-if=\"activeBatchStamperParameters.rawData\"\r\n                ref=\"image\"\r\n                v-bind:src=\"activeBatchStamperParameters.rawData\"\r\n              />\r\n            </div>\r\n            <input\r\n              v-else\r\n              class=\"value\"\r\n              v-bind:class=\"{\r\n                textInput: parameter.inputType === 'number' || parameter.inputType === 'text',\r\n                checkboxInput: parameter.inputType === 'checkbox',\r\n                disabled: parameter.isEnabled && !parameter.isEnabled()\r\n              }\"\r\n              v-bind:type=\"parameter.inputType\"\r\n              v-bind:readonly=\"parameter.isEnabled && !parameter.isEnabled()\"\r\n              v-model=\"activeBatchStamperParameters[parameter.field]\"\r\n              v-on:change=\"updateBatchStamperParameter(parameter, $event)\"\r\n            >\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div\r\n        class=\"container\"\r\n        v-if=\"entity !== null || entities.length > 0\"\r\n        v-bind:class=\"{collapsed: containerCollapsed.entityParameters}\"\r\n      >\r\n        <div class=\"header\">\r\n          <div\r\n            class=\"caret\"\r\n            v-on:click=\"toggleCollapseState('entityParameters')\"\r\n          >\r\n            <i v-if=\"containerCollapsed.entityParameters\" class=\"fas fa-caret-right\"></i>\r\n            <i v-else class=\"fas fa-caret-down\"></i>\r\n          </div>\r\n          <div class=\"title\">{{entity !== null ? 'Parameters' : 'Multi Parameters'}}</div>\r\n        </div>\r\n        <div class=\"content\">\r\n          <div class=\"row\"\r\n            v-for=\"(parameter, pindex) in entityParametersList\"\r\n            v-bind:key=\"`entity_parameter_${pindex}`\"\r\n          >\r\n            <div class=\"label\">{{parameter.label}}:</div>\r\n            <input\r\n              class=\"value\"\r\n              v-bind:placeholder=\"parameter.placeholder\"\r\n              v-bind:class=\"{textInput: parameter.inputType === 'number' || parameter.inputType === 'text'}\"\r\n              v-bind:type=\"parameter.inputType\"\r\n              v-model=\"entityParameters[parameter.field]\"\r\n              v-on:change=\"updateEntityParameter(parameter, $event)\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport _ from 'lodash'\r\nimport * as THREE from 'three'\r\nimport SceneInspector from './scene_inspector'\r\n\r\nexport default {\r\n  name: 'commandPanel',\r\n  props: ['batchStamperParameters', 'editingGroup', 'selectedEntities'],\r\n  components: {\r\n    SceneInspector\r\n  },\r\n  data: function() {\r\n    return {\r\n      entity: null,\r\n      entities: [],\r\n      entityParameters: null,\r\n      entityParametersList: [],\r\n      activeBatchType: null,\r\n      activeBatchStamperParameters: {},\r\n      activeBatchStamperParametersList: [],\r\n      containerCollapsed: {\r\n        sceneInspector: true\r\n      },\r\n      batchTypes: [{\r\n        id: 'free',\r\n        name: 'Free'\r\n      }, {\r\n        id: 'single',\r\n        name: 'Single'\r\n      }, {\r\n        id: 'line',\r\n        name: 'Line'\r\n      }, {\r\n        id: 'rectangle',\r\n        name: 'Rectangle'\r\n      }, {\r\n        id: 'triangle',\r\n        name: 'Triangle'\r\n      }, {\r\n        id: 'image',\r\n        name: 'Image'\r\n      }, {\r\n        id: 'ball',\r\n        name: 'Ball'\r\n      }, {\r\n        id: 'spiral',\r\n        name: 'Spiral',\r\n        disabled: true\r\n      }]\r\n    }\r\n  },\r\n  methods: {\r\n    refresh: function() {\r\n      if (this.entity) {\r\n        const posXRounded = Math.round(this.entity.position.x)\r\n        const posZRounded = Math.round(this.entity.position.z)\r\n\r\n        this.entityParameters = {\r\n          name: this.entity.name,\r\n          rotation: Math.round(THREE.MathUtils.radToDeg(this.entity.getRotationY()) % 360),\r\n          positionX: (posXRounded === this.entity.position.x) ? posXRounded : this.entity.position.x.toFixed(2),\r\n          positionZ: (posZRounded === this.entity.position.z) ? posZRounded : this.entity.position.z.toFixed(2),\r\n          color: this.entity.getColor()\r\n        }\r\n\r\n        if (this.entity.type === 'group') {\r\n          this.entityParameters.childrenPosX = ''\r\n          this.entityParameters.childrenPosZ = ''\r\n          this.entityParameters.childrenRot = ''\r\n          this.entityParameters.childrenColor = '#ffffff'\r\n        }\r\n      } else if (this.entities) {\r\n        this.entityParameters = {\r\n          rotation: '',\r\n          positionX: '',\r\n          positionY: '',\r\n          color: '#ffffff'\r\n        }\r\n      }\r\n    },\r\n    setEntities: function(entities) {\r\n      this.entity = null\r\n      this.entities = []\r\n\r\n      if (entities.length === 0) {\r\n        return\r\n      }\r\n\r\n      if (entities.length === 1) {\r\n        this.entity = entities[0]\r\n        this.entityParametersList = []\r\n\r\n        if (this.entity) {\r\n          this.entityParametersList = [{\r\n            field: 'name',\r\n            label: 'Name',\r\n            inputType: 'text'\r\n          }]\r\n\r\n          if (this.entity.type === 'ground') {\r\n            this.entityParametersList.push({\r\n              field: 'color',\r\n              label: 'Color',\r\n              inputType: 'color'\r\n            })\r\n          }\r\n          else if (this.entity.type === 'group') {\r\n            this.entityParametersList.push({\r\n              field: 'positionX',\r\n              label: 'X',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'positionZ',\r\n              label: 'Z',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'rotation',\r\n              label: 'Rotation',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'childrenPosX',\r\n              label: 'Children Position X',\r\n              placeholder: 'Set Position X',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'childrenPosZ',\r\n              label: 'Children Position Z',\r\n              placeholder: 'Set Position Z',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'childrenRot',\r\n              label: 'Children Rotation',\r\n              placeholder: 'Set Rotation',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'childrenColor',\r\n              label: 'Children Color',\r\n              inputType: 'color'\r\n            })\r\n          } else if (this.entity.type === 'ball') {\r\n            this.entityParametersList.push({\r\n              field: 'positionX',\r\n              label: 'X',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'positionZ',\r\n              label: 'Z',\r\n              inputType: 'number'\r\n            })\r\n\r\n            this.entityParametersList.push({\r\n              field: 'color',\r\n              label: 'Color',\r\n              inputType: 'color'\r\n            })\r\n          } else {\r\n            this.entityParametersList.push({\r\n              field: 'positionX',\r\n              label: 'X',\r\n              inputType: 'number'\r\n            })\r\n\r\n            if (!this.entity.userData.isFixed) {\r\n              this.entityParametersList.push({\r\n                field: 'positionZ',\r\n                label: 'Z',\r\n                inputType: 'number'\r\n              })\r\n\r\n              this.entityParametersList.push({\r\n                field: 'rotation',\r\n                label: 'Rotation',\r\n                inputType: 'number'\r\n              })\r\n            }\r\n            this.entityParametersList.push({\r\n              field: 'color',\r\n              label: 'Color',\r\n              inputType: 'color'\r\n            })\r\n          }\r\n        }\r\n      } else {\r\n        this.entities = entities\r\n        this.entityParametersList = [{\r\n          field: 'positionX',\r\n          label: 'X',\r\n          inputType: 'number',\r\n          placeholder: 'Set Position X'\r\n        }, {\r\n          field: 'positionZ',\r\n          label: 'Z',\r\n          inputType: 'number',\r\n          placeholder: 'Set Position Z'\r\n        }, {\r\n          field: 'rotation',\r\n          label: 'Rotation',\r\n          inputType: 'number',\r\n          placeholder: 'Set Rotation'\r\n        }, {\r\n          field: 'color',\r\n          label: 'Color',\r\n          inputType: 'color'\r\n        }]\r\n      }\r\n\r\n      this.refresh()\r\n    },\r\n    selectEntities: function(entities, adding) {\r\n      this.$emit('select-entities', entities, adding)\r\n    },\r\n    deselectEntities: function(entities) {\r\n      this.$emit('deselect-entities', entities)\r\n    },\r\n    selectBatchType: function(type) {\r\n      this.activeBatchType = type\r\n      this.activeBatchStamperParametersList = []\r\n\r\n      const self = this\r\n\r\n      if (type) {\r\n        this.activeBatchStamperParameters = this.batchStamperParameters[type]\r\n\r\n        switch(type) {\r\n          case 'single':\r\n            this.activeBatchStamperParametersList = [{\r\n              field: 'rotation',\r\n              label: 'Rotation',\r\n              inputType: 'number'\r\n            }]\r\n          break\r\n\r\n          case 'line':\r\n            this.activeBatchStamperParametersList = [{\r\n              field: 'forwardOffset',\r\n              label: 'Forward Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'fixedRotation',\r\n              label: 'Fixed Rotation',\r\n              inputType: 'checkbox'\r\n            }, {\r\n              field: 'rotation',\r\n              label: 'Children Rotation',\r\n              inputType: 'number',\r\n              isEnabled: function() {\r\n                return self.activeBatchStamperParameters.fixedRotation\r\n              }\r\n            }]\r\n            break\r\n\r\n          case 'free':\r\n            this.activeBatchStamperParametersList = [{\r\n              field: 'forwardOffset',\r\n              label: 'Forward Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'fixedRotation',\r\n              label: 'Fixed Rotation',\r\n              inputType: 'checkbox'\r\n            }, {\r\n              field: 'rotation',\r\n              label: 'Rotation',\r\n              inputType: 'number',\r\n              isEnabled: function() {\r\n                return self.activeBatchStamperParameters.fixedRotation\r\n              }\r\n            }]\r\n            break\r\n\r\n          case 'triangle':\r\n            this.activeBatchStamperParametersList = [{\r\n              field: 'forwardOffset',\r\n              label: 'Forward Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'rightOffset',\r\n              label: 'Right Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'fixedRotation',\r\n              label: 'Fixed Rotation',\r\n              inputType: 'checkbox'\r\n            }, {\r\n              field: 'rotation',\r\n              label: 'Children Rotation',\r\n              inputType: 'number',\r\n              isEnabled: function() {\r\n                return self.activeBatchStamperParameters.fixedRotation\r\n              }\r\n            }]\r\n            break\r\n\r\n          case 'rectangle':\r\n            this.activeBatchStamperParametersList = [{\r\n              field: 'forwardOffset',\r\n              label: 'Forward Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'rightOffset',\r\n              label: 'Right Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'rotation',\r\n              label: 'Children Rotation',\r\n              inputType: 'number'\r\n            }]\r\n            break\r\n\r\n          case 'image':\r\n            this.activeBatchStamperParametersList = [{\r\n              field: 'filename',\r\n              label: 'Image',\r\n              inputType: 'image'\r\n            }, {\r\n              field: 'forwardOffset',\r\n              label: 'Forward Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'rightOffset',\r\n              label: 'Right Offset',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'rotation',\r\n              label: 'Children Rotation',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'horSize',\r\n              label: 'Horizontal Size',\r\n              inputType: 'number'\r\n            }, {\r\n              field: 'verSize',\r\n              label: 'Vertical Size',\r\n              inputType: 'number'\r\n            }]\r\n            break\r\n        }\r\n\r\n        if (type !== 'image') {\r\n          this.activeBatchStamperParametersList.push({\r\n            field: 'color',\r\n            label: (type !== 'single' && type !== 'ball') ? 'Children Color' : 'Color',\r\n            inputType: 'color'\r\n          })\r\n        }\r\n\r\n        this.$emit('batch-stamper-on', type)\r\n      } else {\r\n        this.activeBatchStamperParametersList = []\r\n        this.activeBatchStamperParameters = {}\r\n        this.$emit('batch-stamper-off')\r\n      }\r\n    },\r\n    updateEntityParameter: function(parameter, event) {\r\n      let value = event.target.value\r\n\r\n      switch(parameter.field) {\r\n        case 'name':\r\n          if (value) {\r\n            this.entity.name = value\r\n          } else {\r\n            event.target.value = this.entity.name\r\n          }\r\n          break\r\n\r\n        case 'rotation':\r\n          if (value !== '') {\r\n            this.$emit('rotate-selected-entities', THREE.MathUtils.degToRad(parseFloat(value)))\r\n          } else {\r\n            event.target.value = Math.round(THREE.MathUtils.radToDeg(this.entity.getRotationY()) % 360)\r\n          }\r\n          break\r\n\r\n        case 'positionX':\r\n          if (value !== '') {\r\n            this.$emit('move-selected-entities', {x: parseFloat(value)})\r\n          } else {\r\n            event.target.value = this.entity.position.x\r\n          }\r\n          break\r\n\r\n        case 'positionZ':\r\n          if (value !== '') {\r\n            this.$emit('move-selected-entities', {z: parseFloat(value)})\r\n          } else {\r\n            event.target.value = this.entity.position.z\r\n          }\r\n          break\r\n\r\n        case 'color':\r\n          this.$emit('colorize-selected-entities', value)\r\n          break\r\n\r\n        case 'childrenPosX':\r\n          if (value !== '') {\r\n            this.$emit('move-group-entities', this.entity, {x: parseFloat(value)})\r\n          }\r\n          event.target.value = ''\r\n          break\r\n\r\n        case 'childrenPosZ':\r\n          if (value !== '') {\r\n            this.$emit('move-group-entities', this.entity, {z: parseFloat(value)})\r\n          }\r\n          event.target.value = ''\r\n          break\r\n\r\n        case 'childrenRot':\r\n          if (value !== '') {\r\n            this.$emit('rotate-group-entities', this.entity, THREE.MathUtils.degToRad(parseFloat(value)))\r\n          }\r\n          event.target.value = ''\r\n          break\r\n\r\n        case 'childrenColor':\r\n          if (value !== '') {\r\n            this.$emit('colorize-group-entities', this.entity, value)\r\n          }\r\n          event.target.value = ''\r\n          break\r\n      }\r\n\r\n      if (this.entities.length > 0) {\r\n        event.target.value = ''\r\n      }\r\n    },\r\n    color2Hex: function(components) {\r\n      let values = []\r\n\r\n      for (const c of components) {\r\n        let h = c.toString(16)\r\n        if (h.length === 1) {\r\n          h = '0' + h\r\n        }\r\n        values.push(h)\r\n      }\r\n\r\n      return `#${values[0]}${values[1]}${values[2]}`\r\n    },\r\n    loadFile: function(ev) {\r\n      const file = ev.target.files[0]\r\n      const reader = new FileReader()\r\n      const self = this\r\n\r\n      reader.onload = function() {\r\n        self.activeBatchStamperParameters.filename = file.name\r\n        self.activeBatchStamperParameters.rawData = reader.result\r\n\r\n        // get image pixels\r\n        _.delay(function() {\r\n          const image = self.$refs.image[0]\r\n          let canvas = document.createElement('canvas')\r\n          canvas.width = image.width\r\n          canvas.height = image.height\r\n          canvas.getContext('2d').drawImage(image, 0, 0, image.width, image.height)\r\n\r\n          let data = []\r\n          let idata = canvas.getContext('2d').getImageData(0, 0, image.width, image.height).data\r\n          for (let i = 0; i < idata.length; i += 4) {\r\n            data.push(self.color2Hex([idata[i], idata[i + 1], idata[i + 2]]))\r\n          }\r\n\r\n          self.activeBatchStamperParameters.width = image.width\r\n          self.activeBatchStamperParameters.height = image.height\r\n          self.activeBatchStamperParameters.data = data\r\n\r\n          self.$emit('rebuild-batch-stamper')\r\n        }, 100)\r\n      }\r\n\r\n      reader.readAsDataURL(file)\r\n    },\r\n    onBatchStamperParameterClick: function(parameter) {\r\n      if (parameter.field === 'filename') {\r\n        this.$refs.fileSelector.click()\r\n      }\r\n    },\r\n    updateBatchStamperParameter: function(parameter, event) {\r\n      if (parameter.inputType === 'number') {\r\n        this.activeBatchStamperParameters[parameter.field] = parseFloat(event.target.value)\r\n\r\n        if (parameter.field === 'horSize' || parameter.field === 'verSize') {\r\n          this.activeBatchStamperParameters[parameter.field] = Math.min(Math.max(this.activeBatchStamperParameters[parameter.field], 1), 30)\r\n        } else if (parameter.field === 'rotation') {\r\n          this.activeBatchStamperParameters[parameter.field] = this.activeBatchStamperParameters[parameter.field]\r\n        }\r\n      }\r\n\r\n      this.$emit('rebuild-batch-stamper', parameter.inputType === 'color')\r\n    },\r\n    toggleCollapseState: function(container) {\r\n      Vue.set(this.containerCollapsed, container, !this.containerCollapsed[container])\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n// command panel style \"inspired\" by 3DSMax\r\n.commandPanel {\r\n  padding: 10px;\r\n  background: #444444;\r\n  height: 100%;\r\n  overflow: auto;\r\n\r\n  .fileSelector {\r\n    display: none;\r\n  }\r\n\r\n  .panelContent {\r\n    border: 1px solid #383838;\r\n    margin-top: -1px;\r\n    padding: 10px 5px;\r\n\r\n    .container {\r\n      border: 1px solid #3E3E3E;\r\n      border-radius: 2px;\r\n      background: #515151;\r\n      padding: 5px;\r\n\r\n      &:not(:first-child) {\r\n        margin-top: 5px;\r\n      }\r\n\r\n      &.collapsed {\r\n        .content {\r\n          height: 0px;\r\n          overflow: hidden;\r\n          padding: 0;\r\n        }\r\n      }\r\n\r\n      .header {\r\n        display: flex;\r\n        align-items: center;\r\n        height: 18px;\r\n\r\n        .caret {\r\n          color: #B9B9B9;\r\n          cursor: pointer;\r\n          width: 8px;\r\n\r\n          &:hover {\r\n            color: white;\r\n          }\r\n\r\n          i.fa-caret-right {\r\n            margin-left: 4px;\r\n          }\r\n        }\r\n\r\n        .title {\r\n          color: white;\r\n          font-size: 14px;\r\n          text-align: left;\r\n          margin-left: 8px;\r\n        }\r\n      }\r\n\r\n      .content {\r\n        padding: 0 5px;\r\n\r\n        &.grid {\r\n          display: flex;\r\n          flex-wrap: wrap;\r\n          margin-right: -10px;\r\n        }\r\n\r\n        .row {\r\n          display: flex;\r\n          align-items: center;\r\n          margin-top: 10px;\r\n          font-size: 14px;\r\n\r\n          .label {\r\n            width: 50%;\r\n            text-align: right;\r\n            color: white;\r\n            font-size: 13px;\r\n          }\r\n\r\n          .value {\r\n            width: 50%;\r\n            margin-left: 10px;\r\n            color: #DCDCDC;\r\n\r\n            &.image {\r\n              background: white;\r\n              width: 150px;\r\n              height: 150px;\r\n              border: 1px solid #4A4A4A;\r\n              cursor: pointer;\r\n\r\n              img {\r\n                width: 150px;\r\n                height: 150px;\r\n                object-fit: contain;\r\n              }\r\n            }\r\n\r\n            &.textInput {\r\n              background: #646464;\r\n              border: 1px solid #4A4A4A;\r\n              padding-left: 5px;\r\n              height: 18px;\r\n\r\n              &:not(.disabled) {\r\n                &:focus {\r\n                  outline: 1px solid #4A4A4A;\r\n                  border: 1px solid #D0D0D0;\r\n                }\r\n              }\r\n\r\n              &.disabled {\r\n                outline: none;\r\n                background: #595959;\r\n                border: 1px solid #4A4A4A;\r\n                color: #8F8F8F;\r\n              }\r\n            }\r\n\r\n            &.checkboxInput {\r\n              appearance: none;\r\n              background: #646464;\r\n              border: 1px solid #4A4A4A;\r\n              width: 18px;\r\n              height: 18px;\r\n              cursor: pointer;\r\n              outline: none;\r\n              margin-left: 2px;\r\n\r\n              &:hover {\r\n                border: 1px solid #555555;\r\n                background: #383838;\r\n              }\r\n\r\n              &:checked {\r\n                background: #646464;\r\n\r\n                &:hover {\r\n                  border: 1px solid #555555;\r\n                  background: #383838;\r\n                }\r\n\r\n                &:after {\r\n                  content: '\\2714';\r\n                  font-size: 12px;\r\n                  display: flex;\r\n                  justify-content: center;\r\n                  align-items: center;\r\n                  color: #DCDCDC;\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        .toggleButton {\r\n          padding: 5px 10px;\r\n          margin-top: 10px;\r\n          flex-grow: 1;\r\n          flex-basis: 30%;\r\n          margin-right: 10px;\r\n          display: flex;\r\n          justify-content: center;\r\n          align-items: center;\r\n          border-radius: 4px;\r\n          border: 1px solid #4A4A4A;\r\n          background: #646464;\r\n          color: #DCDCDC;\r\n          cursor: pointer;\r\n\r\n          &:hover {\r\n            border: 1px solid #555555;\r\n            background: #383838;\r\n\r\n            &.active {\r\n              background: #496A93;\r\n            }\r\n          }\r\n\r\n          &.active {\r\n            background: #5F8AC1;\r\n          }\r\n\r\n          &.disabled {\r\n            visibility: hidden;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./command_panel.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./command_panel.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./command_panel.vue?vue&type=template&id=ee80b988&scoped=true&\"\nimport script from \"./command_panel.vue?vue&type=script&lang=js&\"\nexport * from \"./command_panel.vue?vue&type=script&lang=js&\"\nimport style0 from \"./command_panel.vue?vue&type=style&index=0&id=ee80b988&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ee80b988\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mask\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('div',{staticClass:\"ioDialog\",class:_vm.type},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.title))]),(_vm.type === 'load')?_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.input),expression:\"input\"}],ref:\"input\",staticClass:\"input center\",attrs:{\"type\":\"text\",\"placeholder\":\"Enter Board UUID\"},domProps:{\"value\":(_vm.input)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.input=$event.target.value}}})]):(_vm.type === 'message')?_c('div',[_c('div',{staticClass:\"message\"},[_vm._v(_vm._s(_vm.message))])]):_vm._e(),_c('div',{staticClass:\"footer\"},[(_vm.type !== 'message')?_c('div',{staticClass:\"button\",on:{\"click\":_vm.cancel}},[_vm._v(\"Cancel\")]):_vm._e(),(!_vm.noButton)?_c('div',{staticClass:\"button\",on:{\"click\":_vm.accept}},[_vm._v(\"Accept\")]):_vm._e()])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"mask\"\r\n    v-on:click.stop=\"\"\r\n  >\r\n    <div\r\n      class=\"ioDialog\"\r\n      v-bind:class=\"type\"\r\n    >\r\n      <div class=\"title\">{{title}}</div>\r\n      <div v-if=\"type === 'load'\">\r\n        <input ref=\"input\" class=\"input center\" type=\"text\" v-model=\"input\" placeholder=\"Enter Board UUID\">\r\n      </div>\r\n      <div v-else-if=\"type === 'message'\">\r\n        <div class=\"message\">{{message}}</div>\r\n      </div>\r\n      <div class=\"footer\">\r\n        <div v-if=\"type !== 'message'\" class=\"button\" v-on:click=\"cancel\">Cancel</div>\r\n        <div v-if=\"!noButton\" class=\"button\" v-on:click=\"accept\">Accept</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\n\r\nexport default {\r\n  name: 'IODialog',\r\n  data: function() {\r\n    return {\r\n      type: null,\r\n      title: '',\r\n      message: '',\r\n      input: '',\r\n      noButton: false\r\n    }\r\n  },\r\n  methods: {\r\n    open: function(type, params) {\r\n      const self = this\r\n\r\n      switch(type) {\r\n        case 'load':\r\n          this.input = ''\r\n          this.title = 'Load Board'\r\n          Vue.nextTick(() => self.$refs.input.focus())\r\n          break\r\n\r\n        case 'message':\r\n          this.title = params.type\r\n          this.message = params.message\r\n          this.noButton = params.noButton\r\n          break\r\n      }\r\n\r\n      this.type = type\r\n    },\r\n    close: function() {\r\n      this.$emit('close')\r\n    },\r\n    accept: function() {\r\n      let params = null\r\n\r\n      switch(this.type) {\r\n        case 'load':\r\n          if (this.input) {\r\n            params = {uuid: this.input}\r\n          }\r\n          break\r\n      }\r\n\r\n      this.$emit('close', this.type, params)\r\n    },\r\n    cancel: function() {\r\n      this.$emit('close', this.type)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.mask {\r\n  z-index: 2;\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .ioDialog {\r\n    width: 800px;\r\n    height: 300px;\r\n    background: #444444;\r\n    border: 1px solid #2B2B2B;\r\n    border-radius: 5px;\r\n    padding: 10px 40px;\r\n\r\n    &.load {\r\n      height: 150px;\r\n    }\r\n\r\n    &.message {\r\n      height: 130px;\r\n    }\r\n\r\n    .title {\r\n      color: #DCDCDC;\r\n      font-size: 20px;\r\n      margin-bottom: 25px;\r\n      text-transform: uppercase;\r\n      border-bottom: 1px solid #DCDCDC;\r\n      height: 30px;\r\n    }\r\n\r\n    .input {\r\n      height: 30px;\r\n      font-size: 20px;\r\n      width: 100%;\r\n      border: 1px solid #4A4A4A;\r\n      padding-left: 5px;\r\n      outline: none;\r\n\r\n      &:focus {\r\n        outline: 1px solid #4A4A4A;\r\n        border: 1px solid #D0D0D0;\r\n      }\r\n\r\n    }\r\n\r\n    .message {\r\n      color: #DCDCDC;\r\n      font-size: 18px;\r\n    }\r\n\r\n    .footer {\r\n      margin-top: 15px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n\r\n      .button {\r\n        height: 25px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        padding: 5px 10px;\r\n        margin-left: 10px;\r\n        background: #646464;\r\n        border: 1px solid #4A4A4A;\r\n        color: #DCDCDC;\r\n        cursor: pointer;\r\n        border-radius: 4px;\r\n\r\n        &:hover {\r\n          border: 1px solid #555555;\r\n          background: #383838;\r\n        }\r\n\r\n        &:active {\r\n          background: #5F8AC1;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./io_dialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./io_dialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./io_dialog.vue?vue&type=template&id=08321eac&\"\nimport script from \"./io_dialog.vue?vue&type=script&lang=js&\"\nexport * from \"./io_dialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./io_dialog.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mask\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('div',{staticClass:\"publishDialog\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"Publish Board\")]),_c('div',{staticClass:\"form\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"label\"},[_vm._v(\"Title:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.title),expression:\"title\"}],ref:\"title\",attrs:{\"type\":\"text\",\"maxlength\":_vm.maxTitleLength},domProps:{\"value\":(_vm.title)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.title=$event.target.value}}})]),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"label\"},[_vm._v(\"Author:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.author),expression:\"author\"}],attrs:{\"type\":\"text\",\"maxlength\":_vm.maxAuthorLength},domProps:{\"value\":(_vm.author)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.author=$event.target.value}}})])]),_vm._m(0),_c('div',{staticClass:\"footer\"},[_c('div',{staticClass:\"btn\",on:{\"click\":_vm.cancel}},[_vm._v(\"Cancel\")]),_c('div',{staticClass:\"btn accept\",on:{\"click\":_vm.accept}},[_vm._v(\"Accept\")])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"recaptchaMessage\"},[_vm._v(\" This site is protected by reCAPTCHA and the Google \"),_c('a',{attrs:{\"href\":\"https://policies.google.com/privacy\"}},[_vm._v(\"Privacy Policy\")]),_vm._v(\" and \"),_c('a',{attrs:{\"href\":\"https://policies.google.com/terms\"}},[_vm._v(\"Terms of Service\")]),_vm._v(\" apply. \")])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"mask\"\r\n    v-on:click.stop=\"\"\r\n  >\r\n    <div\r\n      class=\"publishDialog\"\r\n    >\r\n      <div class=\"title\">Publish Board</div>\r\n      <div class=\"form\">\r\n        <div class=\"row\">\r\n          <div class=\"label\">Title:</div>\r\n          <input ref=\"title\" type=\"text\" v-model=\"title\" v-bind:maxlength=\"maxTitleLength\">\r\n        </div>\r\n        <div class=\"row\">\r\n          <div class=\"label\">Author:</div>\r\n          <input type=\"text\" v-model=\"author\" v-bind:maxlength=\"maxAuthorLength\">\r\n        </div>\r\n      </div>\r\n      <div class=\"recaptchaMessage\">\r\n        This site is protected by reCAPTCHA and the Google\r\n        <a href=\"https://policies.google.com/privacy\">Privacy Policy</a> and\r\n        <a href=\"https://policies.google.com/terms\">Terms of Service</a> apply.\r\n      </div>\r\n      <div class=\"footer\">\r\n        <div class=\"btn\" v-on:click=\"cancel\">Cancel</div>\r\n        <div class=\"btn accept\" v-on:click=\"accept\">Accept</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport {MAX_SCENE_TITLE_LENGTH, MAX_SCENE_AUTHOR_LENGTH} from '@/defines'\r\n\r\nexport default {\r\n  name: 'PublishDialog',\r\n  data: function() {\r\n    return {\r\n      title: 'New Board',\r\n      author: 'New Author',\r\n      maxTitleLength: MAX_SCENE_TITLE_LENGTH,\r\n      maxAuthorLength: MAX_SCENE_AUTHOR_LENGTH,\r\n    }\r\n  },\r\n  methods: {\r\n    open: function() {\r\n      const self = this\r\n\r\n      Vue.nextTick(function() {\r\n        self.$refs.title.focus()\r\n        self.$refs.title.select()\r\n      })\r\n    },\r\n    cancel: function() {\r\n      this.$emit('close', null, null)\r\n    },\r\n    accept() {\r\n      const self = this\r\n\r\n      this.$recaptcha('publish_scene').then(function(token) {\r\n        self.$emit('close', self.title, self.author, token)\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.mask {\r\n  z-index: 2;\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .publishDialog {\r\n    width: 500px;\r\n    height: 250px;\r\n    background: #444444;\r\n    border: 1px solid #2B2B2B;\r\n    padding: 10px 40px;\r\n\r\n    .title {\r\n      font-size: 24px;\r\n      color: white;\r\n      padding: 5px;\r\n      border-bottom: 1px solid #383838;\r\n    }\r\n\r\n    .form {\r\n      display: flex;\r\n      flex-direction: column;\r\n      margin-top: 10px;\r\n      font-size: 16px;\r\n      color: #DCDCDC;\r\n\r\n      .row {\r\n        display: flex;\r\n        justify-content: flex-start;\r\n        align-items: center;\r\n        margin-top: 20px;\r\n\r\n        .label {\r\n          text-align: right;\r\n          width: 60px;\r\n          margin-right: 15px;\r\n        }\r\n\r\n        input {\r\n          background: #646464;\r\n          border: 1px solid #4A4A4A;\r\n          padding-left: 5px;\r\n          height: 20px;\r\n          width: 100%;\r\n          font-size: 16px;\r\n          color: white;\r\n        }\r\n      }\r\n    }\r\n\r\n    .recaptchaMessage {\r\n      margin-top: 20px;\r\n      color: #DCDCDC;\r\n      font-size: 12px;\r\n      text-align: left;\r\n\r\n      a {\r\n        color: black;\r\n      }\r\n    }\r\n\r\n    .footer {\r\n      display: flex;\r\n      align-items: center;\r\n      margin-top: 20px;\r\n      width: 100%;\r\n      height: 40px;\r\n      border-top: 1px solid #383838;\r\n      padding: 5px;\r\n\r\n      .btn {\r\n        font-size: 16px;\r\n        color: #D0D0D0;\r\n        cursor: pointer;\r\n\r\n        &.accept {\r\n          margin-left: auto;\r\n        }\r\n\r\n        &:hover {\r\n          color: white;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./publish_dialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./publish_dialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./publish_dialog.vue?vue&type=template&id=1ab381ab&\"\nimport script from \"./publish_dialog.vue?vue&type=script&lang=js&\"\nexport * from \"./publish_dialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./publish_dialog.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mask\",on:{\"click\":function($event){$event.stopPropagation();}}},[_c('div',{staticClass:\"helpDialog\"},[_c('div',{staticClass:\"closeButton\",on:{\"click\":_vm.close}},[_vm._v(\"\")]),_c('div',{staticClass:\"step\"},[(_vm.activeStep === 1)?_c('div',{staticClass:\"step1\"},[_c('img',{staticClass:\"animation\",attrs:{\"src\":require(\"@/assets/viewer.gif\")}}),_c('div',{staticClass:\"title\"},[_vm._v(\"Domino Party\")]),_c('div',{staticClass:\"description\"},[_vm._v(\"Use the tools in the editor to populate your one square meter board with domino tiles and balls, make it as good as you can and share it with the world!\")])]):(_vm.activeStep === 2)?_c('div',{staticClass:\"step2\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"Interface\")]),_vm._m(0)]):_vm._e()]),_c('div',{staticClass:\"controls\"},[_c('div',{staticClass:\"leftArrow\",on:{\"click\":function($event){return _vm.incStep(-1)}}}),_vm._l((_vm.numSteps),function(i){return _c('div',{key:i,staticClass:\"step\",class:{active: _vm.activeStep === i},on:{\"click\":function($event){return _vm.setStep(i)}}})}),_c('div',{staticClass:\"rightArrow\",on:{\"click\":function($event){return _vm.incStep(1)}}})],2),_c('div',{staticClass:\"checkboxContainer\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.showDialogAtStartup),expression:\"showDialogAtStartup\"}],staticClass:\"checkboxInput\",attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.showDialogAtStartup)?_vm._i(_vm.showDialogAtStartup,null)>-1:(_vm.showDialogAtStartup)},on:{\"change\":[function($event){var $$a=_vm.showDialogAtStartup,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.showDialogAtStartup=$$a.concat([$$v]))}else{$$i>-1&&(_vm.showDialogAtStartup=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.showDialogAtStartup=$$c}},_vm.updateShowDialogAtStartup]}}),_c('div',[_vm._v(\"Show this Welcome Screen at startup\")])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_c('div',[_vm._v(\"CAMERA\")]),_c('ul',[_c('li',[_vm._v(\"Mouse right button: Pan.\")]),_c('li',[_vm._v(\"Mouse middle button: Zoom.\")]),_c('li',[_vm._v(\"Ctrl + mouse right button: Rotate.\")])]),_c('div',[_vm._v(\"STAMPER MODE\")]),_c('ul',[_c('li',[_vm._v(\"Single, Ball, Image: Left click on the board to put the element in the selected position.\")]),_c('li',[_vm._v(\"Free, Line, Rectangle, Triangle: Left click on the board to select the starting position. Move the mouse and click again to select the ending position. \")]),_c('li',[_vm._v(\"Right click to exit the stamper mode.\")])]),_c('div',[_vm._v(\"SELECTION\")]),_c('ul',[_c('li',[_vm._v(\"Elements can't be selected in stamper mode.\")]),_c('li',[_vm._v(\"Left click on an element (tile or ball) to select it.\")]),_c('li',[_vm._v(\"Ctrl + left click on an element to add it to the current selection.\")]),_c('li',[_vm._v(\"Shift + left click on an element to select its parent.\")]),_c('li',[_vm._v(\"Left button down and drag mouse = multi selection.\")]),_c('li',[_vm._v(\"Selected elements will be show with a fading color animation.\")])]),_c('div',[_vm._v(\"BOARD INSPECTOR\")]),_c('ul',[_c('li',[_vm._v(\"Left click to select.\")]),_c('li',[_vm._v(\"Ctrl + left click to add element to selection.\")]),_c('li',[_vm._v(\"Shift + left click to selection by range.\")]),_c('li',[_vm._v(\"Click the eye icon to hide/display the element.\")]),_c('li',[_vm._v(\"Click the snowflake icon to frozen/unfrozen the element. This means it can be moved/rotated.\")])])])}]\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"mask\"\r\n    v-on:click.stop=\"\"\r\n  >\r\n    <div\r\n      class=\"helpDialog\"\r\n    >\r\n      <div class=\"closeButton\" v-on:click=\"close\">&#128473;</div>\r\n      <div class=\"step\">\r\n        <div v-if=\"activeStep === 1\" class=\"step1\">\r\n          <img class=\"animation\" src=\"@/assets/viewer.gif\">\r\n          <div class=\"title\">Domino Party</div>\r\n          <div class=\"description\">Use the tools in the editor to populate your one square meter board with domino tiles and balls, make it as good as you can and share it with the world!</div>\r\n        </div>\r\n        <div v-else-if=\"activeStep === 2\" class=\"step2\">\r\n          <div class=\"title\">Interface</div>\r\n          <div class=\"content\">\r\n            <div>CAMERA</div>\r\n            <ul>\r\n              <li>Mouse right button: Pan.</li>\r\n              <li>Mouse middle button: Zoom.</li>\r\n              <li>Ctrl + mouse right button: Rotate.</li>\r\n            </ul>\r\n            <div>STAMPER MODE</div>\r\n            <ul>\r\n              <li>Single, Ball, Image: Left click on the board to put the element in the selected position.</li>\r\n              <li>Free, Line, Rectangle, Triangle: Left click on the board to select the starting position. Move the mouse and click again to select the ending position.\r\n              <li>Right click to exit the stamper mode.</li>\r\n            </ul>\r\n            <div>SELECTION</div>\r\n            <ul>\r\n              <li>Elements can't be selected in stamper mode.</li>\r\n              <li>Left click on an element (tile or ball) to select it.</li>\r\n              <li>Ctrl + left click on an element to add it to the current selection.</li>\r\n              <li>Shift + left click on an element to select its parent.</li>\r\n              <li>Left button down and drag mouse = multi selection.</li>\r\n              <li>Selected elements will be show with a fading color animation.</li>\r\n            </ul>\r\n            <div>BOARD INSPECTOR</div>\r\n            <ul>\r\n              <li>Left click to select.</li>\r\n              <li>Ctrl + left click to add element to selection.</li>\r\n              <li>Shift + left click to selection by range.</li>\r\n              <li>Click the eye icon to hide/display the element.</li>\r\n              <li>Click the snowflake icon to frozen/unfrozen the element. This means it can be moved/rotated.</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"controls\">\r\n        <div class=\"leftArrow\" v-on:click=\"incStep(-1)\"/>\r\n        <div v-for=\"i in numSteps\" v-bind:key=\"i\" class=\"step\" v-bind:class=\"{active: activeStep === i}\" v-on:click=\"setStep(i)\"/>\r\n        <div class=\"rightArrow\" v-on:click=\"incStep(1)\"/>\r\n      </div>\r\n      <div class=\"checkboxContainer\">\r\n        <input type=\"checkbox\" v-model=\"showDialogAtStartup\" v-on:change=\"updateShowDialogAtStartup\" class=\"checkboxInput\"/>\r\n        <div>Show this Welcome Screen at startup</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n  name: 'HelpDialog',\r\n  data: function() {\r\n    return {\r\n      activeStep: 2,\r\n      numSteps: 2,\r\n      showDialogAtStartup: false,\r\n    }\r\n  },\r\n  methods: {\r\n    open: function() {\r\n      this.activeStep = 1\r\n      const showDialog = window.localStorage.getItem('showDialogAtStartup')\r\n\r\n      if (!showDialog  || showDialog === 'true') {\r\n        this.showDialogAtStartup = true\r\n      }\r\n    },\r\n    close: function() {\r\n      this.$emit('close')\r\n    },\r\n    updateShowDialogAtStartup: function(event) {\r\n      this.showDialogAtStartup = event.target.checked\r\n      window.localStorage.setItem('showDialogAtStartup', this.showDialogAtStartup)\r\n    },\r\n    incStep: function(inc) {\r\n      this.setStep(this.activeStep + inc)\r\n    },\r\n    setStep: function(step) {\r\n      this.activeStep = step\r\n\r\n      if (this.activeStep > this.numSteps) {\r\n        this.activeStep = 1\r\n      } else if (this.activeStep < 1) {\r\n        this.activeStep = this.numSteps\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.mask {\r\n  z-index: 2;\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .helpDialog {\r\n    width: 940px;\r\n    background: #444444;\r\n    border: 1px solid #2B2B2B;\r\n    display: flex;\r\n    flex-direction: column;\r\n\r\n    .closeButton {\r\n      background: #646464;\r\n      border: 1px solid #3E3E3E;\r\n      color: #CACACA;\r\n      width: 20px;\r\n      height: 18px;\r\n      padding-bottom: 3px;\r\n      border-radius: 4px;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      cursor: pointer;\r\n      margin: 8px 8px 0px auto;\r\n\r\n      &:hover {\r\n        background: #3E3E3E;\r\n      }\r\n    }\r\n\r\n    .checkboxContainer {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: flex-start;\r\n      font-size: 12px;\r\n      color: white;\r\n      margin: 10px;\r\n\r\n      .checkboxInput {\r\n        appearance: none;\r\n        background: #646464;\r\n        border: 1px solid #4A4A4A;\r\n        width: 12px;\r\n        height: 12px;\r\n        cursor: pointer;\r\n        outline: none;\r\n        margin-right: 5px;\r\n\r\n        &:hover {\r\n          border: 1px solid #555555;\r\n          background: #383838;\r\n        }\r\n\r\n        &:checked {\r\n          background: #646464;\r\n\r\n          &:hover {\r\n            border: 1px solid #555555;\r\n            background: #383838;\r\n          }\r\n\r\n          &:after {\r\n            content: '\\2714';\r\n            font-size: 8px;\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            color: #DCDCDC;\r\n          }\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    .step {\r\n      height: 470px;\r\n      padding: 10px 40px;\r\n\r\n      .title {\r\n        color: #45B1B1;\r\n        font-size: 32px;\r\n      }\r\n\r\n      .content {\r\n        margin-top: 10px;\r\n        color: #B9B9B9;\r\n        text-align: left;\r\n        max-height: 430px;\r\n        overflow: auto;\r\n      }\r\n    }\r\n\r\n    .step1 {\r\n      position: relative;\r\n      height: 100%;\r\n\r\n      .title {\r\n        position: absolute;\r\n        bottom: 80px;\r\n        left: 50px;\r\n        color: white;\r\n        font-size: 38px;\r\n        text-transform: uppercase;\r\n        letter-spacing: 4px;\r\n        background: rgba(0, 0, 0, 0.5);\r\n      }\r\n\r\n      .description {\r\n        position: absolute;\r\n        bottom: 26px;\r\n        left: 50px;\r\n        font-size: 22px;\r\n        color: #B9B9B9;\r\n        text-align: left;\r\n        background: rgba(0, 0, 0, 0.5);\r\n      }\r\n\r\n      .animation {\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        object-fit: contain;\r\n      }\r\n    }\r\n\r\n    .controls {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      margin-top: 10px;\r\n\r\n      div {\r\n        width: 18px;\r\n        height: 18px;\r\n        cursor: pointer;\r\n        background: #6E6E6E;\r\n        padding: 0;\r\n      }\r\n\r\n      .leftArrow {\r\n        margin-right: 8px;\r\n        width: 0;\r\n        height: 0;\r\n        border-style: solid;\r\n        border-width: 9px 15.6px 9px 0;\r\n        background: transparent;\r\n        border-color: transparent #6E6E6E transparent transparent;\r\n\r\n        &:hover {\r\n          border-color: transparent #D0D0D0 transparent transparent;\r\n        }\r\n      }\r\n\r\n      .rightArrow {\r\n        margin-left: 8px;\r\n        width: 0;\r\n        height: 0;\r\n        border-style: solid;\r\n        border-width: 9px 0 9px 15.6px;\r\n        background: transparent;\r\n        border-color: transparent transparent transparent #6E6E6E;\r\n\r\n        &:hover {\r\n          border-color: transparent transparent transparent #D0D0D0;\r\n        }\r\n      }\r\n\r\n      .step {\r\n        border-radius: 50%;\r\n        margin: 0 2.5px;\r\n\r\n        &:hover {\r\n          &:not(.active) {\r\n            background: #D0D0D0;\r\n          }\r\n        }\r\n\r\n        &.active {\r\n          background: #47C0C0;\r\n          cursor: default;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./help_dialog.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./help_dialog.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./help_dialog.vue?vue&type=template&id=b6342484&\"\nimport script from \"./help_dialog.vue?vue&type=script&lang=js&\"\nexport * from \"./help_dialog.vue?vue&type=script&lang=js&\"\nimport style0 from \"./help_dialog.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"editor\">\r\n    <div class=\"toolbar\" v-show=\"state !== 'validating'\">\r\n      <div class=\"controlsSection\">\r\n        <div\r\n          class=\"toolbarButton\"\r\n          title=\"Undo (Ctrl + Z)\"\r\n          v-bind:class=\"{disabled: state !== 'idle' || actionsQueue.idx === 0}\"\r\n          v-on:click=\"undoAction\"\r\n        >\r\n          <i class=\"fas fa-arrow-left\"></i>\r\n        </div>\r\n        <div\r\n          class=\"toolbarButton\"\r\n          title=\"Redo (Ctrl + Y)\"\r\n          v-bind:class=\"{disabled: state !== 'idle' || (actionsQueue.idx >= actionsQueue.queue.length)}\"\r\n          v-on:click=\"redoAction\"\r\n        >\r\n          <i class=\"fas fa-arrow-right\"></i>\r\n        </div>\r\n      </div>\r\n      <div class=\"controlsSection\">\r\n        <div\r\n          class=\"toolbarButton\"\r\n          v-bind:class=\"{active: activeTransform === 'select', disabled: state !== 'idle'}\"\r\n          v-on:click=\"selectTransform('select')\"\r\n          title=\"Select (Q)\"\r\n        >\r\n          <i class=\"fas fa-mouse-pointer\"></i>\r\n        </div>\r\n        <div\r\n          class=\"toolbarButton\"\r\n          v-on:click=\"selectTransform('translate')\"\r\n          v-bind:class=\"{active: activeTransform === 'translate', disabled: state !== 'idle'}\"\r\n          title=\"Select and Move (W)\"\r\n        >\r\n          <i class=\"fas fa-arrows-alt\"></i>\r\n        </div>\r\n        <div\r\n          class=\"toolbarButton\"\r\n          v-on:click=\"selectTransform('rotate')\"\r\n          v-bind:class=\"{active: activeTransform === 'rotate', disabled: state !== 'idle'}\"\r\n          title=\"Select and Rotate (E)\"\r\n        >\r\n          <i class=\"fas fa-undo\"></i>\r\n        </div>\r\n        <div\r\n          class=\"toolbarButton\"\r\n          v-on:click=\"removeSelectedEntities\"\r\n          v-bind:class=\"{disabled: state !== 'idle' || selectedEntities.length === 0}\"\r\n          title=\"Delete Selected (Supr)\"\r\n        >\r\n          <i class=\"far fa-trash-alt\"></i>\r\n        </div>\r\n      </div>\r\n      <div class=\"controlsSection\">\r\n        <div\r\n          class=\"toolbarButton\"\r\n          v-bind:class=\"{\r\n            invisible: state === 'playingFromSelection' || (state === 'paused' && stateBeforePause === 'playingFromSelection'),\r\n            hidden: state === 'playing' || (state === 'paused' && stateBeforePause !== 'playingFromSelection')\r\n          }\"\r\n          v-on:click=\"play(false)\"\r\n          title=\"Play (Space)\"\r\n        >\r\n          <i class=\"fas fa-play\"></i>\r\n        </div>\r\n        <div\r\n          v-if=\"state !== 'idle'\"\r\n          class=\"toolbarButton\"\r\n          v-on:click=\"stop\"\r\n          title=\"Stop (Space)\"\r\n        >\r\n          <i class=\"fas fa-stop\"></i>\r\n        </div>\r\n        <div\r\n          v-if=\"state === 'idle' && selectedEntities.length === 1 && selectedEntities[0].type === 'tile'\"\r\n          class=\"toolbarButton\"\r\n          v-on:click=\"play(true)\"\r\n          title=\"Play from Selection (Ctrl + Space)\"\r\n        >\r\n          <i class=\"far fa-play-circle\"></i>\r\n        </div>\r\n        <div\r\n          v-show=\"state !== 'idle'\"\r\n          class=\"toolbarButton\"\r\n          v-on:click=\"togglePause\"\r\n          title=\"Pause\"\r\n          v-bind:class=\"{active: state === 'paused'}\"\r\n        >\r\n          <i class=\"fas fa-pause\"></i>\r\n        </div>\r\n        <div\r\n          v-show=\"state === 'paused'\"\r\n          class=\"toolbarButton\"\r\n          v-on:click=\"stepForward\"\r\n          title=\"Step Forward\"\r\n        >\r\n          <i class=\"fas fa-step-forward\"></i>\r\n        </div>\r\n      </div>\r\n      <div class=\"entitiesStats\">{{numValidEntitiesInTheScene}} of {{maxNumEntitiesInScene}} elements used</div>\r\n      <div class=\"controlsSection\" v-bind:style=\"{'margin-left': 'auto', 'margin-right': '40px'}\">\r\n        <div\r\n          v-if=\"sceneUuid\"\r\n          class=\"sceneUuid\"\r\n        >\r\n          <div\r\n            class=\"toolbarButton\"\r\n            v-on:click=\"copySceneUrlToClipboard\"\r\n            title=\"Copy board URL to the clipboard\"\r\n          >\r\n            <i class=\"fas fa-share-square\"></i>\r\n          </div>\r\n        </div>\r\n        <div\r\n          v-else\r\n          class=\"toolbarButton\"\r\n          v-bind:class=\"{disabled: state !== 'idle' || numValidEntitiesInTheScene > maxNumEntitiesInScene}\"\r\n          v-on:click=\"publishScene\"\r\n          title=\"Publish Board\"\r\n        >\r\n          <i class=\"fas fa-cloud-upload-alt\"></i>\r\n        </div>\r\n        <div\r\n          class=\"toolbarButton\"\r\n          v-bind:class=\"{disabled: state !== 'idle'}\"\r\n          title=\"Help\"\r\n          v-on:click=\"openHelpDialog\"\r\n        >\r\n          <i class=\"fas fa-question\"></i>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"validatingScene\" v-show=\"state === 'validating'\">\r\n      <div class=\"mask\">\r\n        <div class=\"messageArea\">\r\n          <div class=\"message\">Validating board...</div>\r\n          <div class=\"toolbarButton\" v-on:click=\"cancelValidation\">Cancel</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div\r\n      class=\"scene\"\r\n      ref=\"scene\"\r\n      v-bind:class=\"{batchStamperActive: batchStamper.active}\"\r\n      v-on:mousedown=\"onMouseDown\"\r\n      v-on:mouseup=\"onMouseUp\"\r\n      v-on:mousemove=\"onMouseMove\"\r\n    >\r\n      <div class=\"stamperMessage\" v-if=\"batchStamper.active\">Stamper Mode</div>\r\n    </div>\r\n    <div class=\"panel\">\r\n      <CommandPanel\r\n        ref=\"commandPanel\"\r\n        v-bind:batchStamperParameters=\"batchStamper.parameters\"\r\n        v-bind:selectedEntities=\"selectedEntities\"\r\n        v-bind:editingGroup=\"world ? world.group : null\"\r\n        v-on:batch-stamper-on=\"onBatchStamperOn\"\r\n        v-on:batch-stamper-off=\"onBatchStamperOff\"\r\n        v-on:rebuild-batch-stamper=\"rebuildBatchStamper\"\r\n        v-on:rotate-selected-entities=\"rotateSelectedEntities\"\r\n        v-on:move-selected-entities=\"moveSelectedEntities\"\r\n        v-on:colorize-selected-entities=\"colorizeSelectedEntities\"\r\n        v-on:rotate-group-entities=\"rotateGroupEntities\"\r\n        v-on:move-group-entities=\"moveGroupEntities\"\r\n        v-on:colorize-group-entities=\"colorizeGroupEntities\"\r\n        v-on:select-entities=\"onSelectEntities\"\r\n        v-on:deselect-entities=\"onDeselectEntities\"\r\n      />\r\n    </div>\r\n    <IODialog\r\n      v-show=\"dialogVisible === 'ioDialog'\"\r\n      ref=\"ioDialog\"\r\n      v-on:close=\"dialogVisible = null\"\r\n    />\r\n    <PublishDialog\r\n      v-show=\"dialogVisible === 'publishDialog'\"\r\n      ref=\"publishDialog\"\r\n      v-on:close=\"closePublishDialog\"\r\n    />\r\n    <HelpDialog\r\n      v-show=\"dialogVisible === 'helpDialog'\"\r\n      ref=\"helpDialog\"\r\n      v-on:close=\"dialogVisible = null\"\r\n    />\r\n    <div\r\n      v-if=\"selectionBox\"\r\n      ref=\"selectionBox\"\r\n      class=\"selectionBox\"\r\n      v-bind:style=\"{top: selectionBox.top + 'px', left: selectionBox.left + 'px', width: selectionBox.width + 'px', height: selectionBox.height + 'px'}\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport _ from 'lodash'\r\nimport * as THREE from 'three'\r\nimport Ammo from 'ammo.js'\r\nimport {OrbitControls} from 'three/examples/jsm/controls/OrbitControls'\r\nimport {TransformControls} from 'three/examples/jsm/controls/TransformControls.js'\r\nimport {TILE_Y_POSITION, MAX_SCENE_TITLE_LENGTH, MAX_SCENE_AUTHOR_LENGTH, NUM_MAX_ENTITIES_IN_EDITOR, INITIAL_IMPULSE_VALUE, SCENE_INITIAL_TILE_IDX, SCENE_LAST_TILE_IDX} from '@/defines'\r\nimport {AddEntities, RemoveEntities, MoveEntities, RotateEntities, SelectEntities, DeselectEntities, CombinedActions, ColorizeEntities} from './actions'\r\nimport World from '@/world/world'\r\nimport {Ground, Tile, Group} from '@/world/entities'\r\nimport BatchStamper from './batch_stamper'\r\nimport Shortcuts from './shortcuts'\r\nimport CommandPanel from './command_panel'\r\nimport IODialog from './io_dialog'\r\nimport PublishDialog from './publish_dialog'\r\nimport HelpDialog from './help_dialog'\r\n\r\nconst CLICK_TIME = 300\r\nconst MAX_NUM_ENTITIES = 1500\r\nconst COLOR_FADING_TIME = 0.5\r\nconst CAMERA_POSITION = {x: -90, y: 80, z: 0}\r\n\r\nexport default {\r\n  name: 'Editor',\r\n  components: {\r\n    CommandPanel,\r\n    IODialog,\r\n    PublishDialog,\r\n    HelpDialog\r\n  },\r\n  data: function() {\r\n    return {\r\n      maxNumEntitiesInScene: MAX_NUM_ENTITIES,\r\n      batchStamper: new BatchStamper(),\r\n      selectedEntities: [],\r\n      activeTransform: 'select',\r\n      state: 'idle',\r\n      stateBeforePause: null,\r\n      actionsQueue: {\r\n        queue: [],\r\n        idx: 0\r\n      },\r\n      dialogVisible: null,\r\n      dialogEntities: null,\r\n      sceneUuid: null,\r\n      world: null,\r\n      batchId: 0,\r\n      selectionBox: null\r\n    }\r\n  },\r\n  computed: {\r\n    numValidEntitiesInTheScene: function() {\r\n      return this.world ? this.getNumValidEntitiesInGroup(this.world.group) : 0\r\n    }\r\n  },\r\n  mounted: function() {\r\n    this.world = new World({\r\n      domElement: this.$refs.scene,\r\n      cameraPosition: {x: -90, y: 80, z: 0},\r\n      numTiles: NUM_MAX_ENTITIES_IN_EDITOR,\r\n      numBalls: NUM_MAX_ENTITIES_IN_EDITOR,\r\n      numGrounds: 1\r\n    })\r\n\r\n    this.orbitControl = new OrbitControls(this.world.camera, this.world.renderer.domElement)\r\n    this.orbitControl.mouseButtons.LEFT = -1\r\n    this.orbitControl.maxDistance = 200\r\n\r\n    this.transformControlEnabled = false\r\n    this.transformControl = new TransformControls(this.world.camera, this.world.renderer.domElement)\r\n    this.selectTransform(this.activeTransform)\r\n\r\n    this.colorFadingTimer = COLOR_FADING_TIME / 2\r\n\r\n    this.raycaster = new THREE.Raycaster()\r\n    this.world.scene.add(this.transformControl)\r\n    this.batchStamper.init(this)\r\n\r\n    // create ground, initial and last tiles\r\n    this.ground = new Ground({\r\n      name: 'Ground',\r\n      iMesh: this.world.imGrounds,\r\n      color: 0x444444\r\n    })\r\n    this.executeAction(AddEntities, {group: this.world.group, entities: [this.ground]}, true)\r\n\r\n    let tiles = []\r\n\r\n    for (const z of [-50, 50]) {\r\n      tiles.push(new Tile({\r\n        name: 'Tile',\r\n        position: new THREE.Vector3(0, TILE_Y_POSITION, z),\r\n        iMesh: this.world.imTiles,\r\n        userData: {isFixed: true},\r\n        color: 0x02ACA5\r\n      }))\r\n    }\r\n\r\n    this.executeAction(AddEntities, {group: this.world.group, entities: tiles}, true)\r\n\r\n    // dummy object used in the gizmo\r\n    this.initialDummyPosition = new THREE.Vector3()\r\n    this.prevDummyPosition = new THREE.Vector3()\r\n\r\n    this.dummyObject = new THREE.Object3D()\r\n    this.world.scene.add(this.dummyObject)\r\n\r\n    this.animFrameId = window.requestAnimationFrame(this.tick)\r\n    this.start = Date.now()\r\n\r\n    this.shortcuts = new Shortcuts(this)\r\n    this.manageTransformControlEvents()\r\n\r\n    const showHelpDialog = window.localStorage.getItem('showDialogAtStartup')\r\n    if (!showHelpDialog  || showHelpDialog === 'true') {\r\n      this.openHelpDialog()\r\n    }\r\n\r\n    const self = this\r\n    window.addEventListener('resize', function() {\r\n      self.world.onWindowResize()\r\n    }, false)\r\n  },\r\n  destroyed: function() {\r\n    this.shortcuts.onDestroyed()\r\n\r\n    if (this.animFrameId) {\r\n      window.cancelAnimationFrame(this.animFrameId)\r\n    }\r\n  },\r\n  methods: {\r\n    manageTransformControlEvents: function() {\r\n      const self = this\r\n\r\n      this.transformControl.addEventListener('dragging-changed', function(event) {\r\n        if (self.batchStamper.active) {\r\n          return\r\n        }\r\n\r\n        self.orbitControl.enabled = !event.value\r\n        self.transformControlEnabled = event.value\r\n\r\n        if (event.value) {\r\n          if (event.target.mode === 'translate' && self.shortcuts.isKeyPressed('Shift')) {\r\n            // duplicate selected entities\r\n            let newEntitiesByGroup = {}\r\n            let groupById = {}\r\n            let newEntities = []\r\n\r\n            for (const entity of self.selectedEntities) {\r\n              if (entity.userData.isFixed || entity.frozen) {\r\n                continue\r\n              }\r\n\r\n              if ((entity.type === 'tile') || (entity.type === 'group')) {\r\n                const newEntity = entity.clone()\r\n\r\n                if (!(entity.parent.id in newEntitiesByGroup)) {\r\n                  newEntitiesByGroup[entity.parent.id] = []\r\n                  groupById[entity.parent.id] = entity.parent\r\n                }\r\n\r\n                newEntitiesByGroup[entity.parent.id].push(newEntity)\r\n                newEntities.push(newEntity)\r\n              }\r\n            }\r\n\r\n            let actions = []\r\n\r\n            for (const k in newEntitiesByGroup) {\r\n              actions.push(new AddEntities({group: groupById[k], entities: newEntitiesByGroup[k]}, self))\r\n            }\r\n\r\n            actions.push(new SelectEntities({entities: newEntities}, self))\r\n            self.executeAction(CombinedActions, {actions: actions})\r\n          }\r\n\r\n          self.initialDummyPosition.copy(self.dummyObject.position)\r\n          self.prevDummyPosition.copy(self.initialDummyPosition)\r\n          self.prevDummyRotation = 0\r\n          self.accumRotation = 0\r\n\r\n          self.initialTransformValues = []\r\n\r\n          for (const entity of self.selectedEntities) {\r\n            self.initialTransformValues.push({\r\n              position: entity.position.clone(),\r\n              rotation: entity.angleY\r\n            })\r\n          }\r\n        }\r\n      })\r\n\r\n      this.transformControl.addEventListener('objectChange', function(event) {\r\n        if (self.batchStamper.active) {\r\n          return\r\n        }\r\n\r\n        switch(event.target.mode) {\r\n          case 'translate': {\r\n            event.target.object.position.y = self.prevDummyPosition.y // remove vertical movement\r\n            let offset = event.target.object.position.clone()\r\n            offset.sub(self.prevDummyPosition)\r\n\r\n            for (const entity of self.selectedEntities) {\r\n              if (entity.frozen) {\r\n                offset.x = 0\r\n                offset.z = 0\r\n              } else if (entity.userData.isFixed) {\r\n                offset.z = 0\r\n              }\r\n\r\n              entity.move(offset.x, offset.y, offset.z)\r\n            }\r\n\r\n            self.prevDummyPosition.copy(event.target.object.position)\r\n          }\r\n          break\r\n\r\n          case 'rotate': {\r\n            let offset = event.target.rotationAngle - self.prevDummyRotation\r\n\r\n            for (const entity of self.selectedEntities) {\r\n              if (!entity.userData.isFixed && !entity.frozen) {\r\n                entity.rotate(offset)\r\n              }\r\n            }\r\n\r\n            self.prevDummyRotation = event.target.rotationAngle\r\n            self.accumRotation += offset\r\n          }\r\n          break\r\n        }\r\n\r\n        self.$refs.commandPanel.refresh()\r\n      })\r\n\r\n      this.transformControl.addEventListener('mouseUp', function(event) {\r\n        if (self.batchStamper.active) {\r\n          return\r\n        }\r\n\r\n        switch(event.target.mode) {\r\n          case 'translate': {\r\n            let offset = self.dummyObject.position.clone()\r\n            offset.sub(self.initialDummyPosition)\r\n            offset.y = 0\r\n\r\n            if (offset.lengthSq() > 0) {\r\n              let fixedEntities = []\r\n              let freeEntities = []\r\n\r\n              for (let i = 0; i < self.selectedEntities.length; ++i) {\r\n                // restore entities position to apply the move action\r\n                const entity = self.selectedEntities[i]\r\n                let position = self.initialTransformValues[i].position\r\n                entity.setPosition(position.x, position.y, position.z)\r\n\r\n                if (entity.frozen) {\r\n                  continue\r\n                }\r\n\r\n                if (entity.userData.isFixed) {\r\n                  if (offset.x !== 0) {\r\n                    fixedEntities.push(entity)\r\n                  }\r\n                } else {\r\n                  freeEntities.push(entity)\r\n                }\r\n              }\r\n\r\n              // if all entities can move based on the offset we create only one action. If not (for instance, fixed tiles only can be moved on axis X) we create specific actions for them\r\n              if (freeEntities.length === self.selectedEntities.length) {\r\n                self.executeAction(MoveEntities, {offset: offset, entities: freeEntities})\r\n              } else {\r\n                let fixedOffset = offset.clone()\r\n                fixedOffset.z = 0\r\n\r\n                if (fixedEntities.length === self.selectedEntities.length) {\r\n                  self.executeAction(MoveEntities, {offset: fixedOffset, entities: fixedEntities})\r\n                } else {\r\n                  let actions = []\r\n\r\n                  if (freeEntities.length > 0) {\r\n                    actions.push(new MoveEntities({offset: offset, entities: freeEntities}, this))\r\n                  }\r\n\r\n                  if (fixedEntities.length > 0) {\r\n                    actions.push(new MoveEntities({offset: fixedOffset, entities: fixedEntities}, this))\r\n                  }\r\n\r\n                  if (actions.length > 0) {\r\n                    self.executeAction(CombinedActions, {actions: actions})\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n          break\r\n\r\n          case 'rotate': {\r\n            let offset = self.accumRotation\r\n\r\n            if (offset !== 0) {\r\n              let freeEntities = []\r\n\r\n              for (let i = 0; i < self.selectedEntities.length; ++i) {\r\n                const entity = self.selectedEntities[i]\r\n\r\n                if (!entity.userData.isFixed && !entity.frozen) {\r\n                  // restore entities rotation to apply the rotate action\r\n                  entity.rotate(self.initialTransformValues[i].rotation - entity.angleY)\r\n                  freeEntities.push(entity)\r\n                }\r\n              }\r\n\r\n              self.executeAction(RotateEntities, {offset: offset, entities: freeEntities})\r\n            }\r\n          }\r\n          break\r\n        }\r\n      })\r\n    },\r\n    tick: function() {\r\n      const current = Date.now()\r\n      const delta = ((current - this.start) / 1000)\r\n\r\n      this.start = current\r\n\r\n      if (this.state !== 'idle' && this.state !== 'paused') {\r\n        this.world.tick(delta)\r\n      }\r\n\r\n      if ((this.state === 'idle') && this.selectEntities.length > 0) {\r\n        this.colorFadingTimer = (this.colorFadingTimer + delta) % (COLOR_FADING_TIME + COLOR_FADING_TIME)\r\n        const d = Math.abs(this.colorFadingTimer - COLOR_FADING_TIME)\r\n\r\n        for (const e of this.selectedEntities) {\r\n          if (e.type !== 'group') {\r\n            e.setFadingIntensity(d)\r\n          }\r\n        }\r\n      }\r\n\r\n      if (this.state === 'validating') {\r\n        this.checkSceneValidation()\r\n      }\r\n\r\n      this.batchStamper.render()\r\n      this.world.render()\r\n\r\n      this.animFrameId = window.requestAnimationFrame(this.tick)\r\n    },\r\n    adjustDummyToSelectedEntities: function() {\r\n      if ((this.selectedEntities.length > 0) && (this.transformControl.object)) {\r\n        let x = 0\r\n        let z = 0\r\n\r\n        for (const entity of this.selectedEntities) {\r\n          const entityWorldPosition = entity.getWorldPosition()\r\n          x += entityWorldPosition.x\r\n          z += entityWorldPosition.z\r\n        }\r\n\r\n        const entitiesLength = this.selectedEntities.length\r\n        this.dummyObject.position.set(x / entitiesLength, 0, z / entitiesLength)\r\n      }\r\n    },\r\n    selectEntities: function(entities, adding) {\r\n      for (let entity of this.selectedEntities) {\r\n        if (entity.type !== 'group') {\r\n          entity.setFadingIntensity(0)\r\n        }\r\n      }\r\n\r\n      if (adding) {\r\n        this.selectedEntities = this.selectedEntities.concat(entities)\r\n      } else {\r\n        this.selectedEntities = _.clone(entities)\r\n      }\r\n\r\n      this.$refs.commandPanel.setEntities(this.selectedEntities)\r\n\r\n      if (this.selectedEntities.length > 0) {\r\n        for (let entity of this.selectedEntities) {\r\n          entity.originalColor = entity.color\r\n        }\r\n\r\n        switch(this.activeTransform) {\r\n          case 'translate': {\r\n            let showZ = false\r\n\r\n            for (const entity of this.selectedEntities) {\r\n              if (!entity.userData.isFixed) {\r\n                showZ = true\r\n                break\r\n              }\r\n            }\r\n            this.transformControl.showZ = showZ\r\n          }\r\n          break\r\n\r\n          case 'rotate': {\r\n            let rotateDisabled = true\r\n\r\n            for (const entity of this.selectedEntities) {\r\n              if (!entity.userData.isFixed) {\r\n                rotateDisabled = false\r\n                break\r\n              }\r\n            }\r\n\r\n            this.transformControl.showX = false\r\n            this.transformControl.showY = true\r\n            this.transformControl.showZ = false\r\n            this.transformControl.enabled = !rotateDisabled\r\n          }\r\n          break\r\n        }\r\n\r\n        if (this.selectedEntities.length === 1 && this.selectedEntities[0].type === 'ground') {\r\n          this.transformControl.enabled = false\r\n        }\r\n\r\n        this.transformControl.attach(this.dummyObject)\r\n        this.adjustDummyToSelectedEntities()\r\n      } else {\r\n        this.transformControl.detach()\r\n      }\r\n    },\r\n    deselectEntities: function(entities) {\r\n      const entitiesId = entities.map(e => e.id)\r\n      this.selectEntities(this.selectedEntities.filter(e => entitiesId.indexOf(e.id) === -1))\r\n    },\r\n    onMouseMove: function(event) {\r\n      this.batchStamper.onMouseMove(event)\r\n\r\n      if (this.selectionBox && !this.transformControlEnabled) {\r\n        if (this.selectionBox.leftDirection) {\r\n          this.selectionBox.left = event.clientX\r\n        } else {\r\n          this.selectionBox.right = event.clientX\r\n        }\r\n\r\n        if (this.selectionBox.right < this.selectionBox.left) {\r\n          const aux = this.selectionBox.right\r\n          this.selectionBox.right = this.selectionBox.left\r\n          this.selectionBox.left = aux\r\n          this.selectionBox.leftDirection = !this.selectionBox.leftDirection\r\n        }\r\n\r\n        if (this.selectionBox.topDirection) {\r\n          this.selectionBox.top = event.clientY\r\n        } else {\r\n          this.selectionBox.bottom = event.clientY\r\n        }\r\n\r\n        if (this.selectionBox.bottom < this.selectionBox.top) {\r\n          const aux = this.selectionBox.top\r\n          this.selectionBox.top = this.selectionBox.bottom\r\n          this.selectionBox.bottom = aux\r\n          this.selectionBox.topDirection = !this.selectionBox.topDirection\r\n        }\r\n\r\n        this.selectionBox.width = this.selectionBox.right - this.selectionBox.left\r\n        this.selectionBox.height = this.selectionBox.bottom - this.selectionBox.top\r\n      }\r\n    },\r\n    onMouseDown: function(event) {\r\n      switch(event.which) {\r\n        case 1: // left button\r\n          if (this.state === 'idle') {\r\n            this.clickStart = Date.now()\r\n          }\r\n\r\n          if (!this.batchStamper.active && !this.transformControlEnabled && this.state === 'idle') {\r\n            this.selectionBox = {\r\n              top: event.clientY,\r\n              left: event.clientX,\r\n              width: 0,\r\n              height: 0\r\n            }\r\n          }\r\n          break\r\n\r\n        case 3: // right button\r\n          if (this.batchStamper.active) {\r\n            this.$refs.commandPanel.selectBatchType(null)\r\n          }\r\n          break\r\n      }\r\n    },\r\n    onMouseUp: function(event) {\r\n      if (this.state !== 'idle' || event.which !== 1 || this.ignoreNextMouseUpEvent) {\r\n        return\r\n      }\r\n\r\n      const clickDelta = (Date.now() - this.clickStart) // time between mouse down and mouse up in ms\r\n\r\n      if (clickDelta <= CLICK_TIME) { // if it is bigger it means the user is rotating the camera or using the transform control\r\n        if (this.batchStamper.active) {\r\n          const batchPosition = this.batchStamper.onMouseUp(event)\r\n\r\n          if (batchPosition) {\r\n            this.createBatch(batchPosition.x, batchPosition.z)\r\n            this.batchStamper.reset()\r\n          }\r\n        } else {\r\n          const entity = this.getEntityHit(event.offsetX, event.offsetY)\r\n\r\n          if (entity) {\r\n            if (event.ctrlKey) {\r\n              const isSelected = !!this.selectedEntities.find(e => e.id === entity.id)\r\n\r\n              if (isSelected) {\r\n                this.onDeselectEntities([entity])\r\n              } else {\r\n                this.onSelectEntities([entity], true)\r\n              }\r\n            } else if (event.shiftKey) {\r\n              // select parent. All entities have a parent (at least the scene group), but we only want to select the parents children of the scene group\r\n              if (entity.parent.parent) {\r\n                this.onSelectEntities([entity.parent])\r\n              } else {\r\n                this.onSelectEntities([entity])\r\n              }\r\n            } else {\r\n              this.onSelectEntities([entity])\r\n            }\r\n          } else {\r\n            this.onSelectEntities([])\r\n          }\r\n        }\r\n      } else if (!this.transformControlEnabled && this.selectionBox) {\r\n        let newSelection = this.getBoxedSelectedEntities(this.world.group)\r\n        this.onSelectEntities(newSelection)\r\n      }\r\n\r\n      this.selectionBox = null\r\n    },\r\n    getBoxedSelectedEntities(group) {\r\n      let entities = []\r\n      const sb = this.selectionBox\r\n\r\n      for (const e of group.children) {\r\n        if (e.type === 'group') {\r\n          entities = entities.concat(this.getBoxedSelectedEntities(e))\r\n        } else if (e.type !== 'ground') {\r\n          const position = e.getWorldPosition()\r\n\r\n          position.project(this.world.camera)\r\n          position.x = (position.x + 1) * this.$refs.scene.clientWidth / 2\r\n          position.y = -(position.y - 1) * (this.$refs.scene.clientHeight / 2) + this.$refs.scene.offsetTop\r\n\r\n          if ((position.x >= sb.left) && (position.x <= sb.right) && (position.y >= sb.top) && (position.y <= sb.bottom)) {\r\n            entities.push(e)\r\n          }\r\n        }\r\n      }\r\n\r\n      return entities\r\n    },\r\n    prepareGroupToPlay(group) {\r\n      for (const c of group.children) {\r\n        if (c.type === 'group') {\r\n          this.prepareGroupToPlay(c)\r\n        } else{\r\n          if (this.isEntityValidToBePublished(c)) {\r\n            c.addToPhysicalWorld(this.world)\r\n          } else {\r\n            c.setVisible(false)\r\n            c.hiddenByPlay = true\r\n          }\r\n        }\r\n      }\r\n    },\r\n    restoreGroupToEdit(group) {\r\n      for (const c of group.children) {\r\n        if (c.type === 'group') {\r\n          this.restoreGroupToEdit(c)\r\n        } else{\r\n          if (c.hiddenByPlay) {\r\n            c.setVisible(true)\r\n          }\r\n        }\r\n      }\r\n    },\r\n    play: function(fromSelection) {\r\n      if (this.state !== 'idle') {\r\n        return\r\n      }\r\n\r\n      if (fromSelection && (this.selectedEntities.length !== 1  || this.selectedEntities[0].type !== 'tile')) {\r\n        return\r\n      }\r\n\r\n      const initialTile = fromSelection ? this.selectedEntities[0] : this.world.group.children[SCENE_INITIAL_TILE_IDX]\r\n      this.prePlaySelectedEntities = _.clone(this.selectedEntities)\r\n      this.state = fromSelection ? 'playingFromSelection' : 'playing'\r\n      this.world.group.saveState()\r\n      this.prepareGroupToPlay(this.world.group)\r\n      this.selectEntities([])\r\n\r\n      // calculate the impulse vector from the angle of the tile\r\n      const angle = initialTile.getWorldRotationY()\r\n      const impulseValue = INITIAL_IMPULSE_VALUE\r\n      const impulseX = impulseValue * Math.sin(angle)\r\n      const impulseZ = impulseValue * Math.cos(angle)\r\n\r\n      _.delay(function() {\r\n        initialTile.body.applyImpulse(new Ammo.btVector3(impulseX, 0, impulseZ))\r\n      }, 200)\r\n\r\n      return this.world.group.children[SCENE_LAST_TILE_IDX]\r\n    },\r\n    stop: function() {\r\n      if (this.state === 'idle') {\r\n        return\r\n      }\r\n\r\n      this.world.group.removeFromPhysicalWorld(this.world)\r\n      this.restoreGroupToEdit(this.world.group)\r\n      this.world.group.restoreState()\r\n      this.selectEntities(this.prePlaySelectedEntities)\r\n      this.prePlaySelectedEntities = null\r\n      this.state = 'idle'\r\n    },\r\n    togglePause: function() {\r\n      if (this.state === 'paused') {\r\n        this.state = this.stateBeforePause\r\n      } else {\r\n        this.stateBeforePause = this.state\r\n        this.state = 'paused'\r\n      }\r\n    },\r\n    stepForward: function() {\r\n      this.world.tick(0.016)\r\n    },\r\n    executeAction: function(actionClass, options, noRedo) {\r\n      if (this.state !== 'idle') {\r\n        return\r\n      }\r\n\r\n      var action = new actionClass(options, this)\r\n      action.do()\r\n\r\n      if (!noRedo) {\r\n        // if it's in the middle of the queue, discard from current idx until the end\r\n        if (this.actionsQueue.idx < this.actionsQueue.queue.length) {\r\n          this.actionsQueue.queue.splice(this.actionsQueue.idx, this.actionsQueue.queue.length - this.actionsQueue.idx)\r\n        }\r\n\r\n        this.actionsQueue.queue.push(action)\r\n        Vue.set(this.actionsQueue, 'idx', this.actionsQueue.queue.length)\r\n      }\r\n    },\r\n    undoAction: function() {\r\n      if (this.state !== 'idle') {\r\n        return\r\n      }\r\n\r\n      if (this.actionsQueue.idx > 0) {\r\n        Vue.set(this.actionsQueue, 'idx', this.actionsQueue.idx - 1)\r\n        const action = this.actionsQueue.queue[this.actionsQueue.idx]\r\n\r\n        action.undo()\r\n\r\n        this.adjustDummyToSelectedEntities()\r\n        this.$refs.commandPanel.refresh()\r\n      }\r\n    },\r\n    redoAction: function() {\r\n      if (this.state !== 'idle') {\r\n        return\r\n      }\r\n\r\n      if (this.actionsQueue.idx < this.actionsQueue.queue.length) {\r\n        const action = this.actionsQueue.queue[this.actionsQueue.idx]\r\n\r\n        action.redo()\r\n        this.adjustDummyToSelectedEntities()\r\n\r\n        Vue.set(this.actionsQueue, 'idx', this.actionsQueue.idx + 1)\r\n        this.$refs.commandPanel.refresh()\r\n      }\r\n    },\r\n    onSelectEntities: function(entities, adding) {\r\n      this.executeAction(SelectEntities, {entities: entities, adding: adding})\r\n    },\r\n    onDeselectEntities: function(entities) {\r\n      this.executeAction(DeselectEntities, {entities: entities})\r\n    },\r\n    onBatchStamperOn: function(type) {\r\n      Vue.set(this.batchStamper, 'active', true)\r\n      this.batchStamper.setType(type)\r\n      this.batchStamper.reset()\r\n      this.selectEntities([])\r\n    },\r\n    onBatchStamperOff: function() {\r\n      Vue.set(this.batchStamper, 'active', false)\r\n      this.batchStamper.show(false)\r\n    },\r\n    removeSelectedEntities: function() {\r\n      if (this.state === 'idle' && this.selectedEntities.length > 0) {\r\n        let actions = []\r\n        let groups = {}\r\n\r\n        for (const entity of this.selectedEntities) {\r\n          if (entity.userData.isFixed || entity.frozen) {\r\n            continue\r\n          }\r\n\r\n          let group = this.world.group\r\n\r\n          if (entity.parent) {\r\n            group = entity.parent\r\n          }\r\n\r\n          if (!(group.id in groups)) {\r\n            groups[group.id] = []\r\n          }\r\n\r\n          groups[group.id].push(entity)\r\n        }\r\n\r\n        for (const groupId in groups) {\r\n          if (groups[groupId].length > 0) {\r\n            actions.push(new RemoveEntities({group: groups[groupId][0].parent, entities: groups[groupId]}))\r\n          }\r\n        }\r\n\r\n        this.executeAction(CombinedActions, {actions: actions})\r\n      }\r\n\r\n      new RemoveEntities()\r\n    },\r\n    createBatch: function(x, z) {\r\n      if (this.batchStamper.type === 'image' && !this.batchStamper.parameters.image.data) {\r\n        return\r\n      }\r\n\r\n      let group = null\r\n\r\n      if (this.batchStamper.type !== 'single' && this.batchStamper.type !== 'ball') {\r\n        let groupName = this.batchStamper.type[0].toUpperCase() + this.batchStamper.type.slice(1)\r\n        group = new Group({\r\n          name: `${groupName}_${this.batchId++}`,\r\n          position: new THREE.Vector3(x, 0, z)\r\n        })\r\n      }\r\n\r\n      const newEntities = this.batchStamper.createEntitiesFromStamper(this.world, group)\r\n      this.executeAction(AddEntities, {group: this.world.group, entities: group ? [group] : newEntities})\r\n    },\r\n    selectTransform: function(transform) {\r\n      if (this.state !== 'idle') {\r\n        return\r\n      }\r\n\r\n      this.activeTransform = transform\r\n\r\n      switch(transform) {\r\n        case 'select':\r\n          this.transformControl.setMode('translate')\r\n          this.transformControl.enabled = false\r\n          this.transformControl.showX = false\r\n          this.transformControl.showY = false\r\n          this.transformControl.showZ = false\r\n          break;\r\n\r\n        case 'translate':\r\n          this.transformControl.setMode(transform)\r\n          this.transformControl.enabled = true\r\n          this.transformControl.showX = true\r\n          this.transformControl.showY = false\r\n\r\n          if (this.transformControl.object) {\r\n            this.transformControl.showZ = false\r\n\r\n            for (const entity of this.selectedEntities) {\r\n              if (!entity.userData.isFixed) {\r\n                this.transformControl.showZ = true\r\n                break\r\n              }\r\n            }\r\n          }\r\n          break\r\n\r\n        case 'rotate':\r\n          this.transformControl.setMode(transform)\r\n          this.transformControl.enabled = true\r\n          this.transformControl.showX = false\r\n          this.transformControl.showY = true\r\n          this.transformControl.showZ = false\r\n\r\n          if (this.transformControl.object) {\r\n            this.transformControl.enabled = false\r\n\r\n            for (const entity of this.selectedEntities) {\r\n              if (!entity.userData.isFixed && entity.type !== 'ball' ) {\r\n                this.transformControl.enabled = true\r\n                break\r\n              }\r\n            }\r\n          }\r\n          break\r\n      }\r\n\r\n      if (this.selectedEntities.length === 1 && this.selectedEntities[0].type === 'ground') {\r\n        this.transformControl.enabled = false\r\n      }\r\n    },\r\n    rotateGroupEntities: function(group, rad) {\r\n      let actions = []\r\n\r\n      for (const entity of group.children) {\r\n        if (entity.frozen) {\r\n          continue\r\n        }\r\n\r\n        const offset = rad - entity.angleY\r\n\r\n        if (offset !== 0) {\r\n          actions.push(new RotateEntities({offset: offset, entities: [entity]}))\r\n        }\r\n      }\r\n\r\n      if (actions.length > 0) {\r\n        this.executeAction(CombinedActions, {actions: actions})\r\n      }\r\n    },\r\n    rotateSelectedEntities: function(rad) {\r\n      let actions = []\r\n\r\n      for (const entity of this.selectedEntities) {\r\n        if (entity.frozen || entity.userData.isFixed) {\r\n          continue\r\n        }\r\n\r\n        const offset = rad - entity.angleY\r\n\r\n        if (offset !== 0) {\r\n          actions.push(new RotateEntities({offset: offset, entities: [entity]}))\r\n        }\r\n      }\r\n\r\n      if (actions.length > 0) {\r\n        this.executeAction(CombinedActions, {actions: actions})\r\n        this.adjustDummyToSelectedEntities()\r\n      }\r\n    },\r\n    moveGroupEntities: function(group, position) {\r\n      let actions = []\r\n\r\n      for (const entity of group.children) {\r\n        if (entity.frozen) {\r\n          continue\r\n        }\r\n\r\n        let offset = {x: 0, y: 0, z: 0}\r\n\r\n        if (position.x) {\r\n          offset.x = position.x - entity.position.x\r\n        }\r\n\r\n        if (position.z) {\r\n          offset.z = position.z - entity.position.z\r\n        }\r\n\r\n        if (offset.x !== 0 || offset.z !== 0) {\r\n          actions.push(new MoveEntities({offset: offset, entities: [entity]}))\r\n        }\r\n      }\r\n\r\n      if (actions.length > 0) {\r\n        this.executeAction(CombinedActions, {actions: actions})\r\n      }\r\n    },\r\n    colorizeGroupEntities: function(group, color) {\r\n      let entities = []\r\n\r\n      for (const entity of group.children) {\r\n        if (entity.frozen) {\r\n          continue\r\n        }\r\n\r\n        entities.push(entity)\r\n      }\r\n\r\n      if (entities.length > 0) {\r\n        this.executeAction(ColorizeEntities, {entities: entities, color: color})\r\n      }\r\n    },\r\n    colorizeSelectedEntities: function(color) {\r\n      let entities = []\r\n\r\n      for (const entity of this.selectedEntities) {\r\n        if (entity.frozen) {\r\n          continue\r\n        }\r\n\r\n        entities.push(entity)\r\n      }\r\n\r\n      if (entities.length > 0) {\r\n        this.executeAction(ColorizeEntities, {entities: entities, color: color})\r\n      }\r\n    },\r\n    moveSelectedEntities: function(position) {\r\n      let actions = []\r\n\r\n      for (const entity of this.selectedEntities) {\r\n        if (entity.frozen) {\r\n          continue\r\n        }\r\n\r\n        let offset = {x: 0, y: 0, z: 0}\r\n\r\n        if (!_.isUndefined(position.x)) {\r\n          offset.x = position.x - entity.position.x\r\n        }\r\n\r\n        if (!_.isUndefined(position.z) && !entity.userData.isFixed) {\r\n          offset.z = position.z - entity.position.z\r\n        }\r\n\r\n        if (offset.x !== 0 || offset.z !== 0) {\r\n          actions.push(new MoveEntities({offset: offset, entities: [entity]}))\r\n        }\r\n      }\r\n\r\n      if (actions.length > 0) {\r\n        this.executeAction(CombinedActions, {actions: actions})\r\n        this.adjustDummyToSelectedEntities()\r\n      }\r\n    },\r\n    openIODialog: function(type, params) {\r\n      if (this.state !== 'idle') {\r\n        return\r\n      }\r\n\r\n      this.dialogVisible = 'ioDialog'\r\n      this.$refs.ioDialog.open(type, params)\r\n    },\r\n    openHelpDialog: function() {\r\n      if (this.state !== 'idle') {\r\n        return\r\n      }\r\n\r\n      this.dialogVisible = 'helpDialog'\r\n      this.$refs.helpDialog.open()\r\n    },\r\n    closeHelpDialog: function() {\r\n      this.dialogVisible = null\r\n    },\r\n    publishScene: function() {\r\n      if ((this.state !== 'idle') || (this.numValidEntitiesInTheScene > this.maxNumEntitiesInScene)) {\r\n        return\r\n      }\r\n\r\n      this.cameraPositionPreValidating = this.world.camera.position.clone()\r\n      this.cameraRotationPreValidating = this.world.camera.rotation.clone()\r\n      this.world.camera.position.set(CAMERA_POSITION.x, CAMERA_POSITION.y, CAMERA_POSITION.z)\r\n      this.world.camera.lookAt(new THREE.Vector3(0, 0, 0))\r\n      this.lastTileValidating = this.play()\r\n      this.state = 'validating'\r\n    },\r\n    saveEntities: function(group) {\r\n      let entities = []\r\n\r\n      for (const entity of group.children) {\r\n        const position = entity.getWorldPosition()\r\n        const rotation = entity.angleY\r\n\r\n        let info = {\r\n          type: entity.type,\r\n          position: {x: position.x, z: position.z},\r\n          rotation: rotation,\r\n          color: entity.getColor(),\r\n          visible: entity.visible\r\n        }\r\n\r\n        if (entity.type === 'group') {\r\n          entities = entities.concat(this.saveEntities(entity))\r\n        } else {\r\n          entities.push(info)\r\n        }\r\n      }\r\n\r\n      return entities\r\n    },\r\n    isEntityValidToBePublished: function(entity) {\r\n      // entity should be visible\r\n      if (!entity.visible) {\r\n        return false\r\n      }\r\n\r\n      // entity should be inside the squared meter\r\n      const position = entity.getWorldPosition ? entity.getWorldPosition() : entity.position\r\n      return (position.x >= -50 && position.x <= 50 && position.z >= -50 && position.z <= 50)\r\n    },\r\n    checkSceneValidation: function() {\r\n      if ((this.dialogVisible !== 'publishDialog') && this.lastTileValidating.state === 'falling') {\r\n        this.stop()\r\n        this.dialogVisible = 'publishDialog'\r\n        this.$refs.publishDialog.open()\r\n      }\r\n    },\r\n    cancelValidation: function() {\r\n      this.stop()\r\n      this.world.camera.position.copy(this.cameraPositionPreValidating)\r\n      this.world.camera.rotation.copy(this.cameraRotationPreValidating)\r\n    },\r\n    copySceneUrlToClipboard: function() {\r\n      navigator.clipboard.writeText(`https://malandrin.github.io/domino-party/#/view/${this.sceneUuid}`)\r\n    },\r\n    closePublishDialog: function(title, author, token) {\r\n      this.dialogVisible = null\r\n      if (title !== null) {\r\n        let entitiesToPublish = []\r\n\r\n        for (let entity of this.saveEntities(this.world.group)) {\r\n          if (this.isEntityValidToBePublished(entity)) {\r\n            delete entity.visible\r\n            entitiesToPublish.push(entity)\r\n          }\r\n        }\r\n\r\n        const scene = {\r\n          title: (title || 'New Board').substring(0, MAX_SCENE_TITLE_LENGTH),\r\n          author: (author || 'New Author').substring(0, MAX_SCENE_AUTHOR_LENGTH),\r\n          content: JSON.stringify(entitiesToPublish)\r\n        }\r\n\r\n        const self = this\r\n\r\n        this.$http.post(`scenes?token=${token}`, scene).then(function(response) {\r\n          self.$refs.ioDialog.close()\r\n          if (response.body.ok) {\r\n            self.sceneUuid = response.body.uuid\r\n            self.openIODialog('message', {type: 'info', message: 'Board published! Use the top right button to share it.'})\r\n          } else {\r\n            self.openIODialog('message', {type: 'error', message: 'Error publishing the board. Probably the server free tier daily quota is over.'})\r\n          }\r\n        }).catch(function() {\r\n          self.openIODialog('message', {type: 'error', message: 'Error publishing the board. Probably the server free tier daily quota is over.'})\r\n        })\r\n\r\n        this.openIODialog('message', {type: 'info', noButton: true, message: 'Publishing board...'})\r\n      }\r\n    },\r\n    getNumValidEntitiesInGroup: function(group) {\r\n      let numEntities = 0\r\n\r\n      for (const entity of group.children) {\r\n        if (entity.type !== 'group') {\r\n          if (this.isEntityValidToBePublished(entity)) {\r\n            ++numEntities\r\n          }\r\n        } else {\r\n          numEntities += this.getNumValidEntitiesInGroup(entity)\r\n        }\r\n      }\r\n\r\n      return numEntities\r\n    },\r\n    getEntityHit: function(mouseX, mouseY) {\r\n      let minDistance = 0\r\n      let info = null\r\n\r\n      // normalize coords\r\n      const pos = new THREE.Vector2((mouseX / this.$refs.scene.clientWidth) * 2 - 1, -(mouseY / this.$refs.scene.clientHeight) * 2 + 1)\r\n      this.raycaster.setFromCamera(pos, this.world.camera)\r\n      const intersectInfo = this.raycaster.intersectObject(this.world.imTiles.mesh).concat(this.raycaster.intersectObject(this.world.imBalls.mesh))\r\n\r\n      for (const i of intersectInfo) {\r\n        if (i.distance < minDistance || !info) {\r\n          info = i\r\n          minDistance = info.distance\r\n        }\r\n      }\r\n\r\n      if (info) {\r\n        return this.world.group.findChildByIMeshEntry(info.object.iMesh.name, info.instanceId)\r\n      }\r\n\r\n      return null\r\n    },\r\n    getGroundHitPoint: function(mouseX, mouseY) {\r\n      let minDistance = 0\r\n      let info = null\r\n\r\n      // normalize coords\r\n      const pos = new THREE.Vector2((mouseX / this.$refs.scene.clientWidth) * 2 - 1, -(mouseY / this.$refs.scene.clientHeight) * 2 + 1)\r\n      this.raycaster.setFromCamera(pos, this.world.camera)\r\n      const intersectInfo = this.raycaster.intersectObject(this.world.imGrounds.mesh)\r\n\r\n      for (const i of intersectInfo) {\r\n        if ((i.distance < minDistance) || !info) {\r\n          info = i\r\n          minDistance = info.distance\r\n        }\r\n      }\r\n\r\n      if (info) {\r\n        return info.point\r\n      }\r\n\r\n      return null\r\n    },\r\n    rebuildBatchStamper: function(ignoreNextMouseUpEvent) {\r\n      this.batchStamper.rebuild()\r\n\r\n      if (ignoreNextMouseUpEvent) {\r\n        this.ignoreNextMouseUpEvent = ignoreNextMouseUpEvent\r\n\r\n        const self = this\r\n        _.delay(function() {\r\n          self.ignoreNextMouseUpEvent = false\r\n        }, 200)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.editor {\r\n  .selectionBox {\r\n    border: 1px solid #55aaff;\r\n    background-color: rgba(75, 160, 255, 0.3);\r\n    position: fixed;\r\n    pointer-events: none;\r\n  }\r\n\r\n  .toolbarButton {\r\n    font-size: 20px;\r\n    color: #D0D0D0;\r\n    cursor: pointer;\r\n    padding: 3px 6px;\r\n    width: 25px;\r\n    height: 25px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    border: 1px solid transparent;\r\n    border-radius: 4px;\r\n\r\n    &.invisible {\r\n      visibility: hidden;\r\n    }\r\n\r\n    &.hidden {\r\n      display: none;\r\n    }\r\n\r\n    &:hover {\r\n      &:not(.disabled) {\r\n        background: #383838;\r\n        border: 1px solid #474747;\r\n\r\n        &.active {\r\n          background: #496A93;\r\n          border: 1px solid #3E3E3E;\r\n        }\r\n      }\r\n    }\r\n\r\n    &.active {\r\n      &:not(.disabled) {\r\n        background: #5F8AC1;\r\n        border: 1px solid #3E3E3E;\r\n      }\r\n    }\r\n\r\n    &:active {\r\n      &:not(.disabled) {\r\n        background: #496A93;\r\n        border: 1px solid #3E3E3E;\r\n      }\r\n    }\r\n\r\n    &.disabled {\r\n      cursor: default;\r\n    }\r\n  }\r\n\r\n  .toolbar {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    height: 39px;\r\n    background: #444444;\r\n    border-bottom: 1px solid #6C6C6C;\r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n\r\n    .controlsSection {\r\n      display: flex;\r\n      align-items: center;\r\n      margin-left: 40px;\r\n    }\r\n\r\n    .entitiesStats {\r\n      color: #D0D0D0;\r\n      position: absolute;\r\n      left: 600px;\r\n    }\r\n\r\n    .sceneUuid {\r\n      color: #D0D0D0;\r\n      margin-right: 20px;\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      div {\r\n        &:not(:last-child) {\r\n          margin-right: 10px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .validatingScene {\r\n    .mask {\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      background: rgba(0, 0, 0, 0.05);\r\n    }\r\n\r\n    .messageArea {\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      height: 39px;\r\n      background: #444444;\r\n      border-bottom: 1px solid #6C6C6C;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n\r\n      .message {\r\n        font-size: 24px;\r\n        color: white;\r\n      }\r\n\r\n      .toolbarButton {\r\n        width: auto;\r\n        font-size: 14px;\r\n        padding: 2px 10px;\r\n        margin-left: 20px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .scene {\r\n    position: fixed;\r\n    top: 40px;\r\n    bottom: 0;\r\n    left: 0;\r\n    right: 300px;\r\n\r\n    .stamperMessage {\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 10px;\r\n      color: white;\r\n    }\r\n\r\n    &.batchStamperActive {\r\n      cursor: crosshair;\r\n    }\r\n  }\r\n\r\n  .panel {\r\n    position: fixed;\r\n    top: 40px;\r\n    bottom: 0;\r\n    right: 0;\r\n    width: 300px;\r\n    display: flex;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./editor.vue?vue&type=template&id=fe14cee4&\"\nimport script from \"./editor.vue?vue&type=script&lang=js&\"\nexport * from \"./editor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./editor.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"viewer\"},[(_vm.activeScene)?_c('div',{staticClass:\"sceneInfo\"},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.activeScene.title))]),_c('div',{staticClass:\"author\"},[_vm._v(\"by \"+_vm._s(_vm.activeScene.author))])]):_vm._e(),_c('div',{ref:\"scene\",staticClass:\"scene\"}),(_vm.message)?_c('div',{staticClass:\"message\"},[_vm._v(\" \"+_vm._s(_vm.message)+\" \")]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"viewer\">\r\n    <div v-if=\"activeScene\" class=\"sceneInfo\">\r\n      <div class=\"title\">{{activeScene.title}}</div>\r\n      <div class=\"author\">by {{activeScene.author}}</div>\r\n    </div>\r\n    <div\r\n      class=\"scene\"\r\n      ref=\"scene\"\r\n    />\r\n    <div v-if=\"message\" class=\"message\">\r\n      {{message}}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport _ from 'lodash'\r\nimport * as THREE from 'three'\r\nimport Ammo from 'ammo.js'\r\nimport World from '@/world/world'\r\nimport {Ground, Tile, Group, Ball} from '@/world/entities'\r\nimport {TILE_Y_POSITION, BALL_Y_POSITION, INITIAL_IMPULSE_VALUE, SCENE_INITIAL_TILE_IDX, SCENE_LAST_TILE_IDX} from '@/defines'\r\n\r\nconst CAMERA_POSITION = {x: -110, y: 100, z: 0}\r\nconst WAITING_FOR_FALLING_TILE_TIME = 0.5\r\n\r\nlet SceneId = 0\r\n\r\nexport default {\r\n  name: 'Viewer',\r\n  data: function() {\r\n    return {\r\n      activeScene: null,\r\n      message: 'Loading. Please, wait...'\r\n    }\r\n  },\r\n  mounted: function() {\r\n    this.animFrameId = window.requestAnimationFrame(this.tick)\r\n    this.start = Date.now()\r\n    this.scenePositionZ = -10000\r\n    this.state = 'playing'\r\n    this.timer = 0\r\n    this.cameraDest = new THREE.Vector3(CAMERA_POSITION.x, CAMERA_POSITION.y, CAMERA_POSITION.z + this.scenePositionZ)\r\n\r\n    this.world = new World({\r\n      domElement: this.$refs.scene,\r\n      cameraPosition: this.cameraDest,\r\n      numTiles: 10000,\r\n      numBalls: 5000,\r\n      numGrounds: 10\r\n    })\r\n\r\n    this.world.camera.lookAt(new THREE.Vector3(20, 0, this.cameraDest.z))\r\n\r\n    this.activeScenes = []\r\n    this.activeSceneIdx = 0\r\n    this.nextSceneDefs = []\r\n    this.loadedSceneId = this.$route.params.id\r\n\r\n    const self = this\r\n\r\n    this.fetchScenes(10, this.loadedSceneId, function() {\r\n      if (self.loadedSceneId) {\r\n        self.addNextSceneToWorld(true, false)\r\n      } else {\r\n        for (let i = 0; i < 4; ++i) {\r\n          self.addNextSceneToWorld(i < 2, false)\r\n        }\r\n      }\r\n\r\n      _.delay(function() {\r\n        self.message = null\r\n      }, 2000)\r\n\r\n      _.delay(function() {\r\n        self.activeSceneIdx = 0\r\n        self.activeScene = self.activeScenes[self.activeSceneIdx]\r\n        self.impulseTile(self.activeScene.initialTile)\r\n      }, 3000)\r\n    })\r\n\r\n    window.addEventListener('resize', function() {\r\n      self.world.onWindowResize()\r\n    }, false)\r\n  },\r\n  destroyed: function() {\r\n    if (this.animFrameId) {\r\n      window.cancelAnimationFrame(this.animFrameId)\r\n    }\r\n  },\r\n  methods: {\r\n    fetchScenes: function(count, sceneId, callback) {\r\n      const self = this\r\n      let url = 'scenes?'\r\n\r\n      if (sceneId) {\r\n        url += `id=${sceneId}`\r\n      } else {\r\n        url += `count=${count}`\r\n      }\r\n\r\n      this.$http.get(url).then(function(response) {\r\n        if (response.body.ok) {\r\n          for (const sceneDef of response.body.scenes) {\r\n            sceneDef.id = SceneId++\r\n            self.nextSceneDefs.push(sceneDef)\r\n          }\r\n\r\n          if (callback) {\r\n            callback()\r\n          }\r\n        } else {\r\n          self.message = 'Error loading boards. Probably the server free tier daily quota is over.'\r\n        }\r\n      }).catch(function() {\r\n        self.message = 'Error loading boards. Probably the server free tier daily quota is over.'\r\n      })\r\n    },\r\n    tick: function() {\r\n      const current = Date.now()\r\n      const delta = Math.min((current - this.start) / 1000, 0.016)\r\n\r\n      this.start = current\r\n\r\n      this.world.tick(delta)\r\n      this.world.render()\r\n\r\n      if (this.activeScene) {\r\n        if (!this.loadedSceneId) {\r\n          const nextSceneIdx = this.activeSceneIdx + 1\r\n          const nextScene = this.activeScenes[nextSceneIdx]\r\n\r\n          if (nextScene.initialTile.state === 'falling') {\r\n            // finish scene streaming\r\n            const sceneToStream = this.activeScenes[nextSceneIdx + 2]\r\n\r\n            if (sceneToStream.state === 'streaming') {\r\n              this.streamScene(sceneToStream, -1, this.activeScenes[nextSceneIdx + 1])\r\n            }\r\n\r\n            // ...\r\n            this.activeScene = nextScene\r\n            this.activeSceneIdx = nextSceneIdx\r\n\r\n            // visible scenes: [activeScene - 2, activeScene - 1, activeScene, activeScene + 1, activeScene + 2, activeScene + 3]\r\n            // physical scenes: [activeScene - 1, activeScene, activeScene + 1]\r\n            for (let i = 0; i <= nextSceneIdx - 4; ++i) {\r\n              let removedScene = this.activeScenes.shift()\r\n              removedScene.group.removeFromRenderWorld()\r\n              removedScene.group.removeFromPhysicalWorld(this.world)\r\n              this.world.group.removeChild(removedScene.group)\r\n              --this.activeSceneIdx\r\n            }\r\n\r\n            this.activeScenes[this.activeSceneIdx + 1].group.addToPhysicalWorld(this.world)\r\n            this.addNextSceneToWorld(false, true)\r\n          } else {\r\n            const sceneToStream = this.activeScenes[nextSceneIdx + 2]\r\n\r\n            if (sceneToStream.state === 'streaming') {\r\n              this.streamScene(sceneToStream, 10, this.activeScenes[nextSceneIdx + 1])\r\n            }\r\n          }\r\n\r\n          const lookAtZ = this.getLookAtZ()\r\n\r\n          if (lookAtZ) {\r\n            if (lookAtZ > this.world.camera.position.z) {\r\n              this.cameraDest.z = lookAtZ + CAMERA_POSITION.z\r\n            }\r\n\r\n            let dir = this.cameraDest.clone()\r\n            dir.sub(this.world.camera.position)\r\n            let speed = dir.length() * 0.8\r\n            dir.normalize()\r\n\r\n            this.world.camera.position.z += dir.z * delta * speed\r\n\r\n            this.world.lightTarget.position.set(this.world.camera.position.x + 90, 0, this.world.camera.position.z)\r\n            this.world.directionalLight.position.set(this.world.camera.position.x + 110, this.world.camera.position.y + 70, this.world.camera.position.z - 20)\r\n\r\n            this.state = 'playing'\r\n          } else {\r\n            if (this.state === 'playing') {\r\n              this.state = 'waiting'\r\n              this.timer = WAITING_FOR_FALLING_TILE_TIME\r\n            } else if (this.state === 'waiting') {\r\n              this.timer -= delta\r\n              if (this.timer <= 0) {\r\n                // No more tiles falling. Move to the next scene\r\n                this.impulseTile(this.activeScenes[this.activeSceneIdx + 1].initialTile)\r\n                this.state = 'playing'\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // camera position update to the newest tiles falling\r\n      this.animFrameId = window.requestAnimationFrame(this.tick)\r\n    },\r\n    getLookAtZ: function() {\r\n      let lastTileFalling = null\r\n\r\n      for (const child of this.activeScene.group.children) {\r\n        if (child.type === 'ground' || child.state !== 'falling') {\r\n          continue\r\n        }\r\n\r\n        if (!lastTileFalling || (child.fallingTimer > lastTileFalling.fallingTimer)) {\r\n          lastTileFalling = child\r\n        }\r\n      }\r\n\r\n      if (lastTileFalling) {\r\n        return lastTileFalling.getWorldPosition().z\r\n      }\r\n\r\n      return null\r\n    },\r\n    createEntity(scene, entityDef, entityIdx, prevScene) {\r\n      if (entityIdx === SCENE_LAST_TILE_IDX) {\r\n        scene.lastTileDef = entityDef\r\n        return // the last tile is replaced by the initial tile of the next scene\r\n      }\r\n\r\n      let entity\r\n\r\n      switch(entityDef.type) {\r\n        case 'ground':\r\n          entity = new Ground({\r\n            position: new THREE.Vector3(entityDef.position.x, 0, entityDef.position.z),\r\n            color: entityDef.color,\r\n            iMesh: this.world.imGrounds\r\n          })\r\n          break\r\n\r\n        case 'tile':\r\n          entity = new Tile({\r\n            position: new THREE.Vector3(entityDef.position.x, TILE_Y_POSITION, entityDef.position.z),\r\n            angleY: entityDef.rotation,\r\n            color: entityDef.color,\r\n            iMesh: this.world.imTiles\r\n          })\r\n          break\r\n\r\n        case 'ball':\r\n          entity = new Ball({\r\n            position: new THREE.Vector3(entityDef.position.x, BALL_Y_POSITION, entityDef.position.z),\r\n            color: entityDef.color,\r\n            iMesh: this.world.imBalls\r\n          })\r\n          break\r\n      }\r\n\r\n      if (entityIdx === SCENE_INITIAL_TILE_IDX) {\r\n        if (prevScene) {\r\n          // mix the color con the last tile of the previous scene\r\n          const prevColor = new THREE.Color(prevScene.lastTileDef.color)\r\n          entity.color = `#${prevColor.lerp(new THREE.Color(entity.color), 0.5).getHexString()}`\r\n        }\r\n\r\n        scene.initialTile = entity\r\n      }\r\n\r\n      scene.group.addChild(entity)\r\n\r\n      return entity\r\n    },\r\n    streamScene(scene, numEntities, prevScene) {\r\n      const numChildren = scene.contentDef.length\r\n      const from = scene.streamingFrom\r\n      const to = numEntities === -1 ? numChildren : Math.min(from + numEntities, numChildren)\r\n\r\n      for (let i = from; i < to; ++i) {\r\n        const entity = this.createEntity(scene, scene.contentDef[i], i, prevScene)\r\n\r\n        if (!entity) {\r\n          continue\r\n        }\r\n\r\n        entity.addToRenderWorld()\r\n        entity.addToPhysicalWorld(this.world)\r\n      }\r\n\r\n      scene.streamingFrom += numEntities\r\n\r\n      if (scene.streamingFrom >= numChildren) {\r\n        scene.state = 'ready'\r\n      }\r\n    },\r\n    createScene(sceneDef, prevScene, streamingIt) {\r\n      const contentDef = JSON.parse(sceneDef.content)\r\n\r\n      let scene = {\r\n        id: sceneDef.id,\r\n        title: sceneDef.title,\r\n        author: sceneDef.author,\r\n        group: new Group(),\r\n        initialTile: null,\r\n        state: streamingIt ? 'streaming' : 'ready'\r\n      }\r\n\r\n      if (streamingIt) {\r\n        scene.contentDef = contentDef\r\n        scene.streamingFrom = 0\r\n      } else {\r\n        for (const [i, entityDef] of contentDef.entries()) {\r\n          this.createEntity(scene, entityDef, i, prevScene)\r\n        }\r\n      }\r\n\r\n      let offsetX = 0\r\n\r\n      if (prevScene) {\r\n        let prevX\r\n        let thisX\r\n\r\n\r\n        if (prevScene.lastTileDef) {\r\n          prevX = prevScene.lastTileDef.position.x\r\n        } else {\r\n          prevX = prevScene.contentDef[SCENE_LAST_TILE_IDX].position.x\r\n        }\r\n\r\n        if (scene.initialTile) {\r\n          thisX = scene.initialTile.position.x\r\n        } else {\r\n          thisX = scene.contentDef[SCENE_INITIAL_TILE_IDX].position.x\r\n        }\r\n\r\n        offsetX = prevScene.group.position.x + prevX - thisX\r\n      }\r\n\r\n      scene.group.setPosition(offsetX, 0, this.scenePositionZ)\r\n\r\n      return scene\r\n    },\r\n    addNextSceneToWorld: function(andPhysicalWorld, streamingIt) {\r\n      const scene = this.createScene(this.nextSceneDefs.shift(), this.activeScenes[this.activeScenes.length -1], streamingIt)\r\n\r\n      if (!streamingIt) {\r\n        scene.group.addToRenderWorld()\r\n\r\n        if (andPhysicalWorld) {\r\n          scene.group.addToPhysicalWorld(this.world)\r\n        }\r\n      }\r\n\r\n      this.world.group.addChild(scene.group)\r\n      this.activeScenes.push(scene)\r\n      this.scenePositionZ += 100\r\n\r\n      // ...\r\n      if (this.nextSceneDefs.length <= 5) {\r\n        this.fetchScenes(1)\r\n      }\r\n    },\r\n    impulseTile: function(tile) {\r\n      if (!tile.body.isActive()) {\r\n        tile.body.activate()\r\n      }\r\n\r\n      tile.body.applyImpulse(new Ammo.btVector3(0, 0, INITIAL_IMPULSE_VALUE))\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.viewer {\r\n  .sceneInfo {\r\n    background: rgba(0, 0, 0, 0.2);\r\n    width: 400px;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    z-index: 1;\r\n    color: white;\r\n    text-align: left;\r\n    padding: 20px;\r\n    overflow: hidden;\r\n    border-top-right-radius: 10px;\r\n    border-bottom-right-radius: 10px;\r\n\r\n    .title {\r\n      font-size: 26px;\r\n    }\r\n\r\n    .author {\r\n      font-size: 18px;\r\n    }\r\n  }\r\n\r\n  .scene {\r\n    position: fixed;\r\n    top: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    right: 0;\r\n  }\r\n\r\n  .message {\r\n    top: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    right: 0;\r\n    position: absolute;\r\n    color: #DCDCDC;\r\n    background: black;\r\n    font-size: 30px;\r\n    z-index: 1;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./viewer.vue?vue&type=template&id=d273f610&scoped=true&\"\nimport script from \"./viewer.vue?vue&type=script&lang=js&\"\nexport * from \"./viewer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./viewer.vue?vue&type=style&index=0&id=d273f610&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d273f610\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\r\nimport VueRouter from 'vue-router'\r\nimport Home from '@/home'\r\nimport Editor from '@/editor/editor'\r\nimport Viewer from '@/viewer'\r\n\r\nVue.use(VueRouter)\r\n\r\nexport default new VueRouter({\r\n  routes: [\r\n    {\r\n      path: '/create',\r\n      name: 'create',\r\n      component: Editor\r\n    }, {\r\n      path: '/view/:id',\r\n      name: 'viewScene',\r\n      component: Viewer\r\n    }, {\r\n      path: '/view',\r\n      name: 'view',\r\n      component: Viewer\r\n    }, {\r\n      path: '*',\r\n      name: 'home',\r\n      component: Home,\r\n      meta: {\r\n        title: 'orejas'\r\n      }\r\n    }\r\n  ]\r\n})\r\n","import Vue from 'vue'\r\nimport VueResource from 'vue-resource'\r\nimport {VueReCaptcha} from 'vue-recaptcha-v3'\r\nimport App from './app.vue'\r\nimport router from './router'\r\n\r\nVue.config.productionTip = false\r\n\r\nVue.use(VueReCaptcha, {\r\n  siteKey: '6LfzhvoUAAAAANbKFJGEioyZkX6xIvo3ByxgHwSm',\r\n  loaderOptions: {\r\n    autoHideBadge: true\r\n  }\r\n})\r\nVue.use(VueResource)\r\n\r\nif (process.env.NODE_ENV === 'development') {\r\n  Vue.http.options.root = 'http://localhost:9080/api/'\r\n} else {\r\n  Vue.http.options.root = 'https://dominos-party.ew.r.appspot.com/api/'\r\n}\r\n\r\nVue.http.options.emulateJSON = true\r\n\r\nnew Vue({\r\n  router,\r\n  render: h => h(App),\r\n}).$mount('#app')\r\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=style&index=0&id=f763c07e&lang=less&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./home.vue?vue&type=style&index=0&id=f763c07e&lang=less&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene_inspector.vue?vue&type=style&index=0&id=0f6a8886&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./scene_inspector.vue?vue&type=style&index=0&id=0f6a8886&lang=less&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./help_dialog.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./help_dialog.vue?vue&type=style&index=0&lang=less&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editor.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editor.vue?vue&type=style&index=0&lang=less&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./io_dialog.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./io_dialog.vue?vue&type=style&index=0&lang=less&\"","module.exports = __webpack_public_path__ + \"img/editor.8391daee.gif\";","module.exports = __webpack_public_path__ + \"img/viewer.d9169a83.gif\";","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=style&index=0&id=d273f610&lang=less&scoped=true&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./viewer.vue?vue&type=style&index=0&id=d273f610&lang=less&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./app.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}